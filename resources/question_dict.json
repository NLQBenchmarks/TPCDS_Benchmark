{
    "Q1": {
        "question": "What are all of the unique store numbers in the state of Tennessee?",
        "expected_query": "SELECT\n   \"t_63\".\"d_store_state_name_gbakc3\" AS \"d_Store State Name\",\n   \"t_63\".\"store_number_gbakc4\" AS \"Store_Number\"\nFROM\n(\n   SELECT\n      \"t_61\".\"c_58\" AS \"d_store_state_name_gbakc3\",\n      \"t_61\".\"s_store_sk_c59\" AS \"store_number_gbakc4\",\n      \"t_61\".\"c_58\" AS \"d_store_state_name_gbakc1\",\n      \"t_61\".\"s_store_sk_c59\" AS \"store_number_gbakc2\"\n   FROM\n   (\n      SELECT\n         CASE\n    WHEN \"store_t57\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t57\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t57\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t57\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t57\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t57\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t57\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t57\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t57\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t57\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t57\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t57\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t57\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t57\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t57\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t57\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t57\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t57\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t57\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t57\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t57\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t57\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t57\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t57\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t57\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t57\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t57\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t57\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t57\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t57\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t57\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t57\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t57\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t57\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t57\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t57\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t57\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t57\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t57\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t57\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t57\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t57\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t57\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t57\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t57\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t57\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t57\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t57\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t57\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t57\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t57\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_58\",\n         \"store_t57\".\"s_store_sk\" AS \"s_store_sk_c59\"\n      FROM\n         \"tpcds\".\"store\" AS \"store_t57\"\n      WHERE\n         CASE\n    WHEN \"store_t57\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t57\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t57\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t57\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t57\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t57\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t57\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t57\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t57\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t57\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t57\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t57\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t57\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t57\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t57\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t57\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t57\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t57\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t57\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t57\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t57\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t57\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t57\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t57\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t57\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t57\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t57\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t57\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t57\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t57\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t57\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t57\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t57\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t57\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t57\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t57\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t57\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t57\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t57\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t57\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t57\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t57\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t57\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t57\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t57\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t57\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t57\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t57\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t57\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t57\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t57\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('Tennessee' AS TEXT)\n      GROUP BY\n         1,\n         2\n   ) AS \"t_61\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4\n) AS \"t_63\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q2": {
        "question": "What are the first and last names of all customers that have more than 5 dependents?",
        "expected_query": "SELECT\n   \"t_294\".\"d_customer_first_n_gbakc4\" AS \"d_customer_first_name\",\n   \"t_294\".\"d_customer_last_na_gbakc5\" AS \"d_customer_last_name\",\n   \"t_294\".\"d_cd_dep_count_gbakc6\" AS \"d_cd_dep_count\"\nFROM\n(\n   SELECT\n      \"t_286\".\"d_customer_first_n_gbakc4\" AS \"d_customer_first_n_gbakc4\",\n      \"t_286\".\"d_customer_last_na_gbakc5\" AS \"d_customer_last_na_gbakc5\",\n      \"t_286\".\"d_cd_dep_count_gbakc6\" AS \"d_cd_dep_count_gbakc6\",\n      \"t_286\".\"d_customer_first_n_gbakc1\" AS \"d_customer_first_n_gbakc1\",\n      \"t_286\".\"d_customer_last_na_gbakc2\" AS \"d_customer_last_na_gbakc2\",\n      \"t_286\".\"d_cd_dep_count_gbakc3\" AS \"d_cd_dep_count_gbakc3\"\n   FROM\n   (\n         SELECT\n            \"t_216\".\"c_first_name_c213\" AS \"d_customer_first_n_gbakc4\",\n            \"t_216\".\"c_last_name_c215\" AS \"d_customer_last_na_gbakc5\",\n            \"t_211\".\"cd_dep_count_c209\" AS \"d_cd_dep_count_gbakc6\",\n            \"t_216\".\"c_first_name_c213\" AS \"d_customer_first_n_gbakc1\",\n            \"t_216\".\"c_last_name_c215\" AS \"d_customer_last_na_gbakc2\",\n            \"t_211\".\"cd_dep_count_c209\" AS \"d_cd_dep_count_gbakc3\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t207\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t208\".\"cd_demo_sk\" AS \"cd_demo_sk_c210\",\n               \"customer_demograph_t208\".\"cd_dep_count\" AS \"cd_dep_count_c209\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t208\"\n            WHERE\n               \"customer_demograph_t208\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_211\"\n         ON\n            \"store_sales_t207\".\"ss_cdemo_sk\" = \"t_211\".\"cd_demo_sk_c210\"\n         JOIN\n         (\n            SELECT\n               \"customer_t212\".\"c_customer_sk\" AS \"c_customer_sk_c214\",\n               \"customer_t212\".\"c_first_name\" AS \"c_first_name_c213\",\n               \"customer_t212\".\"c_last_name\" AS \"c_last_name_c215\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t212\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_216\"\n         ON\n            \"store_sales_t207\".\"ss_customer_sk\" = \"t_216\".\"c_customer_sk_c214\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_233\".\"c_first_name_c230\" AS \"d_customer_first_n_gbakc4\",\n            \"t_233\".\"c_last_name_c232\" AS \"d_customer_last_na_gbakc5\",\n            \"t_228\".\"cd_dep_count_c226\" AS \"d_cd_dep_count_gbakc6\",\n            \"t_233\".\"c_first_name_c230\" AS \"d_customer_first_n_gbakc1\",\n            \"t_233\".\"c_last_name_c232\" AS \"d_customer_last_na_gbakc2\",\n            \"t_228\".\"cd_dep_count_c226\" AS \"d_cd_dep_count_gbakc3\"\n         FROM\n         (\nSELECT ss.*, sr.*, case when (sr_returned_date_sk - ss_sold_date_sk <= 30) then '<= 30 days' when (sr_returned_date_sk - ss_sold_date_sk > 30) and   (sr_returned_date_sk - ss_sold_date_sk <= 60) then '31-60 days' when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then '61-90 days' when (sr_returned_date_sk - ss_sold_date_sk > 90) and  (sr_returned_date_sk - ss_sold_date_sk <= 120) then '91-120 days' else '> 120 days' end as returns_time_tier, 1 as returns_count  FROM atscale_tutorial_data.tpcds.store_returns sr INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk\n         ) AS \"t_224\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t225\".\"cd_demo_sk\" AS \"cd_demo_sk_c227\",\n               \"customer_demograph_t225\".\"cd_dep_count\" AS \"cd_dep_count_c226\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t225\"\n            WHERE\n               \"customer_demograph_t225\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_228\"\n         ON\n            \"t_224\".\"sr_cdemo_sk\" = \"t_228\".\"cd_demo_sk_c227\"\n         JOIN\n         (\n            SELECT\n               \"customer_t229\".\"c_customer_sk\" AS \"c_customer_sk_c231\",\n               \"customer_t229\".\"c_first_name\" AS \"c_first_name_c230\",\n               \"customer_t229\".\"c_last_name\" AS \"c_last_name_c232\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t229\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_233\"\n         ON\n            \"t_224\".\"sr_customer_sk\" = \"t_233\".\"c_customer_sk_c231\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_250\".\"c_first_name_c247\" AS \"d_customer_first_n_gbakc4\",\n            \"t_250\".\"c_last_name_c249\" AS \"d_customer_last_na_gbakc5\",\n            \"t_245\".\"cd_dep_count_c243\" AS \"d_cd_dep_count_gbakc6\",\n            \"t_250\".\"c_first_name_c247\" AS \"d_customer_first_n_gbakc1\",\n            \"t_250\".\"c_last_name_c249\" AS \"d_customer_last_na_gbakc2\",\n            \"t_245\".\"cd_dep_count_c243\" AS \"d_cd_dep_count_gbakc3\"\n         FROM\n            \"tpcds\".\"web_sales\" AS \"web_sales_t241\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t242\".\"cd_demo_sk\" AS \"cd_demo_sk_c244\",\n               \"customer_demograph_t242\".\"cd_dep_count\" AS \"cd_dep_count_c243\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t242\"\n            WHERE\n               \"customer_demograph_t242\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_245\"\n         ON\n            \"web_sales_t241\".\"ws_bill_cdemo_sk\" = \"t_245\".\"cd_demo_sk_c244\"\n         JOIN\n         (\n            SELECT\n               \"customer_t246\".\"c_customer_sk\" AS \"c_customer_sk_c248\",\n               \"customer_t246\".\"c_first_name\" AS \"c_first_name_c247\",\n               \"customer_t246\".\"c_last_name\" AS \"c_last_name_c249\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t246\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_250\"\n         ON\n            \"web_sales_t241\".\"ws_bill_customer_sk\" = \"t_250\".\"c_customer_sk_c248\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_267\".\"c_first_name_c264\" AS \"d_customer_first_n_gbakc4\",\n            \"t_267\".\"c_last_name_c266\" AS \"d_customer_last_na_gbakc5\",\n            \"t_262\".\"cd_dep_count_c260\" AS \"d_cd_dep_count_gbakc6\",\n            \"t_267\".\"c_first_name_c264\" AS \"d_customer_first_n_gbakc1\",\n            \"t_267\".\"c_last_name_c266\" AS \"d_customer_last_na_gbakc2\",\n            \"t_262\".\"cd_dep_count_c260\" AS \"d_cd_dep_count_gbakc3\"\n         FROM\n         (\nSELECT p.*, ss.*  FROM atscale_tutorial_data.tpcds.promotion p INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_promo_sk = p.p_promo_sk\n         ) AS \"t_258\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t259\".\"cd_demo_sk\" AS \"cd_demo_sk_c261\",\n               \"customer_demograph_t259\".\"cd_dep_count\" AS \"cd_dep_count_c260\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t259\"\n            WHERE\n               \"customer_demograph_t259\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_262\"\n         ON\n            \"t_258\".\"ss_cdemo_sk\" = \"t_262\".\"cd_demo_sk_c261\"\n         JOIN\n         (\n            SELECT\n               \"customer_t263\".\"c_customer_sk\" AS \"c_customer_sk_c265\",\n               \"customer_t263\".\"c_first_name\" AS \"c_first_name_c264\",\n               \"customer_t263\".\"c_last_name\" AS \"c_last_name_c266\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t263\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_267\"\n         ON\n            \"t_258\".\"ss_customer_sk\" = \"t_267\".\"c_customer_sk_c265\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_284\".\"c_first_name_c281\" AS \"d_customer_first_n_gbakc4\",\n            \"t_284\".\"c_last_name_c283\" AS \"d_customer_last_na_gbakc5\",\n            \"t_279\".\"cd_dep_count_c277\" AS \"d_cd_dep_count_gbakc6\",\n            \"t_284\".\"c_first_name_c281\" AS \"d_customer_first_n_gbakc1\",\n            \"t_284\".\"c_last_name_c283\" AS \"d_customer_last_na_gbakc2\",\n            \"t_279\".\"cd_dep_count_c277\" AS \"d_cd_dep_count_gbakc3\"\n         FROM\n            \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t275\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t276\".\"cd_demo_sk\" AS \"cd_demo_sk_c278\",\n               \"customer_demograph_t276\".\"cd_dep_count\" AS \"cd_dep_count_c277\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t276\"\n            WHERE\n               \"customer_demograph_t276\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_279\"\n         ON\n            \"catalog_sales_t275\".\"cs_bill_cdemo_sk\" = \"t_279\".\"cd_demo_sk_c278\"\n         JOIN\n         (\n            SELECT\n               \"customer_t280\".\"c_customer_sk\" AS \"c_customer_sk_c282\",\n               \"customer_t280\".\"c_first_name\" AS \"c_first_name_c281\",\n               \"customer_t280\".\"c_last_name\" AS \"c_last_name_c283\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t280\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_284\"\n         ON\n            \"catalog_sales_t275\".\"cs_bill_customer_sk\" = \"t_284\".\"c_customer_sk_c282\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n   ) AS \"t_286\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6\n) AS \"t_294\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q3": {
        "question": "What is the name, manager and floor space of each store in the city of Midway?",
        "expected_query": "SELECT\n   \"t_140\".\"d_s_manager_gbakc7\" AS \"d_s_manager\",\n   \"t_140\".\"d_store_name_gbakc8\" AS \"d_store_name\",\n   \"t_140\".\"d_s_floor_space_gbakc9\" AS \"d_s_floor_space\",\n   \"t_140\".\"d_store_city_gbakc10\" AS \"d_store_city\"\nFROM\n(\n   SELECT\n      \"t_138\".\"s_manager_c137\" AS \"d_s_manager_gbakc7\",\n      \"t_138\".\"s_store_name_c135\" AS \"d_store_name_gbakc8\",\n      \"t_138\".\"s_floor_space_c133\" AS \"d_s_floor_space_gbakc9\",\n      \"t_138\".\"s_city_c132\" AS \"d_store_city_gbakc10\",\n      \"t_138\".\"s_manager_c137\" AS \"d_s_manager_gbakc1\",\n      \"t_138\".\"s_store_name_c135\" AS \"d_store_name_gbakc2\",\n      \"t_138\".\"s_floor_space_c133\" AS \"d_s_floor_space_gbakc3\",\n      \"t_138\".\"s_country_c130\" AS \"d_store_city_gbakc4\",\n      \"t_138\".\"s_state_c131\" AS \"d_store_city_gbakc5\",\n      \"t_138\".\"s_city_c132\" AS \"d_store_city_gbakc6\"\n   FROM\n   (\n      SELECT\n         \"store_t129\".\"s_city\" AS \"s_city_c132\",\n         \"store_t129\".\"s_city\" AS \"s_city_c134\",\n         \"store_t129\".\"s_country\" AS \"s_country_c130\",\n         \"store_t129\".\"s_floor_space\" AS \"s_floor_space_c133\",\n         \"store_t129\".\"s_manager\" AS \"s_manager_c137\",\n         \"store_t129\".\"s_state\" AS \"s_state_c131\",\n         \"store_t129\".\"s_store_name\" AS \"s_store_name_c135\",\n         \"store_t129\".\"s_store_sk\" AS \"s_store_sk_c136\"\n      FROM\n         \"tpcds\".\"store\" AS \"store_t129\"\n      WHERE\n         \"store_t129\".\"s_city\" = CAST('Midway' AS TEXT)\n      GROUP BY\n         1,\n         2,\n         3,\n         4,\n         5,\n         6,\n         7,\n         8\n   ) AS \"t_138\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8,\n      9,\n      10\n) AS \"t_140\"\nORDER BY\n   1 ASC NULLS FIRST,\n   3 ASC NULLS FIRST,\n   4 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q4": {
        "question": "What is the name of each product of brand name 'corpcorp #1'?",
        "expected_query": "SELECT\n   \"t_64\".\"i_product_name_gbakc3\" AS \"i_product_name\",\n   \"t_64\".\"d_product_brand_na_gbakc4\" AS \"d_product_brand_name\"\nFROM\n(\n   SELECT\n      \"t_62\".\"i_product_name_c60\" AS \"i_product_name_gbakc3\",\n      \"t_62\".\"i_brand_c59\" AS \"d_product_brand_na_gbakc4\",\n      \"t_62\".\"i_product_name_c60\" AS \"i_product_name_gbakc1\",\n      \"t_62\".\"i_brand_id_c58\" AS \"d_product_brand_na_gbakc2\"\n   FROM\n   (\n      SELECT\n         \"item_t57\".\"i_brand\" AS \"i_brand_c59\",\n         \"item_t57\".\"i_brand_id\" AS \"i_brand_id_c58\",\n         \"item_t57\".\"i_item_sk\" AS \"i_item_sk_c61\",\n         \"item_t57\".\"i_product_name\" AS \"i_product_name_c60\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t57\"\n      WHERE\n         \"item_t57\".\"i_brand\" = CAST('corpcorp #1' AS TEXT)\n      GROUP BY\n         1,\n         2,\n         3,\n         4\n   ) AS \"t_62\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4\n) AS \"t_64\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q5": {
        "question": "What brand names are made by the manufacturer named able?",
        "expected_query": "SELECT\n   \"t_65\".\"d_product_brand_na_gbakc3\" AS \"d_product_brand_name\",\n   \"t_65\".\"d_product_manufact_gbakc4\" AS \"d_product_manufacturer_name\"\nFROM\n(\n   SELECT\n      \"t_63\".\"i_brand_c61\" AS \"d_product_brand_na_gbakc3\",\n      \"t_63\".\"i_manufact_c58\" AS \"d_product_manufact_gbakc4\",\n      \"t_63\".\"i_brand_id_c60\" AS \"d_product_brand_na_gbakc1\",\n      \"t_63\".\"i_manager_id_c59\" AS \"d_product_manufact_gbakc2\"\n   FROM\n   (\n      SELECT\n         \"item_t57\".\"i_brand\" AS \"i_brand_c61\",\n         \"item_t57\".\"i_brand_id\" AS \"i_brand_id_c60\",\n         \"item_t57\".\"i_item_sk\" AS \"i_item_sk_c62\",\n         \"item_t57\".\"i_manager_id\" AS \"i_manager_id_c59\",\n         \"item_t57\".\"i_manufact\" AS \"i_manufact_c58\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t57\"\n      WHERE\n         \"item_t57\".\"i_manufact\" = CAST('able' AS TEXT)\n      GROUP BY\n         1,\n         2,\n         3,\n         4,\n         5\n   ) AS \"t_63\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4\n) AS \"t_65\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q6": {
        "question": "What shipping carriers are available for shipping type 'EXPRESS'?",
        "expected_query": "SELECT\n   \"t_62\".\"carrier_gbakc3\" AS \"Carrier\",\n   \"t_62\".\"ship_mode_type_gbakc4\" AS \"Ship Mode Type\"\nFROM\n(\n   SELECT\n      \"t_60\".\"sm_carrier_c59\" AS \"carrier_gbakc3\",\n      \"t_60\".\"sm_type_c58\" AS \"ship_mode_type_gbakc4\",\n      \"t_60\".\"sm_carrier_c59\" AS \"carrier_gbakc1\",\n      \"t_60\".\"sm_type_c58\" AS \"ship_mode_type_gbakc2\"\n   FROM\n   (\n      SELECT\n         \"ship_mode_t57\".\"sm_carrier\" AS \"sm_carrier_c59\",\n         \"ship_mode_t57\".\"sm_type\" AS \"sm_type_c58\"\n      FROM\n         \"tpcds\".\"ship_mode\" AS \"ship_mode_t57\"\n      WHERE\n         \"ship_mode_t57\".\"sm_type\" = CAST('EXPRESS' AS TEXT)\n      GROUP BY\n         1,\n         2\n   ) AS \"t_60\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4\n) AS \"t_62\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q7": {
        "question": "What is the name and square footage for each warehouse in the city of Fairview?",
        "expected_query": "SELECT\n   \"t_115\".\"d_warehouse_name_gbakc6\" AS \"d_warehouse_name\",\n   \"t_115\".\"d_warehouse_square_gbakc7\" AS \"d_warehouse_square_feet\",\n   \"t_115\".\"warehouse_city_gbakc8\" AS \"Warehouse City\"\nFROM\n(\n   SELECT\n      \"t_113\".\"w_warehouse_name_c109\" AS \"d_warehouse_name_gbakc6\",\n      \"t_113\".\"w_warehouse_sq_ft_c110\" AS \"d_warehouse_square_gbakc7\",\n      \"t_113\".\"w_city_c108\" AS \"warehouse_city_gbakc8\",\n      \"t_113\".\"w_warehouse_name_c109\" AS \"d_warehouse_name_gbakc1\",\n      \"t_113\".\"w_warehouse_sq_ft_c110\" AS \"d_warehouse_square_gbakc2\",\n      \"t_113\".\"w_country_c106\" AS \"warehouse_city_gbakc3\",\n      \"t_113\".\"w_state_c107\" AS \"warehouse_city_gbakc4\",\n      \"t_113\".\"w_city_c108\" AS \"warehouse_city_gbakc5\"\n   FROM\n   (\n      SELECT\n         \"warehouse_t105\".\"w_city\" AS \"w_city_c108\",\n         \"warehouse_t105\".\"w_city\" AS \"w_city_c112\",\n         \"warehouse_t105\".\"w_country\" AS \"w_country_c106\",\n         \"warehouse_t105\".\"w_state\" AS \"w_state_c107\",\n         \"warehouse_t105\".\"w_warehouse_name\" AS \"w_warehouse_name_c109\",\n         \"warehouse_t105\".\"w_warehouse_sk\" AS \"w_warehouse_sk_c111\",\n         \"warehouse_t105\".\"w_warehouse_sq_ft\" AS \"w_warehouse_sq_ft_c110\"\n      FROM\n         \"tpcds\".\"warehouse\" AS \"warehouse_t105\"\n      WHERE\n         \"warehouse_t105\".\"w_city\" = CAST('Fairview' AS TEXT)\n      GROUP BY\n         1,\n         2,\n         3,\n         4,\n         5,\n         6,\n         7\n   ) AS \"t_113\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8\n) AS \"t_115\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q8": {
        "question": "What is the name of each product with a current price greater than 70?",
        "expected_query": "SELECT\n   \"t_63\".\"i_product_name_gbakc3\" AS \"i_product_name\",\n   \"t_63\".\"d_product_current__gbakc4\" AS \"d_product_current_price\"\nFROM\n(\n   SELECT\n      \"t_61\".\"i_product_name_c59\" AS \"i_product_name_gbakc3\",\n      \"t_61\".\"i_current_price_c58\" AS \"d_product_current__gbakc4\",\n      \"t_61\".\"i_product_name_c59\" AS \"i_product_name_gbakc1\",\n      \"t_61\".\"i_current_price_c58\" AS \"d_product_current__gbakc2\"\n   FROM\n   (\n      SELECT\n         \"item_t57\".\"i_current_price\" AS \"i_current_price_c58\",\n         \"item_t57\".\"i_item_sk\" AS \"i_item_sk_c60\",\n         \"item_t57\".\"i_product_name\" AS \"i_product_name_c59\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t57\"\n      WHERE\n         \"item_t57\".\"i_current_price\" > 70\n      GROUP BY\n         1,\n         2,\n         3\n   ) AS \"t_61\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4\n) AS \"t_63\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q9": {
        "question": "For each store name, how many employees work there?",
        "expected_query": "SELECT\n   \"t_51\".\"d_store_name_gbakc3\" AS \"d_store_name\",\n   \"t_51\".\"d_s_number_employe_gbakc4\" AS \"d_s_number_employees\"\nFROM\n(\n   SELECT\n      \"store_t49\".\"s_store_name\" AS \"d_store_name_gbakc3\",\n      \"store_t49\".\"s_number_employees\" AS \"d_s_number_employe_gbakc4\",\n      \"store_t49\".\"s_store_name\" AS \"d_store_name_gbakc1\",\n      \"store_t49\".\"s_number_employees\" AS \"d_s_number_employe_gbakc2\"\n   FROM\n      \"tpcds\".\"store\" AS \"store_t49\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4\n) AS \"t_51\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q10": {
        "question": "What is the name of each warehouse with more than 140000 square feet of space?",
        "expected_query": "SELECT\n   \"t_63\".\"d_warehouse_name_gbakc3\" AS \"d_warehouse_name\",\n   \"t_63\".\"d_warehouse_square_gbakc4\" AS \"d_warehouse_square_feet\"\nFROM\n(\n   SELECT\n      \"t_61\".\"w_warehouse_name_c58\" AS \"d_warehouse_name_gbakc3\",\n      \"t_61\".\"w_warehouse_sq_ft_c59\" AS \"d_warehouse_square_gbakc4\",\n      \"t_61\".\"w_warehouse_name_c58\" AS \"d_warehouse_name_gbakc1\",\n      \"t_61\".\"w_warehouse_sq_ft_c59\" AS \"d_warehouse_square_gbakc2\"\n   FROM\n   (\n      SELECT\n         \"warehouse_t57\".\"w_warehouse_name\" AS \"w_warehouse_name_c58\",\n         \"warehouse_t57\".\"w_warehouse_sk\" AS \"w_warehouse_sk_c60\",\n         \"warehouse_t57\".\"w_warehouse_sq_ft\" AS \"w_warehouse_sq_ft_c59\"\n      FROM\n         \"tpcds\".\"warehouse\" AS \"warehouse_t57\"\n      WHERE\n         \"warehouse_t57\".\"w_warehouse_sq_ft\" > 140000\n      GROUP BY\n         1,\n         2,\n         3\n   ) AS \"t_61\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4\n) AS \"t_63\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "L"
    },
    "Q11": {
        "question": "What is the total count of customers for each customer home state?",
        "expected_query": "SELECT\n   \"t_135\".\"d_customer_state_n_gbakc2\" AS \"d_Customer State Name\",\n   \"t_135\".\"customer_count_gbakc3\" AS \"Customer Count\"\nFROM\n(\n   SELECT\n      \"t_118\".\"d_customer_state_n_gbakc2\" AS \"d_customer_state_n_gbakc2\",\n      CASE WHEN (COALESCE(MIN(\"t_118\".\"c_31\"), MIN(\"t_118\".\"c_32\"), MIN(\"t_118\".\"c_33\")) IS NULL) THEN NULL ELSE ((COALESCE(MIN(\"t_118\".\"c_31\"), CAST(0 AS BIGINT)) + COALESCE(MIN(\"t_118\".\"c_32\"), CAST(0 AS BIGINT))) + COALESCE(MIN(\"t_118\".\"c_33\"), CAST(0 AS BIGINT))) END AS \"customer_count_gbakc3\",\n      \"t_118\".\"d_customer_state_n_gbakc1\" AS \"d_customer_state_n_gbakc1\"\n   FROM\n   (\n      SELECT\n         \"t_117\".\"d_customer_state_n_gbakc2\" AS \"d_customer_state_n_gbakc2\",\n         MIN(\"t_117\".\"c_31\") AS \"c_31\",\n         MIN(\"t_117\".\"c_32\") AS \"c_32\",\n         MIN(\"t_117\".\"c_33\") AS \"c_33\",\n         \"t_117\".\"d_customer_state_n_gbakc1\" AS \"d_customer_state_n_gbakc1\"\n      FROM\n      (\n            SELECT\n               \"t_89\".\"c_86\" AS \"d_customer_state_n_gbakc2\",\n               CAST(NULL AS BIGINT) AS \"c_31\",\n               CAST(NULL AS BIGINT) AS \"c_32\",\n               COUNT(\"catalog_sales_t80\".\"cs_bill_customer_sk\") AS \"c_33\",\n               \"t_89\".\"c_86\" AS \"d_customer_state_n_gbakc1\"\n            FROM\n               \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t80\"\n            JOIN\n            (\n               SELECT\n                  \"customer_t81\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c83\",\n                  \"customer_t81\".\"c_customer_sk\" AS \"c_customer_sk_c82\"\n               FROM\n                  \"tpcds\".\"customer\" AS \"customer_t81\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_84\"\n            ON\n               \"catalog_sales_t80\".\"cs_bill_customer_sk\" = \"t_84\".\"c_customer_sk_c82\"\n            JOIN\n            (\n               SELECT\n                  CASE\n    WHEN \"customer_address_t85\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t85\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t85\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t85\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t85\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t85\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t85\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t85\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t85\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t85\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t85\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t85\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t85\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t85\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t85\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t85\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t85\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t85\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t85\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t85\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t85\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t85\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t85\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t85\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t85\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t85\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t85\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t85\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t85\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t85\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t85\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t85\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t85\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t85\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t85\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t85\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t85\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t85\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t85\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t85\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t85\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t85\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t85\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t85\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t85\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t85\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t85\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t85\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t85\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t85\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t85\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_86\",\n                  \"customer_address_t85\".\"ca_address_sk\" AS \"ca_address_sk_c87\"\n               FROM\n                  \"tpcds\".\"customer_address\" AS \"customer_address_t85\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_89\"\n            ON\n               \"t_84\".\"c_current_addr_sk_c83\" = \"t_89\".\"ca_address_sk_c87\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               5\n         UNION ALL\n            SELECT\n               \"t_102\".\"c_99\" AS \"d_customer_state_n_gbakc2\",\n               CAST(NULL AS BIGINT) AS \"c_31\",\n               COUNT(\"web_sales_t93\".\"ws_bill_customer_sk\") AS \"c_32\",\n               CAST(NULL AS BIGINT) AS \"c_33\",\n               \"t_102\".\"c_99\" AS \"d_customer_state_n_gbakc1\"\n            FROM\n               \"tpcds\".\"web_sales\" AS \"web_sales_t93\"\n            JOIN\n            (\n               SELECT\n                  \"customer_t94\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c96\",\n                  \"customer_t94\".\"c_customer_sk\" AS \"c_customer_sk_c95\"\n               FROM\n                  \"tpcds\".\"customer\" AS \"customer_t94\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_97\"\n            ON\n               \"web_sales_t93\".\"ws_bill_customer_sk\" = \"t_97\".\"c_customer_sk_c95\"\n            JOIN\n            (\n               SELECT\n                  CASE\n    WHEN \"customer_address_t98\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t98\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t98\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t98\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t98\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t98\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t98\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t98\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t98\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t98\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t98\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t98\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t98\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t98\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t98\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t98\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t98\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t98\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t98\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t98\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t98\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t98\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t98\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t98\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t98\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t98\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t98\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t98\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t98\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t98\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t98\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t98\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t98\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t98\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t98\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t98\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t98\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t98\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t98\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t98\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t98\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t98\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t98\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t98\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t98\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t98\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t98\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t98\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t98\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t98\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t98\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_99\",\n                  \"customer_address_t98\".\"ca_address_sk\" AS \"ca_address_sk_c100\"\n               FROM\n                  \"tpcds\".\"customer_address\" AS \"customer_address_t98\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_102\"\n            ON\n               \"t_97\".\"c_current_addr_sk_c96\" = \"t_102\".\"ca_address_sk_c100\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               5\n         UNION ALL\n            SELECT\n               \"t_115\".\"c_112\" AS \"d_customer_state_n_gbakc2\",\n               COUNT(\"store_sales_t106\".\"ss_customer_sk\") AS \"c_31\",\n               CAST(NULL AS BIGINT) AS \"c_32\",\n               CAST(NULL AS BIGINT) AS \"c_33\",\n               \"t_115\".\"c_112\" AS \"d_customer_state_n_gbakc1\"\n            FROM\n               \"tpcds\".\"store_sales\" AS \"store_sales_t106\"\n            JOIN\n            (\n               SELECT\n                  \"customer_t107\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c109\",\n                  \"customer_t107\".\"c_customer_sk\" AS \"c_customer_sk_c108\"\n               FROM\n                  \"tpcds\".\"customer\" AS \"customer_t107\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_110\"\n            ON\n               \"store_sales_t106\".\"ss_customer_sk\" = \"t_110\".\"c_customer_sk_c108\"\n            JOIN\n            (\n               SELECT\n                  CASE\n    WHEN \"customer_address_t111\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t111\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t111\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t111\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t111\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t111\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t111\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t111\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t111\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t111\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t111\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t111\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t111\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t111\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t111\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t111\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t111\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t111\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t111\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t111\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t111\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t111\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t111\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t111\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t111\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t111\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t111\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t111\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t111\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t111\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t111\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t111\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t111\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t111\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t111\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t111\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t111\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t111\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t111\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t111\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t111\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t111\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t111\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t111\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t111\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t111\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t111\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t111\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t111\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t111\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t111\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_112\",\n                  \"customer_address_t111\".\"ca_address_sk\" AS \"ca_address_sk_c113\"\n               FROM\n                  \"tpcds\".\"customer_address\" AS \"customer_address_t111\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_115\"\n            ON\n               \"t_110\".\"c_current_addr_sk_c109\" = \"t_115\".\"ca_address_sk_c113\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               5\n      ) AS \"t_117\"\n      GROUP BY\n         1,\n         5\n   ) AS \"t_118\"\n   GROUP BY\n      1,\n      3\n) AS \"t_135\"\nORDER BY\n   1 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q12": {
        "question": "What is the number of store returns for each product?",
        "expected_query": "SELECT\n   \"t_43\".\"i_product_name_gbakc2\" AS \"i_product_name\",\n   \"t_43\".\"m_store_returns_co_gbakc3\" AS \"m_store_returns_count_sum\"\nFROM\n(\n   SELECT\n      \"t_41\".\"i_product_name_c39\" AS \"i_product_name_gbakc2\",\n      CAST(SUM(\"t_37\".\"returns_count\") AS BIGINT) AS \"m_store_returns_co_gbakc3\",\n      \"t_41\".\"i_product_name_c39\" AS \"i_product_name_gbakc1\"\n   FROM\n   (\nSELECT ss.*, sr.*, case when (sr_returned_date_sk - ss_sold_date_sk <= 30) then '<= 30 days' when (sr_returned_date_sk - ss_sold_date_sk > 30) and   (sr_returned_date_sk - ss_sold_date_sk <= 60) then '31-60 days' when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then '61-90 days' when (sr_returned_date_sk - ss_sold_date_sk > 90) and  (sr_returned_date_sk - ss_sold_date_sk <= 120) then '91-120 days' else '> 120 days' end as returns_time_tier, 1 as returns_count  FROM atscale_tutorial_data.tpcds.store_returns sr INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk\n   ) AS \"t_37\"\n   JOIN\n   (\n      SELECT\n         \"item_t38\".\"i_item_sk\" AS \"i_item_sk_c40\",\n         \"item_t38\".\"i_product_name\" AS \"i_product_name_c39\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t38\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_41\"\n   ON\n      \"t_37\".\"sr_item_sk\" = \"t_41\".\"i_item_sk_c40\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      3\n) AS \"t_43\"\nORDER BY\n   1 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q13": {
        "question": "What was the overall web sales for the year 2002?",
        "expected_query": "SELECT\n   \"t_52\".\"m_web_sales_sum_gbakc2\" AS \"m_web_sales_sum\",\n   \"t_52\".\"sold_calendar_year_gbakc3\" AS \"Sold Calendar Year\"\nFROM\n(\n   SELECT\n      CAST(SUM(CAST(\"web_sales_t45\".ws_ext_sales_price*\"web_sales_t45\".ws_quantity AS decimal(38,2))) AS DECIMAL(38,2)) AS \"m_web_sales_sum_gbakc2\",\n      \"t_50\".\"d_year_c48\" AS \"sold_calendar_year_gbakc3\",\n      \"t_50\".\"d_year_c48\" AS \"sold_calendar_year_gbakc1\"\n   FROM\n      \"tpcds\".\"web_sales\" AS \"web_sales_t45\"\n   JOIN\n   (\n      SELECT\n         \"date_dim_t47\".\"d_date_sk\" AS \"d_date_sk_c49\",\n         \"date_dim_t47\".\"d_year\" AS \"d_year_c48\"\n      FROM\n         \"tpcds\".\"date_dim\" AS \"date_dim_t47\"\n      WHERE\n         \"date_dim_t47\".\"d_year\" = 2002\n      GROUP BY\n         1,\n         2\n   ) AS \"t_50\"\n   ON\n      \"web_sales_t45\".\"ws_sold_date_sk\" = \"t_50\".\"d_date_sk_c49\"\n   WHERE\n      true\n   GROUP BY\n      2,\n      3\n) AS \"t_52\"\nORDER BY\n   2 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q14": {
        "question": "What is the average sales quantity per store number?",
        "expected_query": "SELECT\n   \"t_60\".\"store_number_gbakc2\" AS \"Store_Number\",\n   \"t_60\".\"m_ss_quantity_avg_gbakc3\" AS \"m_ss_quantity_avg\"\nFROM\n(\n   SELECT\n      \"t_52\".\"s_store_sk_c51\" AS \"store_number_gbakc2\",\n      CASE WHEN (COUNT(\"store_sales_t49\".\"ss_quantity\") = 0) THEN NULL ELSE (CAST(CAST(SUM(\"store_sales_t49\".\"ss_quantity\") AS BIGINT) AS FLOAT8) / COUNT(\"store_sales_t49\".\"ss_quantity\")) END AS \"m_ss_quantity_avg_gbakc3\",\n      \"t_52\".\"s_store_sk_c51\" AS \"store_number_gbakc1\"\n   FROM\n      \"tpcds\".\"store_sales\" AS \"store_sales_t49\"\n   JOIN\n   (\n      SELECT\n         \"store_t50\".\"s_store_sk\" AS \"s_store_sk_c51\"\n      FROM\n         \"tpcds\".\"store\" AS \"store_t50\"\n      WHERE\n         true\n      GROUP BY\n         1\n   ) AS \"t_52\"\n   ON\n      \"store_sales_t49\".\"ss_store_sk\" = \"t_52\".\"s_store_sk_c51\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      3\n) AS \"t_60\"\nORDER BY\n   1 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q15": {
        "question": "What is the total net profit per product name?",
        "expected_query": "SELECT\n   \"t_120\".\"i_product_name_gbakc2\" AS \"i_product_name\",\n   \"t_120\".\"total_net_profit_gbakc3\" AS \"Total Net Profit\"\nFROM\n(\n   SELECT\n      \"t_103\".\"i_product_name_gbakc2\" AS \"i_product_name_gbakc2\",\n      CASE WHEN (CAST(COALESCE(MIN(\"t_103\".\"c_31\"), MIN(\"t_103\".\"c_32\"), MIN(\"t_103\".\"c_33\")) AS DECIMAL(17,2)) IS NULL) THEN CAST(NULL AS DECIMAL(18,2)) ELSE CAST((CAST((CAST(COALESCE(MIN(\"t_103\".\"c_31\"), 0) AS DECIMAL(18,2)) + CAST(COALESCE(MIN(\"t_103\".\"c_32\"), 0) AS DECIMAL(18,2))) AS DECIMAL(18,2)) + CAST(COALESCE(MIN(\"t_103\".\"c_33\"), 0) AS DECIMAL(18,2))) AS DECIMAL(18,2)) END AS \"total_net_profit_gbakc3\",\n      \"t_103\".\"i_product_name_gbakc1\" AS \"i_product_name_gbakc1\"\n   FROM\n   (\n      SELECT\n         \"t_102\".\"i_product_name_gbakc2\" AS \"i_product_name_gbakc2\",\n         MIN(\"t_102\".\"c_31\") AS \"c_31\",\n         MIN(\"t_102\".\"c_32\") AS \"c_32\",\n         MIN(\"t_102\".\"c_33\") AS \"c_33\",\n         \"t_102\".\"i_product_name_gbakc1\" AS \"i_product_name_gbakc1\"\n      FROM\n      (\n            SELECT\n               \"t_84\".\"i_product_name_c82\" AS \"i_product_name_gbakc2\",\n               CAST(CAST(SUM(\"store_sales_t80\".\"ss_net_profit\") AS DECIMAL(17,2)) AS DECIMAL(17,2)) AS \"c_31\",\n               CAST(NULL AS DECIMAL(17,2)) AS \"c_32\",\n               CAST(NULL AS DECIMAL(17,2)) AS \"c_33\",\n               \"t_84\".\"i_product_name_c82\" AS \"i_product_name_gbakc1\"\n            FROM\n               \"tpcds\".\"store_sales\" AS \"store_sales_t80\"\n            JOIN\n            (\n               SELECT\n                  \"item_t81\".\"i_item_sk\" AS \"i_item_sk_c83\",\n                  \"item_t81\".\"i_product_name\" AS \"i_product_name_c82\"\n               FROM\n                  \"tpcds\".\"item\" AS \"item_t81\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_84\"\n            ON\n               \"store_sales_t80\".\"ss_item_sk\" = \"t_84\".\"i_item_sk_c83\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               5\n         UNION ALL\n            SELECT\n               \"t_92\".\"i_product_name_c90\" AS \"i_product_name_gbakc2\",\n               CAST(NULL AS DECIMAL(17,2)) AS \"c_31\",\n               CAST(CAST(SUM(\"web_sales_t88\".\"ws_net_profit\") AS DECIMAL(17,2)) AS DECIMAL(17,2)) AS \"c_32\",\n               CAST(NULL AS DECIMAL(17,2)) AS \"c_33\",\n               \"t_92\".\"i_product_name_c90\" AS \"i_product_name_gbakc1\"\n            FROM\n               \"tpcds\".\"web_sales\" AS \"web_sales_t88\"\n            JOIN\n            (\n               SELECT\n                  \"item_t89\".\"i_item_sk\" AS \"i_item_sk_c91\",\n                  \"item_t89\".\"i_product_name\" AS \"i_product_name_c90\"\n               FROM\n                  \"tpcds\".\"item\" AS \"item_t89\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_92\"\n            ON\n               \"web_sales_t88\".\"ws_item_sk\" = \"t_92\".\"i_item_sk_c91\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               5\n         UNION ALL\n            SELECT\n               \"t_100\".\"i_product_name_c98\" AS \"i_product_name_gbakc2\",\n               CAST(NULL AS DECIMAL(17,2)) AS \"c_31\",\n               CAST(NULL AS DECIMAL(17,2)) AS \"c_32\",\n               CAST(CAST(SUM(\"catalog_sales_t96\".\"cs_net_profit\") AS DECIMAL(17,2)) AS DECIMAL(17,2)) AS \"c_33\",\n               \"t_100\".\"i_product_name_c98\" AS \"i_product_name_gbakc1\"\n            FROM\n               \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t96\"\n            JOIN\n            (\n               SELECT\n                  \"item_t97\".\"i_item_sk\" AS \"i_item_sk_c99\",\n                  \"item_t97\".\"i_product_name\" AS \"i_product_name_c98\"\n               FROM\n                  \"tpcds\".\"item\" AS \"item_t97\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_100\"\n            ON\n               \"catalog_sales_t96\".\"cs_item_sk\" = \"t_100\".\"i_item_sk_c99\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               5\n      ) AS \"t_102\"\n      GROUP BY\n         1,\n         5\n   ) AS \"t_103\"\n   GROUP BY\n      1,\n      3\n) AS \"t_120\"\nORDER BY\n   1 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q16": {
        "question": "What is the count of catalog customers?",
        "expected_query": "SELECT\n   COUNT(\"catalog_sales_t13\".\"cs_bill_customer_sk\") AS \"m_cs_bill_customer_sk_count\"\nFROM\n   \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t13\"\nWHERE\n   true",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q17": {
        "question": "For each brand name, what was the quantity sold in store?",
        "expected_query": "SELECT\n   \"t_44\".\"d_product_brand_na_gbakc2\" AS \"d_product_brand_name\",\n   \"t_44\".\"m_ss_quantity_sum_gbakc3\" AS \"m_ss_quantity_sum\"\nFROM\n(\n   SELECT\n      \"t_42\".\"i_brand_c40\" AS \"d_product_brand_na_gbakc2\",\n      CAST(SUM(\"store_sales_t37\".\"ss_quantity\") AS BIGINT) AS \"m_ss_quantity_sum_gbakc3\",\n      \"t_42\".\"i_brand_id_c39\" AS \"d_product_brand_na_gbakc1\"\n   FROM\n      \"tpcds\".\"store_sales\" AS \"store_sales_t37\"\n   JOIN\n   (\n      SELECT\n         \"item_t38\".\"i_brand\" AS \"i_brand_c40\",\n         \"item_t38\".\"i_brand_id\" AS \"i_brand_id_c39\",\n         \"item_t38\".\"i_item_sk\" AS \"i_item_sk_c41\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t38\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2,\n         3\n   ) AS \"t_42\"\n   ON\n      \"store_sales_t37\".\"ss_item_sk\" = \"t_42\".\"i_item_sk_c41\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      3\n) AS \"t_44\"\nORDER BY\n   1 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q18": {
        "question": "What is the total quantity sold each year?",
        "expected_query": "SELECT\n   \"t_120\".\"total_quantity_sol_gbakc2\" AS \"Total Quantity Sold\",\n   \"t_120\".\"sold_calendar_year_gbakc3\" AS \"Sold Calendar Year\"\nFROM\n(\n   SELECT\n      CASE WHEN (COALESCE(MIN(\"t_103\".\"c_30\"), MIN(\"t_103\".\"c_31\"), MIN(\"t_103\".\"c_32\")) IS NULL) THEN NULL ELSE ((COALESCE(MIN(\"t_103\".\"c_30\"), CAST(0 AS BIGINT)) + COALESCE(MIN(\"t_103\".\"c_31\"), CAST(0 AS BIGINT))) + COALESCE(MIN(\"t_103\".\"c_32\"), CAST(0 AS BIGINT))) END AS \"total_quantity_sol_gbakc2\",\n      \"t_103\".\"sold_calendar_year_gbakc3\" AS \"sold_calendar_year_gbakc3\",\n      \"t_103\".\"sold_calendar_year_gbakc1\" AS \"sold_calendar_year_gbakc1\"\n   FROM\n   (\n      SELECT\n         MIN(\"t_102\".\"c_30\") AS \"c_30\",\n         MIN(\"t_102\".\"c_31\") AS \"c_31\",\n         MIN(\"t_102\".\"c_32\") AS \"c_32\",\n         \"t_102\".\"sold_calendar_year_gbakc3\" AS \"sold_calendar_year_gbakc3\",\n         \"t_102\".\"sold_calendar_year_gbakc1\" AS \"sold_calendar_year_gbakc1\"\n      FROM\n      (\n            SELECT\n               CAST(SUM(\"store_sales_t80\".\"ss_quantity\") AS BIGINT) AS \"c_30\",\n               CAST(NULL AS BIGINT) AS \"c_31\",\n               CAST(NULL AS BIGINT) AS \"c_32\",\n               \"t_84\".\"d_year_c82\" AS \"sold_calendar_year_gbakc3\",\n               \"t_84\".\"d_year_c82\" AS \"sold_calendar_year_gbakc1\"\n            FROM\n               \"tpcds\".\"store_sales\" AS \"store_sales_t80\"\n            JOIN\n            (\n               SELECT\n                  \"date_dim_t81\".\"d_date_sk\" AS \"d_date_sk_c83\",\n                  \"date_dim_t81\".\"d_year\" AS \"d_year_c82\"\n               FROM\n                  \"tpcds\".\"date_dim\" AS \"date_dim_t81\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_84\"\n            ON\n               \"store_sales_t80\".\"ss_sold_date_sk\" = \"t_84\".\"d_date_sk_c83\"\n            WHERE\n               true\n            GROUP BY\n               4,\n               5\n         UNION ALL\n            SELECT\n               CAST(NULL AS BIGINT) AS \"c_30\",\n               CAST(SUM(\"web_sales_t88\".\"ws_quantity\") AS BIGINT) AS \"c_31\",\n               CAST(NULL AS BIGINT) AS \"c_32\",\n               \"t_92\".\"d_year_c90\" AS \"sold_calendar_year_gbakc3\",\n               \"t_92\".\"d_year_c90\" AS \"sold_calendar_year_gbakc1\"\n            FROM\n               \"tpcds\".\"web_sales\" AS \"web_sales_t88\"\n            JOIN\n            (\n               SELECT\n                  \"date_dim_t89\".\"d_date_sk\" AS \"d_date_sk_c91\",\n                  \"date_dim_t89\".\"d_year\" AS \"d_year_c90\"\n               FROM\n                  \"tpcds\".\"date_dim\" AS \"date_dim_t89\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_92\"\n            ON\n               \"web_sales_t88\".\"ws_sold_date_sk\" = \"t_92\".\"d_date_sk_c91\"\n            WHERE\n               true\n            GROUP BY\n               4,\n               5\n         UNION ALL\n            SELECT\n               CAST(NULL AS BIGINT) AS \"c_30\",\n               CAST(NULL AS BIGINT) AS \"c_31\",\n               CAST(SUM(\"catalog_sales_t96\".\"cs_quantity\") AS BIGINT) AS \"c_32\",\n               \"t_100\".\"d_year_c98\" AS \"sold_calendar_year_gbakc3\",\n               \"t_100\".\"d_year_c98\" AS \"sold_calendar_year_gbakc1\"\n            FROM\n               \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t96\"\n            JOIN\n            (\n               SELECT\n                  \"date_dim_t97\".\"d_date_sk\" AS \"d_date_sk_c99\",\n                  \"date_dim_t97\".\"d_year\" AS \"d_year_c98\"\n               FROM\n                  \"tpcds\".\"date_dim\" AS \"date_dim_t97\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  2\n            ) AS \"t_100\"\n            ON\n               \"catalog_sales_t96\".\"cs_sold_date_sk\" = \"t_100\".\"d_date_sk_c99\"\n            WHERE\n               true\n            GROUP BY\n               4,\n               5\n      ) AS \"t_102\"\n      GROUP BY\n         4,\n         5\n   ) AS \"t_103\"\n   GROUP BY\n      2,\n      3\n) AS \"t_120\"\nORDER BY\n   2 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q19": {
        "question": "What is the count of products in each product category?",
        "expected_query": "SELECT\n   \"t_43\".\"i_category_gbakc2\" AS \"I category\",\n   \"t_43\".\"product_count_gbakc3\" AS \"product_count\"\nFROM\n(\n   SELECT\n      \"t_41\".\"i_category_c39\" AS \"i_category_gbakc2\",\n      COUNT(DISTINCT \"inventory_t37\".\"inv_item_sk\") AS \"product_count_gbakc3\",\n      \"t_41\".\"i_category_c39\" AS \"i_category_gbakc1\"\n   FROM\n      \"tpcds\".\"inventory\" AS \"inventory_t37\"\n   JOIN\n   (\n      SELECT\n         \"item_t38\".\"i_category\" AS \"i_category_c39\",\n         \"item_t38\".\"i_item_sk\" AS \"i_item_sk_c40\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t38\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_41\"\n   ON\n      \"inventory_t37\".\"inv_item_sk\" = \"t_41\".\"i_item_sk_c40\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      3\n) AS \"t_43\"\nORDER BY\n   1 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q20": {
        "question": "What is the total web sales for each customer home state?",
        "expected_query": "SELECT\n   \"t_49\".\"d_customer_state_n_gbakc2\" AS \"d_Customer State Name\",\n   \"t_49\".\"m_web_sales_sum_gbakc3\" AS \"m_web_sales_sum\"\nFROM\n(\n   SELECT\n      \"t_47\".\"c_44\" AS \"d_customer_state_n_gbakc2\",\n      CAST(SUM(CAST(\"web_sales_t37\".ws_ext_sales_price*\"web_sales_t37\".ws_quantity AS decimal(38,2))) AS DECIMAL(38,2)) AS \"m_web_sales_sum_gbakc3\",\n      \"t_47\".\"c_44\" AS \"d_customer_state_n_gbakc1\"\n   FROM\n      \"tpcds\".\"web_sales\" AS \"web_sales_t37\"\n   JOIN\n   (\n      SELECT\n         \"customer_t39\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c41\",\n         \"customer_t39\".\"c_customer_sk\" AS \"c_customer_sk_c40\"\n      FROM\n         \"tpcds\".\"customer\" AS \"customer_t39\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_42\"\n   ON\n      \"web_sales_t37\".\"ws_bill_customer_sk\" = \"t_42\".\"c_customer_sk_c40\"\n   JOIN\n   (\n      SELECT\n         CASE\n    WHEN \"customer_address_t43\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t43\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t43\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t43\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t43\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t43\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t43\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t43\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t43\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t43\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t43\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t43\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t43\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t43\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t43\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t43\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t43\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t43\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t43\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t43\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t43\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t43\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t43\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t43\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t43\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t43\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t43\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t43\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t43\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t43\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t43\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t43\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t43\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t43\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t43\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t43\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t43\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t43\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t43\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t43\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t43\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t43\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t43\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t43\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t43\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t43\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t43\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t43\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t43\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t43\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t43\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_44\",\n         \"customer_address_t43\".\"ca_address_sk\" AS \"ca_address_sk_c45\"\n      FROM\n         \"tpcds\".\"customer_address\" AS \"customer_address_t43\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_47\"\n   ON\n      \"t_42\".\"c_current_addr_sk_c41\" = \"t_47\".\"ca_address_sk_c45\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      3\n) AS \"t_49\"\nORDER BY\n   1 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "L"
    },
    "Q21": {
        "question": "What is the customer id and vehicle count for every customer in income band 9?",
        "expected_query": "SELECT\n   \"t_309\".\"d_customer_id_gbakc4\" AS \"d_customer_id\",\n   \"t_309\".\"d_hd_vehicle_count_gbakc5\" AS \"d_hd_vehicle_count\",\n   \"t_309\".\"income_band_gbakc6\" AS \"Income Band\"\nFROM\n(\n   SELECT\n      \"t_301\".\"d_customer_id_gbakc4\" AS \"d_customer_id_gbakc4\",\n      \"t_301\".\"d_hd_vehicle_count_gbakc5\" AS \"d_hd_vehicle_count_gbakc5\",\n      \"t_301\".\"income_band_gbakc6\" AS \"income_band_gbakc6\",\n      \"t_301\".\"d_customer_id_gbakc1\" AS \"d_customer_id_gbakc1\",\n      \"t_301\".\"d_hd_vehicle_count_gbakc2\" AS \"d_hd_vehicle_count_gbakc2\",\n      \"t_301\".\"income_band_gbakc3\" AS \"income_band_gbakc3\"\n   FROM\n   (\n         SELECT\n            \"t_219\".\"c_customer_id_c217\" AS \"d_customer_id_gbakc4\",\n            \"t_212\".\"hd_vehicle_count_c211\" AS \"d_hd_vehicle_count_gbakc5\",\n            \"t_215\".\"ib_income_band_sk_c214\" AS \"income_band_gbakc6\",\n            \"t_219\".\"c_customer_id_c217\" AS \"d_customer_id_gbakc1\",\n            \"t_212\".\"hd_vehicle_count_c211\" AS \"d_hd_vehicle_count_gbakc2\",\n            \"t_215\".\"ib_income_band_sk_c214\" AS \"income_band_gbakc3\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t207\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t208\".\"hd_demo_sk\" AS \"hd_demo_sk_c209\",\n               \"household_demograp_t208\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c210\",\n               \"household_demograp_t208\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c211\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t208\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_212\"\n         ON\n            \"store_sales_t207\".\"ss_hdemo_sk\" = \"t_212\".\"hd_demo_sk_c209\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t213\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c214\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t213\"\n            WHERE\n               \"income_band_t213\".\"ib_income_band_sk\" = 9\n            GROUP BY\n               1\n         ) AS \"t_215\"\n         ON\n            \"t_212\".\"hd_income_band_sk_c210\" = \"t_215\".\"ib_income_band_sk_c214\"\n         JOIN\n         (\n            SELECT\n               \"customer_t216\".\"c_customer_id\" AS \"c_customer_id_c217\",\n               \"customer_t216\".\"c_customer_sk\" AS \"c_customer_sk_c218\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t216\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_219\"\n         ON\n            \"store_sales_t207\".\"ss_customer_sk\" = \"t_219\".\"c_customer_sk_c218\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_239\".\"c_customer_id_c237\" AS \"d_customer_id_gbakc4\",\n            \"t_232\".\"hd_vehicle_count_c231\" AS \"d_hd_vehicle_count_gbakc5\",\n            \"t_235\".\"ib_income_band_sk_c234\" AS \"income_band_gbakc6\",\n            \"t_239\".\"c_customer_id_c237\" AS \"d_customer_id_gbakc1\",\n            \"t_232\".\"hd_vehicle_count_c231\" AS \"d_hd_vehicle_count_gbakc2\",\n            \"t_235\".\"ib_income_band_sk_c234\" AS \"income_band_gbakc3\"\n         FROM\n         (\nSELECT ss.*, sr.*, case when (sr_returned_date_sk - ss_sold_date_sk <= 30) then '<= 30 days' when (sr_returned_date_sk - ss_sold_date_sk > 30) and   (sr_returned_date_sk - ss_sold_date_sk <= 60) then '31-60 days' when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then '61-90 days' when (sr_returned_date_sk - ss_sold_date_sk > 90) and  (sr_returned_date_sk - ss_sold_date_sk <= 120) then '91-120 days' else '> 120 days' end as returns_time_tier, 1 as returns_count  FROM atscale_tutorial_data.tpcds.store_returns sr INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk\n         ) AS \"t_227\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t228\".\"hd_demo_sk\" AS \"hd_demo_sk_c229\",\n               \"household_demograp_t228\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c230\",\n               \"household_demograp_t228\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c231\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t228\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_232\"\n         ON\n            \"t_227\".\"sr_hdemo_sk\" = \"t_232\".\"hd_demo_sk_c229\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t233\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c234\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t233\"\n            WHERE\n               \"income_band_t233\".\"ib_income_band_sk\" = 9\n            GROUP BY\n               1\n         ) AS \"t_235\"\n         ON\n            \"t_232\".\"hd_income_band_sk_c230\" = \"t_235\".\"ib_income_band_sk_c234\"\n         JOIN\n         (\n            SELECT\n               \"customer_t236\".\"c_customer_id\" AS \"c_customer_id_c237\",\n               \"customer_t236\".\"c_customer_sk\" AS \"c_customer_sk_c238\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t236\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_239\"\n         ON\n            \"t_227\".\"sr_customer_sk\" = \"t_239\".\"c_customer_sk_c238\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_259\".\"c_customer_id_c257\" AS \"d_customer_id_gbakc4\",\n            \"t_252\".\"hd_vehicle_count_c251\" AS \"d_hd_vehicle_count_gbakc5\",\n            \"t_255\".\"ib_income_band_sk_c254\" AS \"income_band_gbakc6\",\n            \"t_259\".\"c_customer_id_c257\" AS \"d_customer_id_gbakc1\",\n            \"t_252\".\"hd_vehicle_count_c251\" AS \"d_hd_vehicle_count_gbakc2\",\n            \"t_255\".\"ib_income_band_sk_c254\" AS \"income_band_gbakc3\"\n         FROM\n            \"tpcds\".\"web_sales\" AS \"web_sales_t247\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t248\".\"hd_demo_sk\" AS \"hd_demo_sk_c249\",\n               \"household_demograp_t248\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c250\",\n               \"household_demograp_t248\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c251\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t248\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_252\"\n         ON\n            \"web_sales_t247\".\"ws_bill_hdemo_sk\" = \"t_252\".\"hd_demo_sk_c249\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t253\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c254\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t253\"\n            WHERE\n               \"income_band_t253\".\"ib_income_band_sk\" = 9\n            GROUP BY\n               1\n         ) AS \"t_255\"\n         ON\n            \"t_252\".\"hd_income_band_sk_c250\" = \"t_255\".\"ib_income_band_sk_c254\"\n         JOIN\n         (\n            SELECT\n               \"customer_t256\".\"c_customer_id\" AS \"c_customer_id_c257\",\n               \"customer_t256\".\"c_customer_sk\" AS \"c_customer_sk_c258\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t256\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_259\"\n         ON\n            \"web_sales_t247\".\"ws_bill_customer_sk\" = \"t_259\".\"c_customer_sk_c258\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_279\".\"c_customer_id_c277\" AS \"d_customer_id_gbakc4\",\n            \"t_272\".\"hd_vehicle_count_c271\" AS \"d_hd_vehicle_count_gbakc5\",\n            \"t_275\".\"ib_income_band_sk_c274\" AS \"income_band_gbakc6\",\n            \"t_279\".\"c_customer_id_c277\" AS \"d_customer_id_gbakc1\",\n            \"t_272\".\"hd_vehicle_count_c271\" AS \"d_hd_vehicle_count_gbakc2\",\n            \"t_275\".\"ib_income_band_sk_c274\" AS \"income_band_gbakc3\"\n         FROM\n         (\nSELECT p.*, ss.*  FROM atscale_tutorial_data.tpcds.promotion p INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_promo_sk = p.p_promo_sk\n         ) AS \"t_267\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t268\".\"hd_demo_sk\" AS \"hd_demo_sk_c269\",\n               \"household_demograp_t268\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c270\",\n               \"household_demograp_t268\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c271\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t268\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_272\"\n         ON\n            \"t_267\".\"ss_hdemo_sk\" = \"t_272\".\"hd_demo_sk_c269\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t273\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c274\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t273\"\n            WHERE\n               \"income_band_t273\".\"ib_income_band_sk\" = 9\n            GROUP BY\n               1\n         ) AS \"t_275\"\n         ON\n            \"t_272\".\"hd_income_band_sk_c270\" = \"t_275\".\"ib_income_band_sk_c274\"\n         JOIN\n         (\n            SELECT\n               \"customer_t276\".\"c_customer_id\" AS \"c_customer_id_c277\",\n               \"customer_t276\".\"c_customer_sk\" AS \"c_customer_sk_c278\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t276\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_279\"\n         ON\n            \"t_267\".\"ss_customer_sk\" = \"t_279\".\"c_customer_sk_c278\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_299\".\"c_customer_id_c297\" AS \"d_customer_id_gbakc4\",\n            \"t_292\".\"hd_vehicle_count_c291\" AS \"d_hd_vehicle_count_gbakc5\",\n            \"t_295\".\"ib_income_band_sk_c294\" AS \"income_band_gbakc6\",\n            \"t_299\".\"c_customer_id_c297\" AS \"d_customer_id_gbakc1\",\n            \"t_292\".\"hd_vehicle_count_c291\" AS \"d_hd_vehicle_count_gbakc2\",\n            \"t_295\".\"ib_income_band_sk_c294\" AS \"income_band_gbakc3\"\n         FROM\n            \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t287\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t288\".\"hd_demo_sk\" AS \"hd_demo_sk_c289\",\n               \"household_demograp_t288\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c290\",\n               \"household_demograp_t288\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c291\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t288\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_292\"\n         ON\n            \"catalog_sales_t287\".\"cs_ship_customer_sk\" = \"t_292\".\"hd_demo_sk_c289\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t293\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c294\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t293\"\n            WHERE\n               \"income_band_t293\".\"ib_income_band_sk\" = 9\n            GROUP BY\n               1\n         ) AS \"t_295\"\n         ON\n            \"t_292\".\"hd_income_band_sk_c290\" = \"t_295\".\"ib_income_band_sk_c294\"\n         JOIN\n         (\n            SELECT\n               \"customer_t296\".\"c_customer_id\" AS \"c_customer_id_c297\",\n               \"customer_t296\".\"c_customer_sk\" AS \"c_customer_sk_c298\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t296\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_299\"\n         ON\n            \"catalog_sales_t287\".\"cs_bill_customer_sk\" = \"t_299\".\"c_customer_sk_c298\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n   ) AS \"t_301\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6\n) AS \"t_309\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q22": {
        "question": "What is the net profit tier for each store name and gender in the 2002 sales year?",
        "expected_query": "SELECT\n   \"t_120\".\"d_net_profit_tier_gbakc5\" AS \"d_net_profit_tier\",\n   \"t_120\".\"d_store_name_gbakc6\" AS \"d_store_name\",\n   \"t_120\".\"d_cd_gender_gbakc7\" AS \"d_cd_gender\",\n   \"t_120\".\"sold_calendar_year_gbakc8\" AS \"Sold Calendar Year\"\nFROM\n(\n   SELECT\n      CASE WHEN \"store_sales_t105\".ss_net_profit > 25000 THEN 'More than 25000'  WHEN \"store_sales_t105\".ss_net_profit BETWEEN 3000 AND 25000 THEN '3000-25000' WHEN \"store_sales_t105\".ss_net_profit BETWEEN 2000 AND 3000 THEN '2000-3000'   WHEN \"store_sales_t105\".ss_net_profit BETWEEN 300 AND 2000 THEN '300-2000'   WHEN \"store_sales_t105\".ss_net_profit BETWEEN 250 AND 300 THEN '250-300'   WHEN \"store_sales_t105\".ss_net_profit BETWEEN 200 AND 250 THEN '200-250' WHEN \"store_sales_t105\".ss_net_profit BETWEEN 150 AND 200 THEN '150-200' WHEN \"store_sales_t105\".ss_net_profit BETWEEN 100 AND 150 THEN '100-150'  WHEN \"store_sales_t105\".ss_net_profit BETWEEN 50 AND 100 THEN ' 50-100' WHEN \"store_sales_t105\".ss_net_profit BETWEEN 0 AND 50 THEN '  0- 50'  ELSE ' 50 or Less' END AS \"d_net_profit_tier_gbakc5\",\n      \"t_114\".\"s_store_name_c112\" AS \"d_store_name_gbakc6\",\n      \"t_118\".\"cd_gender_c117\" AS \"d_cd_gender_gbakc7\",\n      \"t_110\".\"d_year_c108\" AS \"sold_calendar_year_gbakc8\",\n      CASE WHEN \"store_sales_t105\".ss_net_profit > 25000 THEN 'More than 25000'  WHEN \"store_sales_t105\".ss_net_profit BETWEEN 3000 AND 25000 THEN '3000-25000' WHEN \"store_sales_t105\".ss_net_profit BETWEEN 2000 AND 3000 THEN '2000-3000'   WHEN \"store_sales_t105\".ss_net_profit BETWEEN 300 AND 2000 THEN '300-2000'   WHEN \"store_sales_t105\".ss_net_profit BETWEEN 250 AND 300 THEN '250-300'   WHEN \"store_sales_t105\".ss_net_profit BETWEEN 200 AND 250 THEN '200-250' WHEN \"store_sales_t105\".ss_net_profit BETWEEN 150 AND 200 THEN '150-200' WHEN \"store_sales_t105\".ss_net_profit BETWEEN 100 AND 150 THEN '100-150'  WHEN \"store_sales_t105\".ss_net_profit BETWEEN 50 AND 100 THEN ' 50-100' WHEN \"store_sales_t105\".ss_net_profit BETWEEN 0 AND 50 THEN '  0- 50'  ELSE ' 50 or Less' END AS \"d_net_profit_tier_gbakc1\",\n      \"t_114\".\"s_store_name_c112\" AS \"d_store_name_gbakc2\",\n      \"t_118\".\"cd_gender_c117\" AS \"d_cd_gender_gbakc3\",\n      \"t_110\".\"d_year_c108\" AS \"sold_calendar_year_gbakc4\"\n   FROM\n      \"tpcds\".\"store_sales\" AS \"store_sales_t105\"\n   JOIN\n   (\n      SELECT\n         \"date_dim_t107\".\"d_date_sk\" AS \"d_date_sk_c109\",\n         \"date_dim_t107\".\"d_year\" AS \"d_year_c108\"\n      FROM\n         \"tpcds\".\"date_dim\" AS \"date_dim_t107\"\n      WHERE\n         \"date_dim_t107\".\"d_year\" = 2002\n      GROUP BY\n         1,\n         2\n   ) AS \"t_110\"\n   ON\n      \"store_sales_t105\".\"ss_sold_date_sk\" = \"t_110\".\"d_date_sk_c109\"\n   JOIN\n   (\n      SELECT\n         \"store_t111\".\"s_store_name\" AS \"s_store_name_c112\",\n         \"store_t111\".\"s_store_sk\" AS \"s_store_sk_c113\"\n      FROM\n         \"tpcds\".\"store\" AS \"store_t111\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_114\"\n   ON\n      \"store_sales_t105\".\"ss_store_sk\" = \"t_114\".\"s_store_sk_c113\"\n   JOIN\n   (\n      SELECT\n         \"customer_demograph_t115\".\"cd_demo_sk\" AS \"cd_demo_sk_c116\",\n         \"customer_demograph_t115\".\"cd_gender\" AS \"cd_gender_c117\"\n      FROM\n         \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t115\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_118\"\n   ON\n      \"store_sales_t105\".\"ss_cdemo_sk\" = \"t_118\".\"cd_demo_sk_c116\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8\n) AS \"t_120\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST,\n   4 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q23": {
        "question": "What was the first name and gender of each customer that shopped in the store named 'ese' in 2001?",
        "expected_query": "SELECT\n   \"t_215\".\"d_customer_first_n_gbakc5\" AS \"d_customer_first_name\",\n   \"t_215\".\"d_cd_gender_gbakc6\" AS \"d_cd_gender\",\n   \"t_215\".\"d_store_name_gbakc7\" AS \"d_store_name\",\n   \"t_215\".\"sold_calendar_year_gbakc8\" AS \"Sold Calendar Year\"\nFROM\n(\n   SELECT\n      \"t_205\".\"d_customer_first_n_gbakc5\" AS \"d_customer_first_n_gbakc5\",\n      \"t_205\".\"d_cd_gender_gbakc6\" AS \"d_cd_gender_gbakc6\",\n      \"t_205\".\"d_store_name_gbakc7\" AS \"d_store_name_gbakc7\",\n      \"t_205\".\"sold_calendar_year_gbakc8\" AS \"sold_calendar_year_gbakc8\",\n      \"t_205\".\"d_customer_first_n_gbakc1\" AS \"d_customer_first_n_gbakc1\",\n      \"t_205\".\"d_cd_gender_gbakc2\" AS \"d_cd_gender_gbakc2\",\n      \"t_205\".\"d_store_name_gbakc3\" AS \"d_store_name_gbakc3\",\n      \"t_205\".\"sold_calendar_year_gbakc4\" AS \"sold_calendar_year_gbakc4\"\n   FROM\n   (\n         SELECT\n            \"t_177\".\"c_first_name_c175\" AS \"d_customer_first_n_gbakc5\",\n            \"t_173\".\"cd_gender_c172\" AS \"d_cd_gender_gbakc6\",\n            \"t_169\".\"s_store_name_c167\" AS \"d_store_name_gbakc7\",\n            \"t_165\".\"d_year_c163\" AS \"sold_calendar_year_gbakc8\",\n            \"t_177\".\"c_first_name_c175\" AS \"d_customer_first_n_gbakc1\",\n            \"t_173\".\"cd_gender_c172\" AS \"d_cd_gender_gbakc2\",\n            \"t_169\".\"s_store_name_c167\" AS \"d_store_name_gbakc3\",\n            \"t_165\".\"d_year_c163\" AS \"sold_calendar_year_gbakc4\"\n         FROM\n         (\nSELECT p.*, ss.*  FROM atscale_tutorial_data.tpcds.promotion p INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_promo_sk = p.p_promo_sk\n         ) AS \"t_161\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t162\".\"d_date_sk\" AS \"d_date_sk_c164\",\n               \"date_dim_t162\".\"d_year\" AS \"d_year_c163\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t162\"\n            WHERE\n               \"date_dim_t162\".\"d_year\" = 2001\n            GROUP BY\n               1,\n               2\n         ) AS \"t_165\"\n         ON\n            \"t_161\".\"ss_sold_date_sk\" = \"t_165\".\"d_date_sk_c164\"\n         JOIN\n         (\n            SELECT\n               \"store_t166\".\"s_store_name\" AS \"s_store_name_c167\",\n               \"store_t166\".\"s_store_sk\" AS \"s_store_sk_c168\"\n            FROM\n               \"tpcds\".\"store\" AS \"store_t166\"\n            WHERE\n               \"store_t166\".\"s_store_name\" = CAST('ese' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_169\"\n         ON\n            \"t_161\".\"ss_store_sk\" = \"t_169\".\"s_store_sk_c168\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t170\".\"cd_demo_sk\" AS \"cd_demo_sk_c171\",\n               \"customer_demograph_t170\".\"cd_gender\" AS \"cd_gender_c172\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t170\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_173\"\n         ON\n            \"t_161\".\"ss_cdemo_sk\" = \"t_173\".\"cd_demo_sk_c171\"\n         JOIN\n         (\n            SELECT\n               \"customer_t174\".\"c_customer_sk\" AS \"c_customer_sk_c176\",\n               \"customer_t174\".\"c_first_name\" AS \"c_first_name_c175\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t174\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_177\"\n         ON\n            \"t_161\".\"ss_customer_sk\" = \"t_177\".\"c_customer_sk_c176\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8\n      UNION ALL\n         SELECT\n            \"t_203\".\"c_first_name_c201\" AS \"d_customer_first_n_gbakc5\",\n            \"t_199\".\"cd_gender_c198\" AS \"d_cd_gender_gbakc6\",\n            \"t_195\".\"s_store_name_c193\" AS \"d_store_name_gbakc7\",\n            \"t_191\".\"d_year_c189\" AS \"sold_calendar_year_gbakc8\",\n            \"t_203\".\"c_first_name_c201\" AS \"d_customer_first_n_gbakc1\",\n            \"t_199\".\"cd_gender_c198\" AS \"d_cd_gender_gbakc2\",\n            \"t_195\".\"s_store_name_c193\" AS \"d_store_name_gbakc3\",\n            \"t_191\".\"d_year_c189\" AS \"sold_calendar_year_gbakc4\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t187\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t188\".\"d_date_sk\" AS \"d_date_sk_c190\",\n               \"date_dim_t188\".\"d_year\" AS \"d_year_c189\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t188\"\n            WHERE\n               \"date_dim_t188\".\"d_year\" = 2001\n            GROUP BY\n               1,\n               2\n         ) AS \"t_191\"\n         ON\n            \"store_sales_t187\".\"ss_sold_date_sk\" = \"t_191\".\"d_date_sk_c190\"\n         JOIN\n         (\n            SELECT\n               \"store_t192\".\"s_store_name\" AS \"s_store_name_c193\",\n               \"store_t192\".\"s_store_sk\" AS \"s_store_sk_c194\"\n            FROM\n               \"tpcds\".\"store\" AS \"store_t192\"\n            WHERE\n               \"store_t192\".\"s_store_name\" = CAST('ese' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_195\"\n         ON\n            \"store_sales_t187\".\"ss_store_sk\" = \"t_195\".\"s_store_sk_c194\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t196\".\"cd_demo_sk\" AS \"cd_demo_sk_c197\",\n               \"customer_demograph_t196\".\"cd_gender\" AS \"cd_gender_c198\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t196\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_199\"\n         ON\n            \"store_sales_t187\".\"ss_cdemo_sk\" = \"t_199\".\"cd_demo_sk_c197\"\n         JOIN\n         (\n            SELECT\n               \"customer_t200\".\"c_customer_sk\" AS \"c_customer_sk_c202\",\n               \"customer_t200\".\"c_first_name\" AS \"c_first_name_c201\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t200\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_203\"\n         ON\n            \"store_sales_t187\".\"ss_customer_sk\" = \"t_203\".\"c_customer_sk_c202\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8\n   ) AS \"t_205\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8\n) AS \"t_215\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST,\n   4 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q24": {
        "question": "For every store in the city of Midway, what is the store's name and the customer income bands seen during the 2002 sales year?",
        "expected_query": "SELECT\n   \"t_261\".\"d_store_city_gbakc7\" AS \"d_store_city\",\n   \"t_261\".\"d_store_name_gbakc8\" AS \"d_store_name\",\n   \"t_261\".\"income_band_gbakc9\" AS \"Income Band\",\n   \"t_261\".\"sold_calendar_year_gbakc10\" AS \"Sold Calendar Year\"\nFROM\n(\n   SELECT\n      \"t_249\".\"d_store_city_gbakc7\" AS \"d_store_city_gbakc7\",\n      \"t_249\".\"d_store_name_gbakc8\" AS \"d_store_name_gbakc8\",\n      \"t_249\".\"income_band_gbakc9\" AS \"income_band_gbakc9\",\n      \"t_249\".\"sold_calendar_year_gbakc10\" AS \"sold_calendar_year_gbakc10\",\n      \"t_249\".\"d_store_city_gbakc1\" AS \"d_store_city_gbakc1\",\n      \"t_249\".\"d_store_city_gbakc2\" AS \"d_store_city_gbakc2\",\n      \"t_249\".\"d_store_city_gbakc3\" AS \"d_store_city_gbakc3\",\n      \"t_249\".\"d_store_name_gbakc4\" AS \"d_store_name_gbakc4\",\n      \"t_249\".\"income_band_gbakc5\" AS \"income_band_gbakc5\",\n      \"t_249\".\"sold_calendar_year_gbakc6\" AS \"sold_calendar_year_gbakc6\"\n   FROM\n   (\n         SELECT\n            \"t_209\".\"s_city_c205\" AS \"d_store_city_gbakc7\",\n            \"t_209\".\"s_store_name_c207\" AS \"d_store_name_gbakc8\",\n            \"t_216\".\"ib_income_band_sk_c215\" AS \"income_band_gbakc9\",\n            \"t_201\".\"d_year_c199\" AS \"sold_calendar_year_gbakc10\",\n            \"t_209\".\"s_country_c203\" AS \"d_store_city_gbakc1\",\n            \"t_209\".\"s_state_c204\" AS \"d_store_city_gbakc2\",\n            \"t_209\".\"s_city_c205\" AS \"d_store_city_gbakc3\",\n            \"t_209\".\"s_store_name_c207\" AS \"d_store_name_gbakc4\",\n            \"t_216\".\"ib_income_band_sk_c215\" AS \"income_band_gbakc5\",\n            \"t_201\".\"d_year_c199\" AS \"sold_calendar_year_gbakc6\"\n         FROM\n         (\nSELECT p.*, ss.*  FROM atscale_tutorial_data.tpcds.promotion p INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_promo_sk = p.p_promo_sk\n         ) AS \"t_197\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t198\".\"d_date_sk\" AS \"d_date_sk_c200\",\n               \"date_dim_t198\".\"d_year\" AS \"d_year_c199\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t198\"\n            WHERE\n               \"date_dim_t198\".\"d_year\" = 2002\n            GROUP BY\n               1,\n               2\n         ) AS \"t_201\"\n         ON\n            \"t_197\".\"ss_sold_date_sk\" = \"t_201\".\"d_date_sk_c200\"\n         JOIN\n         (\n            SELECT\n               \"store_t202\".\"s_city\" AS \"s_city_c205\",\n               \"store_t202\".\"s_city\" AS \"s_city_c206\",\n               \"store_t202\".\"s_country\" AS \"s_country_c203\",\n               \"store_t202\".\"s_state\" AS \"s_state_c204\",\n               \"store_t202\".\"s_store_name\" AS \"s_store_name_c207\",\n               \"store_t202\".\"s_store_sk\" AS \"s_store_sk_c208\"\n            FROM\n               \"tpcds\".\"store\" AS \"store_t202\"\n            WHERE\n               \"store_t202\".\"s_city\" = CAST('Midway' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5,\n               6\n         ) AS \"t_209\"\n         ON\n            \"t_197\".\"ss_store_sk\" = \"t_209\".\"s_store_sk_c208\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t210\".\"hd_demo_sk\" AS \"hd_demo_sk_c211\",\n               \"household_demograp_t210\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c212\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t210\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_213\"\n         ON\n            \"t_197\".\"ss_hdemo_sk\" = \"t_213\".\"hd_demo_sk_c211\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t214\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c215\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t214\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_216\"\n         ON\n            \"t_213\".\"hd_income_band_sk_c212\" = \"t_216\".\"ib_income_band_sk_c215\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_240\".\"s_city_c236\" AS \"d_store_city_gbakc7\",\n            \"t_240\".\"s_store_name_c238\" AS \"d_store_name_gbakc8\",\n            \"t_247\".\"ib_income_band_sk_c246\" AS \"income_band_gbakc9\",\n            \"t_232\".\"d_year_c230\" AS \"sold_calendar_year_gbakc10\",\n            \"t_240\".\"s_country_c234\" AS \"d_store_city_gbakc1\",\n            \"t_240\".\"s_state_c235\" AS \"d_store_city_gbakc2\",\n            \"t_240\".\"s_city_c236\" AS \"d_store_city_gbakc3\",\n            \"t_240\".\"s_store_name_c238\" AS \"d_store_name_gbakc4\",\n            \"t_247\".\"ib_income_band_sk_c246\" AS \"income_band_gbakc5\",\n            \"t_232\".\"d_year_c230\" AS \"sold_calendar_year_gbakc6\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t228\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t229\".\"d_date_sk\" AS \"d_date_sk_c231\",\n               \"date_dim_t229\".\"d_year\" AS \"d_year_c230\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t229\"\n            WHERE\n               \"date_dim_t229\".\"d_year\" = 2002\n            GROUP BY\n               1,\n               2\n         ) AS \"t_232\"\n         ON\n            \"store_sales_t228\".\"ss_sold_date_sk\" = \"t_232\".\"d_date_sk_c231\"\n         JOIN\n         (\n            SELECT\n               \"store_t233\".\"s_city\" AS \"s_city_c236\",\n               \"store_t233\".\"s_city\" AS \"s_city_c237\",\n               \"store_t233\".\"s_country\" AS \"s_country_c234\",\n               \"store_t233\".\"s_state\" AS \"s_state_c235\",\n               \"store_t233\".\"s_store_name\" AS \"s_store_name_c238\",\n               \"store_t233\".\"s_store_sk\" AS \"s_store_sk_c239\"\n            FROM\n               \"tpcds\".\"store\" AS \"store_t233\"\n            WHERE\n               \"store_t233\".\"s_city\" = CAST('Midway' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5,\n               6\n         ) AS \"t_240\"\n         ON\n            \"store_sales_t228\".\"ss_store_sk\" = \"t_240\".\"s_store_sk_c239\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t241\".\"hd_demo_sk\" AS \"hd_demo_sk_c242\",\n               \"household_demograp_t241\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c243\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t241\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_244\"\n         ON\n            \"store_sales_t228\".\"ss_hdemo_sk\" = \"t_244\".\"hd_demo_sk_c242\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t245\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c246\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t245\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_247\"\n         ON\n            \"t_244\".\"hd_income_band_sk_c243\" = \"t_247\".\"ib_income_band_sk_c246\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n   ) AS \"t_249\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8,\n      9,\n      10\n) AS \"t_261\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST,\n   4 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q25": {
        "question": "What is the first name, income band, vehicle count, and buy potential for each customer that lives in the state of New Jersey?",
        "expected_query": "SELECT\n   \"t_496\".\"d_customer_first_n_gbakc6\" AS \"d_customer_first_name\",\n   \"t_496\".\"income_band_gbakc7\" AS \"Income Band\",\n   \"t_496\".\"d_hd_vehicle_count_gbakc8\" AS \"d_hd_vehicle_count\",\n   \"t_496\".\"d_hd_buy_potential_gbakc9\" AS \"d_hd_buy_potential\",\n   \"t_496\".\"d_customer_state_n_gbakc10\" AS \"d_Customer State Name\"\nFROM\n(\n   SELECT\n      \"t_484\".\"d_customer_first_n_gbakc6\" AS \"d_customer_first_n_gbakc6\",\n      \"t_484\".\"income_band_gbakc7\" AS \"income_band_gbakc7\",\n      \"t_484\".\"d_hd_vehicle_count_gbakc8\" AS \"d_hd_vehicle_count_gbakc8\",\n      \"t_484\".\"d_hd_buy_potential_gbakc9\" AS \"d_hd_buy_potential_gbakc9\",\n      \"t_484\".\"d_customer_state_n_gbakc10\" AS \"d_customer_state_n_gbakc10\",\n      \"t_484\".\"d_customer_first_n_gbakc1\" AS \"d_customer_first_n_gbakc1\",\n      \"t_484\".\"income_band_gbakc2\" AS \"income_band_gbakc2\",\n      \"t_484\".\"d_hd_vehicle_count_gbakc3\" AS \"d_hd_vehicle_count_gbakc3\",\n      \"t_484\".\"d_hd_buy_potential_gbakc4\" AS \"d_hd_buy_potential_gbakc4\",\n      \"t_484\".\"d_customer_state_n_gbakc5\" AS \"d_customer_state_n_gbakc5\"\n   FROM\n   (\n         SELECT\n            \"t_353\".\"c_first_name_c350\" AS \"d_customer_first_n_gbakc6\",\n            \"t_348\".\"ib_income_band_sk_c347\" AS \"income_band_gbakc7\",\n            \"t_345\".\"hd_vehicle_count_c344\" AS \"d_hd_vehicle_count_gbakc8\",\n            \"t_345\".\"hd_buy_potential_c341\" AS \"d_hd_buy_potential_gbakc9\",\n            \"t_358\".\"c_355\" AS \"d_customer_state_n_gbakc10\",\n            \"t_353\".\"c_first_name_c350\" AS \"d_customer_first_n_gbakc1\",\n            \"t_348\".\"ib_income_band_sk_c347\" AS \"income_band_gbakc2\",\n            \"t_345\".\"hd_vehicle_count_c344\" AS \"d_hd_vehicle_count_gbakc3\",\n            \"t_345\".\"hd_buy_potential_c341\" AS \"d_hd_buy_potential_gbakc4\",\n            \"t_358\".\"c_355\" AS \"d_customer_state_n_gbakc5\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t339\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t340\".\"hd_buy_potential\" AS \"hd_buy_potential_c341\",\n               \"household_demograp_t340\".\"hd_demo_sk\" AS \"hd_demo_sk_c342\",\n               \"household_demograp_t340\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c343\",\n               \"household_demograp_t340\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c344\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t340\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_345\"\n         ON\n            \"store_sales_t339\".\"ss_hdemo_sk\" = \"t_345\".\"hd_demo_sk_c342\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t346\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c347\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t346\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_348\"\n         ON\n            \"t_345\".\"hd_income_band_sk_c343\" = \"t_348\".\"ib_income_band_sk_c347\"\n         JOIN\n         (\n            SELECT\n               \"customer_t349\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c352\",\n               \"customer_t349\".\"c_customer_sk\" AS \"c_customer_sk_c351\",\n               \"customer_t349\".\"c_first_name\" AS \"c_first_name_c350\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t349\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_353\"\n         ON\n            \"store_sales_t339\".\"ss_customer_sk\" = \"t_353\".\"c_customer_sk_c351\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t354\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t354\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t354\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t354\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t354\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t354\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t354\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t354\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t354\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t354\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t354\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t354\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t354\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t354\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t354\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t354\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t354\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t354\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t354\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t354\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t354\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t354\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t354\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t354\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t354\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t354\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t354\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t354\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t354\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t354\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t354\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t354\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t354\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t354\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t354\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t354\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t354\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t354\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t354\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t354\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t354\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t354\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t354\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t354\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t354\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t354\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t354\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t354\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t354\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t354\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t354\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_355\",\n               \"customer_address_t354\".\"ca_address_sk\" AS \"ca_address_sk_c356\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t354\"\n            WHERE\n               CASE\n    WHEN \"customer_address_t354\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t354\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t354\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t354\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t354\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t354\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t354\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t354\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t354\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t354\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t354\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t354\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t354\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t354\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t354\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t354\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t354\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t354\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t354\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t354\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t354\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t354\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t354\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t354\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t354\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t354\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t354\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t354\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t354\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t354\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t354\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t354\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t354\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t354\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t354\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t354\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t354\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t354\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t354\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t354\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t354\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t354\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t354\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t354\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t354\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t354\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t354\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t354\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t354\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t354\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t354\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('New Jersey' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_358\"\n         ON\n            \"t_353\".\"c_current_addr_sk_c352\" = \"t_358\".\"ca_address_sk_c356\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_384\".\"c_first_name_c381\" AS \"d_customer_first_n_gbakc6\",\n            \"t_379\".\"ib_income_band_sk_c378\" AS \"income_band_gbakc7\",\n            \"t_376\".\"hd_vehicle_count_c375\" AS \"d_hd_vehicle_count_gbakc8\",\n            \"t_376\".\"hd_buy_potential_c372\" AS \"d_hd_buy_potential_gbakc9\",\n            \"t_389\".\"c_386\" AS \"d_customer_state_n_gbakc10\",\n            \"t_384\".\"c_first_name_c381\" AS \"d_customer_first_n_gbakc1\",\n            \"t_379\".\"ib_income_band_sk_c378\" AS \"income_band_gbakc2\",\n            \"t_376\".\"hd_vehicle_count_c375\" AS \"d_hd_vehicle_count_gbakc3\",\n            \"t_376\".\"hd_buy_potential_c372\" AS \"d_hd_buy_potential_gbakc4\",\n            \"t_389\".\"c_386\" AS \"d_customer_state_n_gbakc5\"\n         FROM\n         (\nSELECT ss.*, sr.*, case when (sr_returned_date_sk - ss_sold_date_sk <= 30) then '<= 30 days' when (sr_returned_date_sk - ss_sold_date_sk > 30) and   (sr_returned_date_sk - ss_sold_date_sk <= 60) then '31-60 days' when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then '61-90 days' when (sr_returned_date_sk - ss_sold_date_sk > 90) and  (sr_returned_date_sk - ss_sold_date_sk <= 120) then '91-120 days' else '> 120 days' end as returns_time_tier, 1 as returns_count  FROM atscale_tutorial_data.tpcds.store_returns sr INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk\n         ) AS \"t_370\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t371\".\"hd_buy_potential\" AS \"hd_buy_potential_c372\",\n               \"household_demograp_t371\".\"hd_demo_sk\" AS \"hd_demo_sk_c373\",\n               \"household_demograp_t371\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c374\",\n               \"household_demograp_t371\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c375\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t371\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_376\"\n         ON\n            \"t_370\".\"sr_hdemo_sk\" = \"t_376\".\"hd_demo_sk_c373\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t377\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c378\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t377\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_379\"\n         ON\n            \"t_376\".\"hd_income_band_sk_c374\" = \"t_379\".\"ib_income_band_sk_c378\"\n         JOIN\n         (\n            SELECT\n               \"customer_t380\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c383\",\n               \"customer_t380\".\"c_customer_sk\" AS \"c_customer_sk_c382\",\n               \"customer_t380\".\"c_first_name\" AS \"c_first_name_c381\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t380\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_384\"\n         ON\n            \"t_370\".\"sr_customer_sk\" = \"t_384\".\"c_customer_sk_c382\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t385\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t385\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t385\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t385\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t385\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t385\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t385\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t385\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t385\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t385\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t385\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t385\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t385\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t385\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t385\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t385\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t385\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t385\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t385\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t385\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t385\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t385\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t385\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t385\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t385\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t385\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t385\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t385\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t385\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t385\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t385\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t385\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t385\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t385\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t385\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t385\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t385\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t385\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t385\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t385\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t385\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t385\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t385\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t385\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t385\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t385\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t385\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t385\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t385\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t385\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t385\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_386\",\n               \"customer_address_t385\".\"ca_address_sk\" AS \"ca_address_sk_c387\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t385\"\n            WHERE\n               CASE\n    WHEN \"customer_address_t385\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t385\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t385\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t385\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t385\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t385\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t385\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t385\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t385\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t385\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t385\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t385\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t385\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t385\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t385\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t385\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t385\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t385\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t385\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t385\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t385\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t385\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t385\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t385\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t385\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t385\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t385\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t385\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t385\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t385\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t385\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t385\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t385\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t385\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t385\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t385\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t385\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t385\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t385\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t385\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t385\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t385\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t385\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t385\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t385\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t385\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t385\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t385\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t385\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t385\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t385\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('New Jersey' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_389\"\n         ON\n            \"t_384\".\"c_current_addr_sk_c383\" = \"t_389\".\"ca_address_sk_c387\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_415\".\"c_first_name_c412\" AS \"d_customer_first_n_gbakc6\",\n            \"t_410\".\"ib_income_band_sk_c409\" AS \"income_band_gbakc7\",\n            \"t_407\".\"hd_vehicle_count_c406\" AS \"d_hd_vehicle_count_gbakc8\",\n            \"t_407\".\"hd_buy_potential_c403\" AS \"d_hd_buy_potential_gbakc9\",\n            \"t_420\".\"c_417\" AS \"d_customer_state_n_gbakc10\",\n            \"t_415\".\"c_first_name_c412\" AS \"d_customer_first_n_gbakc1\",\n            \"t_410\".\"ib_income_band_sk_c409\" AS \"income_band_gbakc2\",\n            \"t_407\".\"hd_vehicle_count_c406\" AS \"d_hd_vehicle_count_gbakc3\",\n            \"t_407\".\"hd_buy_potential_c403\" AS \"d_hd_buy_potential_gbakc4\",\n            \"t_420\".\"c_417\" AS \"d_customer_state_n_gbakc5\"\n         FROM\n            \"tpcds\".\"web_sales\" AS \"web_sales_t401\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t402\".\"hd_buy_potential\" AS \"hd_buy_potential_c403\",\n               \"household_demograp_t402\".\"hd_demo_sk\" AS \"hd_demo_sk_c404\",\n               \"household_demograp_t402\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c405\",\n               \"household_demograp_t402\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c406\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t402\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_407\"\n         ON\n            \"web_sales_t401\".\"ws_bill_hdemo_sk\" = \"t_407\".\"hd_demo_sk_c404\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t408\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c409\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t408\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_410\"\n         ON\n            \"t_407\".\"hd_income_band_sk_c405\" = \"t_410\".\"ib_income_band_sk_c409\"\n         JOIN\n         (\n            SELECT\n               \"customer_t411\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c414\",\n               \"customer_t411\".\"c_customer_sk\" AS \"c_customer_sk_c413\",\n               \"customer_t411\".\"c_first_name\" AS \"c_first_name_c412\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t411\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_415\"\n         ON\n            \"web_sales_t401\".\"ws_bill_customer_sk\" = \"t_415\".\"c_customer_sk_c413\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t416\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t416\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t416\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t416\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t416\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t416\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t416\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t416\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t416\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t416\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t416\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t416\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t416\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t416\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t416\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t416\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t416\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t416\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t416\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t416\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t416\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t416\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t416\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t416\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t416\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t416\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t416\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t416\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t416\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t416\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t416\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t416\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t416\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t416\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t416\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t416\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t416\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t416\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t416\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t416\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t416\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t416\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t416\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t416\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t416\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t416\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t416\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t416\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t416\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t416\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t416\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_417\",\n               \"customer_address_t416\".\"ca_address_sk\" AS \"ca_address_sk_c418\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t416\"\n            WHERE\n               CASE\n    WHEN \"customer_address_t416\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t416\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t416\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t416\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t416\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t416\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t416\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t416\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t416\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t416\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t416\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t416\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t416\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t416\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t416\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t416\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t416\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t416\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t416\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t416\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t416\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t416\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t416\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t416\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t416\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t416\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t416\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t416\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t416\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t416\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t416\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t416\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t416\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t416\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t416\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t416\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t416\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t416\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t416\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t416\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t416\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t416\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t416\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t416\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t416\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t416\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t416\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t416\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t416\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t416\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t416\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('New Jersey' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_420\"\n         ON\n            \"t_415\".\"c_current_addr_sk_c414\" = \"t_420\".\"ca_address_sk_c418\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_446\".\"c_first_name_c443\" AS \"d_customer_first_n_gbakc6\",\n            \"t_441\".\"ib_income_band_sk_c440\" AS \"income_band_gbakc7\",\n            \"t_438\".\"hd_vehicle_count_c437\" AS \"d_hd_vehicle_count_gbakc8\",\n            \"t_438\".\"hd_buy_potential_c434\" AS \"d_hd_buy_potential_gbakc9\",\n            \"t_451\".\"c_448\" AS \"d_customer_state_n_gbakc10\",\n            \"t_446\".\"c_first_name_c443\" AS \"d_customer_first_n_gbakc1\",\n            \"t_441\".\"ib_income_band_sk_c440\" AS \"income_band_gbakc2\",\n            \"t_438\".\"hd_vehicle_count_c437\" AS \"d_hd_vehicle_count_gbakc3\",\n            \"t_438\".\"hd_buy_potential_c434\" AS \"d_hd_buy_potential_gbakc4\",\n            \"t_451\".\"c_448\" AS \"d_customer_state_n_gbakc5\"\n         FROM\n         (\nSELECT p.*, ss.*  FROM atscale_tutorial_data.tpcds.promotion p INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_promo_sk = p.p_promo_sk\n         ) AS \"t_432\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t433\".\"hd_buy_potential\" AS \"hd_buy_potential_c434\",\n               \"household_demograp_t433\".\"hd_demo_sk\" AS \"hd_demo_sk_c435\",\n               \"household_demograp_t433\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c436\",\n               \"household_demograp_t433\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c437\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t433\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_438\"\n         ON\n            \"t_432\".\"ss_hdemo_sk\" = \"t_438\".\"hd_demo_sk_c435\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t439\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c440\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t439\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_441\"\n         ON\n            \"t_438\".\"hd_income_band_sk_c436\" = \"t_441\".\"ib_income_band_sk_c440\"\n         JOIN\n         (\n            SELECT\n               \"customer_t442\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c445\",\n               \"customer_t442\".\"c_customer_sk\" AS \"c_customer_sk_c444\",\n               \"customer_t442\".\"c_first_name\" AS \"c_first_name_c443\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t442\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_446\"\n         ON\n            \"t_432\".\"ss_customer_sk\" = \"t_446\".\"c_customer_sk_c444\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t447\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t447\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t447\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t447\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t447\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t447\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t447\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t447\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t447\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t447\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t447\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t447\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t447\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t447\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t447\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t447\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t447\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t447\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t447\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t447\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t447\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t447\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t447\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t447\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t447\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t447\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t447\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t447\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t447\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t447\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t447\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t447\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t447\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t447\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t447\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t447\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t447\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t447\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t447\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t447\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t447\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t447\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t447\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t447\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t447\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t447\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t447\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t447\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t447\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t447\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t447\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_448\",\n               \"customer_address_t447\".\"ca_address_sk\" AS \"ca_address_sk_c449\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t447\"\n            WHERE\n               CASE\n    WHEN \"customer_address_t447\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t447\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t447\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t447\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t447\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t447\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t447\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t447\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t447\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t447\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t447\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t447\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t447\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t447\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t447\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t447\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t447\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t447\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t447\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t447\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t447\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t447\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t447\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t447\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t447\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t447\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t447\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t447\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t447\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t447\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t447\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t447\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t447\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t447\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t447\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t447\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t447\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t447\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t447\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t447\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t447\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t447\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t447\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t447\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t447\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t447\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t447\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t447\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t447\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t447\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t447\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('New Jersey' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_451\"\n         ON\n            \"t_446\".\"c_current_addr_sk_c445\" = \"t_451\".\"ca_address_sk_c449\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_477\".\"c_first_name_c474\" AS \"d_customer_first_n_gbakc6\",\n            \"t_472\".\"ib_income_band_sk_c471\" AS \"income_band_gbakc7\",\n            \"t_469\".\"hd_vehicle_count_c468\" AS \"d_hd_vehicle_count_gbakc8\",\n            \"t_469\".\"hd_buy_potential_c465\" AS \"d_hd_buy_potential_gbakc9\",\n            \"t_482\".\"c_479\" AS \"d_customer_state_n_gbakc10\",\n            \"t_477\".\"c_first_name_c474\" AS \"d_customer_first_n_gbakc1\",\n            \"t_472\".\"ib_income_band_sk_c471\" AS \"income_band_gbakc2\",\n            \"t_469\".\"hd_vehicle_count_c468\" AS \"d_hd_vehicle_count_gbakc3\",\n            \"t_469\".\"hd_buy_potential_c465\" AS \"d_hd_buy_potential_gbakc4\",\n            \"t_482\".\"c_479\" AS \"d_customer_state_n_gbakc5\"\n         FROM\n            \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t463\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t464\".\"hd_buy_potential\" AS \"hd_buy_potential_c465\",\n               \"household_demograp_t464\".\"hd_demo_sk\" AS \"hd_demo_sk_c466\",\n               \"household_demograp_t464\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c467\",\n               \"household_demograp_t464\".\"hd_vehicle_count\" AS \"hd_vehicle_count_c468\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t464\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_469\"\n         ON\n            \"catalog_sales_t463\".\"cs_ship_customer_sk\" = \"t_469\".\"hd_demo_sk_c466\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t470\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c471\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t470\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_472\"\n         ON\n            \"t_469\".\"hd_income_band_sk_c467\" = \"t_472\".\"ib_income_band_sk_c471\"\n         JOIN\n         (\n            SELECT\n               \"customer_t473\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c476\",\n               \"customer_t473\".\"c_customer_sk\" AS \"c_customer_sk_c475\",\n               \"customer_t473\".\"c_first_name\" AS \"c_first_name_c474\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t473\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_477\"\n         ON\n            \"catalog_sales_t463\".\"cs_bill_customer_sk\" = \"t_477\".\"c_customer_sk_c475\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t478\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t478\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t478\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t478\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t478\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t478\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t478\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t478\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t478\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t478\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t478\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t478\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t478\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t478\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t478\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t478\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t478\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t478\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t478\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t478\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t478\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t478\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t478\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t478\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t478\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t478\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t478\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t478\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t478\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t478\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t478\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t478\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t478\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t478\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t478\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t478\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t478\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t478\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t478\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t478\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t478\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t478\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t478\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t478\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t478\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t478\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t478\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t478\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t478\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t478\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t478\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_479\",\n               \"customer_address_t478\".\"ca_address_sk\" AS \"ca_address_sk_c480\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t478\"\n            WHERE\n               CASE\n    WHEN \"customer_address_t478\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t478\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t478\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t478\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t478\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t478\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t478\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t478\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t478\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t478\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t478\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t478\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t478\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t478\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t478\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t478\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t478\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t478\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t478\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t478\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t478\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t478\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t478\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t478\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t478\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t478\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t478\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t478\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t478\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t478\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t478\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t478\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t478\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t478\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t478\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t478\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t478\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t478\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t478\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t478\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t478\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t478\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t478\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t478\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t478\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t478\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t478\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t478\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t478\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t478\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t478\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('New Jersey' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_482\"\n         ON\n            \"t_477\".\"c_current_addr_sk_c476\" = \"t_482\".\"ca_address_sk_c480\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n   ) AS \"t_484\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8,\n      9,\n      10\n) AS \"t_496\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST,\n   4 ASC NULLS FIRST,\n   5 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q26": {
        "question": "What is the first name, gender, income band, and home state name for each customer that was born in the country of CYPRUS",
        "expected_query": "SELECT\n   \"t_511\".\"d_customer_first_n_gbakc6\" AS \"d_customer_first_name\",\n   \"t_511\".\"d_cd_gender_gbakc7\" AS \"d_cd_gender\",\n   \"t_511\".\"income_band_gbakc8\" AS \"Income Band\",\n   \"t_511\".\"d_customer_state_n_gbakc9\" AS \"d_Customer State Name\",\n   \"t_511\".\"d_birth_country_gbakc10\" AS \"d_birth_country\"\nFROM\n(\n   SELECT\n      \"t_499\".\"d_customer_first_n_gbakc6\" AS \"d_customer_first_n_gbakc6\",\n      \"t_499\".\"d_cd_gender_gbakc7\" AS \"d_cd_gender_gbakc7\",\n      \"t_499\".\"income_band_gbakc8\" AS \"income_band_gbakc8\",\n      \"t_499\".\"d_customer_state_n_gbakc9\" AS \"d_customer_state_n_gbakc9\",\n      \"t_499\".\"d_birth_country_gbakc10\" AS \"d_birth_country_gbakc10\",\n      \"t_499\".\"d_customer_first_n_gbakc1\" AS \"d_customer_first_n_gbakc1\",\n      \"t_499\".\"d_cd_gender_gbakc2\" AS \"d_cd_gender_gbakc2\",\n      \"t_499\".\"income_band_gbakc3\" AS \"income_band_gbakc3\",\n      \"t_499\".\"d_customer_state_n_gbakc4\" AS \"d_customer_state_n_gbakc4\",\n      \"t_499\".\"d_birth_country_gbakc5\" AS \"d_birth_country_gbakc5\"\n   FROM\n   (\n         SELECT\n            \"t_356\".\"c_first_name_c353\" AS \"d_customer_first_n_gbakc6\",\n            \"t_347\".\"cd_gender_c346\" AS \"d_cd_gender_gbakc7\",\n            \"t_350\".\"ib_income_band_sk_c349\" AS \"income_band_gbakc8\",\n            \"t_361\".\"c_358\" AS \"d_customer_state_n_gbakc9\",\n            \"t_356\".\"c_birth_country_c352\" AS \"d_birth_country_gbakc10\",\n            \"t_356\".\"c_first_name_c353\" AS \"d_customer_first_n_gbakc1\",\n            \"t_347\".\"cd_gender_c346\" AS \"d_cd_gender_gbakc2\",\n            \"t_350\".\"ib_income_band_sk_c349\" AS \"income_band_gbakc3\",\n            \"t_361\".\"c_358\" AS \"d_customer_state_n_gbakc4\",\n            \"t_356\".\"c_birth_country_c352\" AS \"d_birth_country_gbakc5\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t339\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t340\".\"hd_demo_sk\" AS \"hd_demo_sk_c341\",\n               \"household_demograp_t340\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c342\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t340\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_343\"\n         ON\n            \"store_sales_t339\".\"ss_hdemo_sk\" = \"t_343\".\"hd_demo_sk_c341\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t344\".\"cd_demo_sk\" AS \"cd_demo_sk_c345\",\n               \"customer_demograph_t344\".\"cd_gender\" AS \"cd_gender_c346\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t344\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_347\"\n         ON\n            \"store_sales_t339\".\"ss_cdemo_sk\" = \"t_347\".\"cd_demo_sk_c345\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t348\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c349\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t348\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_350\"\n         ON\n            \"t_343\".\"hd_income_band_sk_c342\" = \"t_350\".\"ib_income_band_sk_c349\"\n         JOIN\n         (\n            SELECT\n               \"customer_t351\".\"c_birth_country\" AS \"c_birth_country_c352\",\n               \"customer_t351\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c355\",\n               \"customer_t351\".\"c_customer_sk\" AS \"c_customer_sk_c354\",\n               \"customer_t351\".\"c_first_name\" AS \"c_first_name_c353\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t351\"\n            WHERE\n               \"customer_t351\".\"c_birth_country\" = CAST('CYPRUS' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_356\"\n         ON\n            \"store_sales_t339\".\"ss_customer_sk\" = \"t_356\".\"c_customer_sk_c354\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t357\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t357\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t357\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t357\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t357\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t357\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t357\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t357\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t357\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t357\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t357\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t357\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t357\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t357\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t357\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t357\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t357\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t357\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t357\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t357\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t357\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t357\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t357\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t357\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t357\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t357\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t357\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t357\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t357\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t357\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t357\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t357\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t357\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t357\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t357\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t357\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t357\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t357\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t357\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t357\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t357\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t357\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t357\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t357\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t357\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t357\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t357\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t357\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t357\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t357\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t357\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_358\",\n               \"customer_address_t357\".\"ca_address_sk\" AS \"ca_address_sk_c359\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t357\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_361\"\n         ON\n            \"t_356\".\"c_current_addr_sk_c355\" = \"t_361\".\"ca_address_sk_c359\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_390\".\"c_first_name_c387\" AS \"d_customer_first_n_gbakc6\",\n            \"t_381\".\"cd_gender_c380\" AS \"d_cd_gender_gbakc7\",\n            \"t_384\".\"ib_income_band_sk_c383\" AS \"income_band_gbakc8\",\n            \"t_395\".\"c_392\" AS \"d_customer_state_n_gbakc9\",\n            \"t_390\".\"c_birth_country_c386\" AS \"d_birth_country_gbakc10\",\n            \"t_390\".\"c_first_name_c387\" AS \"d_customer_first_n_gbakc1\",\n            \"t_381\".\"cd_gender_c380\" AS \"d_cd_gender_gbakc2\",\n            \"t_384\".\"ib_income_band_sk_c383\" AS \"income_band_gbakc3\",\n            \"t_395\".\"c_392\" AS \"d_customer_state_n_gbakc4\",\n            \"t_390\".\"c_birth_country_c386\" AS \"d_birth_country_gbakc5\"\n         FROM\n         (\nSELECT ss.*, sr.*, case when (sr_returned_date_sk - ss_sold_date_sk <= 30) then '<= 30 days' when (sr_returned_date_sk - ss_sold_date_sk > 30) and   (sr_returned_date_sk - ss_sold_date_sk <= 60) then '31-60 days' when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then '61-90 days' when (sr_returned_date_sk - ss_sold_date_sk > 90) and  (sr_returned_date_sk - ss_sold_date_sk <= 120) then '91-120 days' else '> 120 days' end as returns_time_tier, 1 as returns_count  FROM atscale_tutorial_data.tpcds.store_returns sr INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk\n         ) AS \"t_373\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t374\".\"hd_demo_sk\" AS \"hd_demo_sk_c375\",\n               \"household_demograp_t374\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c376\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t374\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_377\"\n         ON\n            \"t_373\".\"sr_hdemo_sk\" = \"t_377\".\"hd_demo_sk_c375\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t378\".\"cd_demo_sk\" AS \"cd_demo_sk_c379\",\n               \"customer_demograph_t378\".\"cd_gender\" AS \"cd_gender_c380\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t378\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_381\"\n         ON\n            \"t_373\".\"sr_cdemo_sk\" = \"t_381\".\"cd_demo_sk_c379\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t382\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c383\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t382\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_384\"\n         ON\n            \"t_377\".\"hd_income_band_sk_c376\" = \"t_384\".\"ib_income_band_sk_c383\"\n         JOIN\n         (\n            SELECT\n               \"customer_t385\".\"c_birth_country\" AS \"c_birth_country_c386\",\n               \"customer_t385\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c389\",\n               \"customer_t385\".\"c_customer_sk\" AS \"c_customer_sk_c388\",\n               \"customer_t385\".\"c_first_name\" AS \"c_first_name_c387\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t385\"\n            WHERE\n               \"customer_t385\".\"c_birth_country\" = CAST('CYPRUS' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_390\"\n         ON\n            \"t_373\".\"sr_customer_sk\" = \"t_390\".\"c_customer_sk_c388\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t391\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t391\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t391\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t391\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t391\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t391\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t391\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t391\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t391\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t391\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t391\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t391\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t391\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t391\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t391\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t391\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t391\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t391\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t391\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t391\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t391\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t391\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t391\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t391\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t391\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t391\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t391\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t391\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t391\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t391\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t391\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t391\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t391\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t391\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t391\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t391\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t391\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t391\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t391\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t391\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t391\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t391\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t391\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t391\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t391\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t391\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t391\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t391\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t391\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t391\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t391\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_392\",\n               \"customer_address_t391\".\"ca_address_sk\" AS \"ca_address_sk_c393\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t391\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_395\"\n         ON\n            \"t_390\".\"c_current_addr_sk_c389\" = \"t_395\".\"ca_address_sk_c393\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_424\".\"c_first_name_c421\" AS \"d_customer_first_n_gbakc6\",\n            \"t_415\".\"cd_gender_c414\" AS \"d_cd_gender_gbakc7\",\n            \"t_418\".\"ib_income_band_sk_c417\" AS \"income_band_gbakc8\",\n            \"t_429\".\"c_426\" AS \"d_customer_state_n_gbakc9\",\n            \"t_424\".\"c_birth_country_c420\" AS \"d_birth_country_gbakc10\",\n            \"t_424\".\"c_first_name_c421\" AS \"d_customer_first_n_gbakc1\",\n            \"t_415\".\"cd_gender_c414\" AS \"d_cd_gender_gbakc2\",\n            \"t_418\".\"ib_income_band_sk_c417\" AS \"income_band_gbakc3\",\n            \"t_429\".\"c_426\" AS \"d_customer_state_n_gbakc4\",\n            \"t_424\".\"c_birth_country_c420\" AS \"d_birth_country_gbakc5\"\n         FROM\n            \"tpcds\".\"web_sales\" AS \"web_sales_t407\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t408\".\"hd_demo_sk\" AS \"hd_demo_sk_c409\",\n               \"household_demograp_t408\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c410\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t408\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_411\"\n         ON\n            \"web_sales_t407\".\"ws_bill_hdemo_sk\" = \"t_411\".\"hd_demo_sk_c409\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t412\".\"cd_demo_sk\" AS \"cd_demo_sk_c413\",\n               \"customer_demograph_t412\".\"cd_gender\" AS \"cd_gender_c414\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t412\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_415\"\n         ON\n            \"web_sales_t407\".\"ws_bill_cdemo_sk\" = \"t_415\".\"cd_demo_sk_c413\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t416\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c417\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t416\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_418\"\n         ON\n            \"t_411\".\"hd_income_band_sk_c410\" = \"t_418\".\"ib_income_band_sk_c417\"\n         JOIN\n         (\n            SELECT\n               \"customer_t419\".\"c_birth_country\" AS \"c_birth_country_c420\",\n               \"customer_t419\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c423\",\n               \"customer_t419\".\"c_customer_sk\" AS \"c_customer_sk_c422\",\n               \"customer_t419\".\"c_first_name\" AS \"c_first_name_c421\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t419\"\n            WHERE\n               \"customer_t419\".\"c_birth_country\" = CAST('CYPRUS' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_424\"\n         ON\n            \"web_sales_t407\".\"ws_bill_customer_sk\" = \"t_424\".\"c_customer_sk_c422\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t425\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t425\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t425\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t425\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t425\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t425\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t425\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t425\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t425\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t425\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t425\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t425\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t425\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t425\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t425\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t425\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t425\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t425\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t425\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t425\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t425\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t425\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t425\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t425\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t425\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t425\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t425\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t425\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t425\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t425\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t425\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t425\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t425\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t425\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t425\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t425\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t425\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t425\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t425\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t425\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t425\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t425\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t425\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t425\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t425\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t425\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t425\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t425\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t425\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t425\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t425\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_426\",\n               \"customer_address_t425\".\"ca_address_sk\" AS \"ca_address_sk_c427\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t425\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_429\"\n         ON\n            \"t_424\".\"c_current_addr_sk_c423\" = \"t_429\".\"ca_address_sk_c427\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_458\".\"c_first_name_c455\" AS \"d_customer_first_n_gbakc6\",\n            \"t_449\".\"cd_gender_c448\" AS \"d_cd_gender_gbakc7\",\n            \"t_452\".\"ib_income_band_sk_c451\" AS \"income_band_gbakc8\",\n            \"t_463\".\"c_460\" AS \"d_customer_state_n_gbakc9\",\n            \"t_458\".\"c_birth_country_c454\" AS \"d_birth_country_gbakc10\",\n            \"t_458\".\"c_first_name_c455\" AS \"d_customer_first_n_gbakc1\",\n            \"t_449\".\"cd_gender_c448\" AS \"d_cd_gender_gbakc2\",\n            \"t_452\".\"ib_income_band_sk_c451\" AS \"income_band_gbakc3\",\n            \"t_463\".\"c_460\" AS \"d_customer_state_n_gbakc4\",\n            \"t_458\".\"c_birth_country_c454\" AS \"d_birth_country_gbakc5\"\n         FROM\n         (\nSELECT p.*, ss.*  FROM atscale_tutorial_data.tpcds.promotion p INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_promo_sk = p.p_promo_sk\n         ) AS \"t_441\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t442\".\"hd_demo_sk\" AS \"hd_demo_sk_c443\",\n               \"household_demograp_t442\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c444\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t442\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_445\"\n         ON\n            \"t_441\".\"ss_hdemo_sk\" = \"t_445\".\"hd_demo_sk_c443\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t446\".\"cd_demo_sk\" AS \"cd_demo_sk_c447\",\n               \"customer_demograph_t446\".\"cd_gender\" AS \"cd_gender_c448\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t446\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_449\"\n         ON\n            \"t_441\".\"ss_cdemo_sk\" = \"t_449\".\"cd_demo_sk_c447\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t450\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c451\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t450\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_452\"\n         ON\n            \"t_445\".\"hd_income_band_sk_c444\" = \"t_452\".\"ib_income_band_sk_c451\"\n         JOIN\n         (\n            SELECT\n               \"customer_t453\".\"c_birth_country\" AS \"c_birth_country_c454\",\n               \"customer_t453\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c457\",\n               \"customer_t453\".\"c_customer_sk\" AS \"c_customer_sk_c456\",\n               \"customer_t453\".\"c_first_name\" AS \"c_first_name_c455\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t453\"\n            WHERE\n               \"customer_t453\".\"c_birth_country\" = CAST('CYPRUS' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_458\"\n         ON\n            \"t_441\".\"ss_customer_sk\" = \"t_458\".\"c_customer_sk_c456\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t459\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t459\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t459\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t459\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t459\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t459\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t459\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t459\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t459\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t459\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t459\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t459\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t459\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t459\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t459\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t459\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t459\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t459\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t459\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t459\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t459\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t459\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t459\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t459\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t459\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t459\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t459\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t459\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t459\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t459\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t459\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t459\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t459\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t459\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t459\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t459\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t459\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t459\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t459\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t459\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t459\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t459\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t459\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t459\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t459\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t459\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t459\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t459\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t459\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t459\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t459\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_460\",\n               \"customer_address_t459\".\"ca_address_sk\" AS \"ca_address_sk_c461\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t459\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_463\"\n         ON\n            \"t_441\".\"ss_addr_sk\" = \"t_463\".\"ca_address_sk_c461\"\n         AND\n            \"t_458\".\"c_current_addr_sk_c457\" = \"t_463\".\"ca_address_sk_c461\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_492\".\"c_first_name_c489\" AS \"d_customer_first_n_gbakc6\",\n            \"t_483\".\"cd_gender_c482\" AS \"d_cd_gender_gbakc7\",\n            \"t_486\".\"ib_income_band_sk_c485\" AS \"income_band_gbakc8\",\n            \"t_497\".\"c_494\" AS \"d_customer_state_n_gbakc9\",\n            \"t_492\".\"c_birth_country_c488\" AS \"d_birth_country_gbakc10\",\n            \"t_492\".\"c_first_name_c489\" AS \"d_customer_first_n_gbakc1\",\n            \"t_483\".\"cd_gender_c482\" AS \"d_cd_gender_gbakc2\",\n            \"t_486\".\"ib_income_band_sk_c485\" AS \"income_band_gbakc3\",\n            \"t_497\".\"c_494\" AS \"d_customer_state_n_gbakc4\",\n            \"t_492\".\"c_birth_country_c488\" AS \"d_birth_country_gbakc5\"\n         FROM\n            \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t475\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t476\".\"hd_demo_sk\" AS \"hd_demo_sk_c477\",\n               \"household_demograp_t476\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c478\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t476\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_479\"\n         ON\n            \"catalog_sales_t475\".\"cs_ship_customer_sk\" = \"t_479\".\"hd_demo_sk_c477\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t480\".\"cd_demo_sk\" AS \"cd_demo_sk_c481\",\n               \"customer_demograph_t480\".\"cd_gender\" AS \"cd_gender_c482\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t480\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_483\"\n         ON\n            \"catalog_sales_t475\".\"cs_bill_cdemo_sk\" = \"t_483\".\"cd_demo_sk_c481\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t484\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c485\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t484\"\n            WHERE\n               true\n            GROUP BY\n               1\n         ) AS \"t_486\"\n         ON\n            \"t_479\".\"hd_income_band_sk_c478\" = \"t_486\".\"ib_income_band_sk_c485\"\n         JOIN\n         (\n            SELECT\n               \"customer_t487\".\"c_birth_country\" AS \"c_birth_country_c488\",\n               \"customer_t487\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c491\",\n               \"customer_t487\".\"c_customer_sk\" AS \"c_customer_sk_c490\",\n               \"customer_t487\".\"c_first_name\" AS \"c_first_name_c489\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t487\"\n            WHERE\n               \"customer_t487\".\"c_birth_country\" = CAST('CYPRUS' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4\n         ) AS \"t_492\"\n         ON\n            \"catalog_sales_t475\".\"cs_bill_customer_sk\" = \"t_492\".\"c_customer_sk_c490\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"customer_address_t493\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t493\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t493\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t493\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t493\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t493\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t493\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t493\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t493\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t493\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t493\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t493\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t493\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t493\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t493\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t493\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t493\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t493\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t493\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t493\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t493\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t493\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t493\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t493\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t493\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t493\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t493\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t493\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t493\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t493\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t493\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t493\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t493\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t493\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t493\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t493\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t493\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t493\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t493\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t493\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t493\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t493\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t493\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t493\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t493\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t493\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t493\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t493\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t493\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t493\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t493\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_494\",\n               \"customer_address_t493\".\"ca_address_sk\" AS \"ca_address_sk_c495\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t493\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_497\"\n         ON\n            \"t_492\".\"c_current_addr_sk_c491\" = \"t_497\".\"ca_address_sk_c495\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n   ) AS \"t_499\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8,\n      9,\n      10\n) AS \"t_511\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST,\n   4 ASC NULLS FIRST,\n   5 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q27": {
        "question": "What shipping types were used by customers with the last name 'Abel' in the year 2002?",
        "expected_query": "SELECT\n   \"t_167\".\"ship_mode_type_gbakc4\" AS \"Ship Mode Type\",\n   \"t_167\".\"d_customer_last_na_gbakc5\" AS \"d_customer_last_name\",\n   \"t_167\".\"ship_calendar_year_gbakc6\" AS \"Ship Calendar Year\"\nFROM\n(\n   SELECT\n      \"t_159\".\"ship_mode_type_gbakc4\" AS \"ship_mode_type_gbakc4\",\n      \"t_159\".\"d_customer_last_na_gbakc5\" AS \"d_customer_last_na_gbakc5\",\n      \"t_159\".\"ship_calendar_year_gbakc6\" AS \"ship_calendar_year_gbakc6\",\n      \"t_159\".\"ship_mode_type_gbakc1\" AS \"ship_mode_type_gbakc1\",\n      \"t_159\".\"d_customer_last_na_gbakc2\" AS \"d_customer_last_na_gbakc2\",\n      \"t_159\".\"ship_calendar_year_gbakc3\" AS \"ship_calendar_year_gbakc3\"\n   FROM\n   (\n         SELECT\n            \"t_133\".\"sm_type_c131\" AS \"ship_mode_type_gbakc4\",\n            \"t_137\".\"c_last_name_c136\" AS \"d_customer_last_na_gbakc5\",\n            \"t_129\".\"d_year_c127\" AS \"ship_calendar_year_gbakc6\",\n            \"t_133\".\"sm_type_c131\" AS \"ship_mode_type_gbakc1\",\n            \"t_137\".\"c_last_name_c136\" AS \"d_customer_last_na_gbakc2\",\n            \"t_129\".\"d_year_c127\" AS \"ship_calendar_year_gbakc3\"\n         FROM\n            \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t125\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t126\".\"d_date_sk\" AS \"d_date_sk_c128\",\n               \"date_dim_t126\".\"d_year\" AS \"d_year_c127\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t126\"\n            WHERE\n               \"date_dim_t126\".\"d_year\" = 2002\n            GROUP BY\n               1,\n               2\n         ) AS \"t_129\"\n         ON\n            \"catalog_sales_t125\".\"cs_ship_date_sk\" = \"t_129\".\"d_date_sk_c128\"\n         JOIN\n         (\n            SELECT\n               \"ship_mode_t130\".\"sm_ship_mode_sk\" AS \"sm_ship_mode_sk_c132\",\n               \"ship_mode_t130\".\"sm_type\" AS \"sm_type_c131\"\n            FROM\n               \"tpcds\".\"ship_mode\" AS \"ship_mode_t130\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_133\"\n         ON\n            \"catalog_sales_t125\".\"cs_ship_mode_sk\" = \"t_133\".\"sm_ship_mode_sk_c132\"\n         JOIN\n         (\n            SELECT\n               \"customer_t134\".\"c_customer_sk\" AS \"c_customer_sk_c135\",\n               \"customer_t134\".\"c_last_name\" AS \"c_last_name_c136\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t134\"\n            WHERE\n               \"customer_t134\".\"c_last_name\" = CAST('Abel' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_137\"\n         ON\n            \"catalog_sales_t125\".\"cs_bill_customer_sk\" = \"t_137\".\"c_customer_sk_c135\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_153\".\"sm_type_c151\" AS \"ship_mode_type_gbakc4\",\n            \"t_157\".\"c_last_name_c156\" AS \"d_customer_last_na_gbakc5\",\n            \"t_149\".\"d_year_c147\" AS \"ship_calendar_year_gbakc6\",\n            \"t_153\".\"sm_type_c151\" AS \"ship_mode_type_gbakc1\",\n            \"t_157\".\"c_last_name_c156\" AS \"d_customer_last_na_gbakc2\",\n            \"t_149\".\"d_year_c147\" AS \"ship_calendar_year_gbakc3\"\n         FROM\n            \"tpcds\".\"web_sales\" AS \"web_sales_t145\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t146\".\"d_date_sk\" AS \"d_date_sk_c148\",\n               \"date_dim_t146\".\"d_year\" AS \"d_year_c147\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t146\"\n            WHERE\n               \"date_dim_t146\".\"d_year\" = 2002\n            GROUP BY\n               1,\n               2\n         ) AS \"t_149\"\n         ON\n            \"web_sales_t145\".\"ws_ship_date_sk\" = \"t_149\".\"d_date_sk_c148\"\n         JOIN\n         (\n            SELECT\n               \"ship_mode_t150\".\"sm_ship_mode_sk\" AS \"sm_ship_mode_sk_c152\",\n               \"ship_mode_t150\".\"sm_type\" AS \"sm_type_c151\"\n            FROM\n               \"tpcds\".\"ship_mode\" AS \"ship_mode_t150\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_153\"\n         ON\n            \"web_sales_t145\".\"ws_ship_mode_sk\" = \"t_153\".\"sm_ship_mode_sk_c152\"\n         JOIN\n         (\n            SELECT\n               \"customer_t154\".\"c_customer_sk\" AS \"c_customer_sk_c155\",\n               \"customer_t154\".\"c_last_name\" AS \"c_last_name_c156\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t154\"\n            WHERE\n               \"customer_t154\".\"c_last_name\" = CAST('Abel' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_157\"\n         ON\n            \"web_sales_t145\".\"ws_bill_customer_sk\" = \"t_157\".\"c_customer_sk_c155\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n   ) AS \"t_159\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6\n) AS \"t_167\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q28": {
        "question": "What is the name and size of each product sold to customers of gender 'F' living in the city of Wright?",
        "expected_query": "SELECT\n   \"t_505\".\"i_product_name_gbakc7\" AS \"i_product_name\",\n   \"t_505\".\"d_i_size_gbakc8\" AS \"d_i_size\",\n   \"t_505\".\"d_cd_gender_gbakc9\" AS \"d_cd_gender\",\n   \"t_505\".\"d_customer_city_gbakc10\" AS \"d_customer_city\"\nFROM\n(\n   SELECT\n      \"t_493\".\"i_product_name_gbakc7\" AS \"i_product_name_gbakc7\",\n      \"t_493\".\"d_i_size_gbakc8\" AS \"d_i_size_gbakc8\",\n      \"t_493\".\"d_cd_gender_gbakc9\" AS \"d_cd_gender_gbakc9\",\n      \"t_493\".\"d_customer_city_gbakc10\" AS \"d_customer_city_gbakc10\",\n      \"t_493\".\"i_product_name_gbakc1\" AS \"i_product_name_gbakc1\",\n      \"t_493\".\"d_i_size_gbakc2\" AS \"d_i_size_gbakc2\",\n      \"t_493\".\"d_cd_gender_gbakc3\" AS \"d_cd_gender_gbakc3\",\n      \"t_493\".\"d_customer_city_gbakc4\" AS \"d_customer_city_gbakc4\",\n      \"t_493\".\"d_customer_city_gbakc5\" AS \"d_customer_city_gbakc5\",\n      \"t_493\".\"d_customer_city_gbakc6\" AS \"d_customer_city_gbakc6\"\n   FROM\n   (\n         SELECT\n            \"t_356\".\"i_product_name_c354\" AS \"i_product_name_gbakc7\",\n            \"t_356\".\"i_size_c353\" AS \"d_i_size_gbakc8\",\n            \"t_351\".\"cd_gender_c350\" AS \"d_cd_gender_gbakc9\",\n            \"t_367\".\"ca_city_c364\" AS \"d_customer_city_gbakc10\",\n            \"t_356\".\"i_product_name_c354\" AS \"i_product_name_gbakc1\",\n            \"t_356\".\"i_size_c353\" AS \"d_i_size_gbakc2\",\n            \"t_351\".\"cd_gender_c350\" AS \"d_cd_gender_gbakc3\",\n            \"t_367\".\"ca_country_c362\" AS \"d_customer_city_gbakc4\",\n            \"t_367\".\"ca_state_c363\" AS \"d_customer_city_gbakc5\",\n            \"t_367\".\"ca_city_c364\" AS \"d_customer_city_gbakc6\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t347\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t348\".\"cd_demo_sk\" AS \"cd_demo_sk_c349\",\n               \"customer_demograph_t348\".\"cd_gender\" AS \"cd_gender_c350\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t348\"\n            WHERE\n               \"customer_demograph_t348\".\"cd_gender\" = CAST('F' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_351\"\n         ON\n            \"store_sales_t347\".\"ss_cdemo_sk\" = \"t_351\".\"cd_demo_sk_c349\"\n         JOIN\n         (\n            SELECT\n               \"item_t352\".\"i_item_sk\" AS \"i_item_sk_c355\",\n               \"item_t352\".\"i_product_name\" AS \"i_product_name_c354\",\n               \"item_t352\".\"i_size\" AS \"i_size_c353\"\n            FROM\n               \"tpcds\".\"item\" AS \"item_t352\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_356\"\n         ON\n            \"store_sales_t347\".\"ss_item_sk\" = \"t_356\".\"i_item_sk_c355\"\n         JOIN\n         (\n            SELECT\n               \"customer_t357\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c359\",\n               \"customer_t357\".\"c_customer_sk\" AS \"c_customer_sk_c358\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t357\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_360\"\n         ON\n            \"store_sales_t347\".\"ss_customer_sk\" = \"t_360\".\"c_customer_sk_c358\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t361\".\"ca_address_sk\" AS \"ca_address_sk_c366\",\n               \"customer_address_t361\".\"ca_city\" AS \"ca_city_c364\",\n               \"customer_address_t361\".\"ca_city\" AS \"ca_city_c365\",\n               \"customer_address_t361\".\"ca_country\" AS \"ca_country_c362\",\n               \"customer_address_t361\".\"ca_state\" AS \"ca_state_c363\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t361\"\n            WHERE\n               \"customer_address_t361\".\"ca_city\" = CAST('Wright' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_367\"\n         ON\n            \"t_360\".\"c_current_addr_sk_c359\" = \"t_367\".\"ca_address_sk_c366\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_388\".\"i_product_name_c386\" AS \"i_product_name_gbakc7\",\n            \"t_388\".\"i_size_c385\" AS \"d_i_size_gbakc8\",\n            \"t_383\".\"cd_gender_c382\" AS \"d_cd_gender_gbakc9\",\n            \"t_399\".\"ca_city_c396\" AS \"d_customer_city_gbakc10\",\n            \"t_388\".\"i_product_name_c386\" AS \"i_product_name_gbakc1\",\n            \"t_388\".\"i_size_c385\" AS \"d_i_size_gbakc2\",\n            \"t_383\".\"cd_gender_c382\" AS \"d_cd_gender_gbakc3\",\n            \"t_399\".\"ca_country_c394\" AS \"d_customer_city_gbakc4\",\n            \"t_399\".\"ca_state_c395\" AS \"d_customer_city_gbakc5\",\n            \"t_399\".\"ca_city_c396\" AS \"d_customer_city_gbakc6\"\n         FROM\n         (\nSELECT ss.*, sr.*, case when (sr_returned_date_sk - ss_sold_date_sk <= 30) then '<= 30 days' when (sr_returned_date_sk - ss_sold_date_sk > 30) and   (sr_returned_date_sk - ss_sold_date_sk <= 60) then '31-60 days' when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then '61-90 days' when (sr_returned_date_sk - ss_sold_date_sk > 90) and  (sr_returned_date_sk - ss_sold_date_sk <= 120) then '91-120 days' else '> 120 days' end as returns_time_tier, 1 as returns_count  FROM atscale_tutorial_data.tpcds.store_returns sr INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk\n         ) AS \"t_379\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t380\".\"cd_demo_sk\" AS \"cd_demo_sk_c381\",\n               \"customer_demograph_t380\".\"cd_gender\" AS \"cd_gender_c382\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t380\"\n            WHERE\n               \"customer_demograph_t380\".\"cd_gender\" = CAST('F' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_383\"\n         ON\n            \"t_379\".\"sr_cdemo_sk\" = \"t_383\".\"cd_demo_sk_c381\"\n         JOIN\n         (\n            SELECT\n               \"item_t384\".\"i_item_sk\" AS \"i_item_sk_c387\",\n               \"item_t384\".\"i_product_name\" AS \"i_product_name_c386\",\n               \"item_t384\".\"i_size\" AS \"i_size_c385\"\n            FROM\n               \"tpcds\".\"item\" AS \"item_t384\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_388\"\n         ON\n            \"t_379\".\"sr_item_sk\" = \"t_388\".\"i_item_sk_c387\"\n         JOIN\n         (\n            SELECT\n               \"customer_t389\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c391\",\n               \"customer_t389\".\"c_customer_sk\" AS \"c_customer_sk_c390\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t389\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_392\"\n         ON\n            \"t_379\".\"sr_customer_sk\" = \"t_392\".\"c_customer_sk_c390\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t393\".\"ca_address_sk\" AS \"ca_address_sk_c398\",\n               \"customer_address_t393\".\"ca_city\" AS \"ca_city_c396\",\n               \"customer_address_t393\".\"ca_city\" AS \"ca_city_c397\",\n               \"customer_address_t393\".\"ca_country\" AS \"ca_country_c394\",\n               \"customer_address_t393\".\"ca_state\" AS \"ca_state_c395\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t393\"\n            WHERE\n               \"customer_address_t393\".\"ca_city\" = CAST('Wright' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_399\"\n         ON\n            \"t_392\".\"c_current_addr_sk_c391\" = \"t_399\".\"ca_address_sk_c398\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_420\".\"i_product_name_c418\" AS \"i_product_name_gbakc7\",\n            \"t_420\".\"i_size_c417\" AS \"d_i_size_gbakc8\",\n            \"t_415\".\"cd_gender_c414\" AS \"d_cd_gender_gbakc9\",\n            \"t_431\".\"ca_city_c428\" AS \"d_customer_city_gbakc10\",\n            \"t_420\".\"i_product_name_c418\" AS \"i_product_name_gbakc1\",\n            \"t_420\".\"i_size_c417\" AS \"d_i_size_gbakc2\",\n            \"t_415\".\"cd_gender_c414\" AS \"d_cd_gender_gbakc3\",\n            \"t_431\".\"ca_country_c426\" AS \"d_customer_city_gbakc4\",\n            \"t_431\".\"ca_state_c427\" AS \"d_customer_city_gbakc5\",\n            \"t_431\".\"ca_city_c428\" AS \"d_customer_city_gbakc6\"\n         FROM\n            \"tpcds\".\"web_sales\" AS \"web_sales_t411\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t412\".\"cd_demo_sk\" AS \"cd_demo_sk_c413\",\n               \"customer_demograph_t412\".\"cd_gender\" AS \"cd_gender_c414\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t412\"\n            WHERE\n               \"customer_demograph_t412\".\"cd_gender\" = CAST('F' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_415\"\n         ON\n            \"web_sales_t411\".\"ws_bill_cdemo_sk\" = \"t_415\".\"cd_demo_sk_c413\"\n         JOIN\n         (\n            SELECT\n               \"item_t416\".\"i_item_sk\" AS \"i_item_sk_c419\",\n               \"item_t416\".\"i_product_name\" AS \"i_product_name_c418\",\n               \"item_t416\".\"i_size\" AS \"i_size_c417\"\n            FROM\n               \"tpcds\".\"item\" AS \"item_t416\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_420\"\n         ON\n            \"web_sales_t411\".\"ws_item_sk\" = \"t_420\".\"i_item_sk_c419\"\n         JOIN\n         (\n            SELECT\n               \"customer_t421\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c423\",\n               \"customer_t421\".\"c_customer_sk\" AS \"c_customer_sk_c422\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t421\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_424\"\n         ON\n            \"web_sales_t411\".\"ws_bill_customer_sk\" = \"t_424\".\"c_customer_sk_c422\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t425\".\"ca_address_sk\" AS \"ca_address_sk_c430\",\n               \"customer_address_t425\".\"ca_city\" AS \"ca_city_c428\",\n               \"customer_address_t425\".\"ca_city\" AS \"ca_city_c429\",\n               \"customer_address_t425\".\"ca_country\" AS \"ca_country_c426\",\n               \"customer_address_t425\".\"ca_state\" AS \"ca_state_c427\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t425\"\n            WHERE\n               \"customer_address_t425\".\"ca_city\" = CAST('Wright' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_431\"\n         ON\n            \"t_424\".\"c_current_addr_sk_c423\" = \"t_431\".\"ca_address_sk_c430\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_452\".\"i_product_name_c450\" AS \"i_product_name_gbakc7\",\n            \"t_452\".\"i_size_c449\" AS \"d_i_size_gbakc8\",\n            \"t_447\".\"cd_gender_c446\" AS \"d_cd_gender_gbakc9\",\n            \"t_459\".\"ca_city_c456\" AS \"d_customer_city_gbakc10\",\n            \"t_452\".\"i_product_name_c450\" AS \"i_product_name_gbakc1\",\n            \"t_452\".\"i_size_c449\" AS \"d_i_size_gbakc2\",\n            \"t_447\".\"cd_gender_c446\" AS \"d_cd_gender_gbakc3\",\n            \"t_459\".\"ca_country_c454\" AS \"d_customer_city_gbakc4\",\n            \"t_459\".\"ca_state_c455\" AS \"d_customer_city_gbakc5\",\n            \"t_459\".\"ca_city_c456\" AS \"d_customer_city_gbakc6\"\n         FROM\n         (\nSELECT p.*, ss.*  FROM atscale_tutorial_data.tpcds.promotion p INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_promo_sk = p.p_promo_sk\n         ) AS \"t_443\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t444\".\"cd_demo_sk\" AS \"cd_demo_sk_c445\",\n               \"customer_demograph_t444\".\"cd_gender\" AS \"cd_gender_c446\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t444\"\n            WHERE\n               \"customer_demograph_t444\".\"cd_gender\" = CAST('F' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_447\"\n         ON\n            \"t_443\".\"ss_cdemo_sk\" = \"t_447\".\"cd_demo_sk_c445\"\n         JOIN\n         (\n            SELECT\n               \"item_t448\".\"i_item_sk\" AS \"i_item_sk_c451\",\n               \"item_t448\".\"i_product_name\" AS \"i_product_name_c450\",\n               \"item_t448\".\"i_size\" AS \"i_size_c449\"\n            FROM\n               \"tpcds\".\"item\" AS \"item_t448\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_452\"\n         ON\n            \"t_443\".\"ss_item_sk\" = \"t_452\".\"i_item_sk_c451\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t453\".\"ca_address_sk\" AS \"ca_address_sk_c458\",\n               \"customer_address_t453\".\"ca_city\" AS \"ca_city_c456\",\n               \"customer_address_t453\".\"ca_city\" AS \"ca_city_c457\",\n               \"customer_address_t453\".\"ca_country\" AS \"ca_country_c454\",\n               \"customer_address_t453\".\"ca_state\" AS \"ca_state_c455\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t453\"\n            WHERE\n               \"customer_address_t453\".\"ca_city\" = CAST('Wright' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_459\"\n         ON\n            \"t_443\".\"ss_addr_sk\" = \"t_459\".\"ca_address_sk_c458\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_480\".\"i_product_name_c478\" AS \"i_product_name_gbakc7\",\n            \"t_480\".\"i_size_c477\" AS \"d_i_size_gbakc8\",\n            \"t_475\".\"cd_gender_c474\" AS \"d_cd_gender_gbakc9\",\n            \"t_491\".\"ca_city_c488\" AS \"d_customer_city_gbakc10\",\n            \"t_480\".\"i_product_name_c478\" AS \"i_product_name_gbakc1\",\n            \"t_480\".\"i_size_c477\" AS \"d_i_size_gbakc2\",\n            \"t_475\".\"cd_gender_c474\" AS \"d_cd_gender_gbakc3\",\n            \"t_491\".\"ca_country_c486\" AS \"d_customer_city_gbakc4\",\n            \"t_491\".\"ca_state_c487\" AS \"d_customer_city_gbakc5\",\n            \"t_491\".\"ca_city_c488\" AS \"d_customer_city_gbakc6\"\n         FROM\n            \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t471\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t472\".\"cd_demo_sk\" AS \"cd_demo_sk_c473\",\n               \"customer_demograph_t472\".\"cd_gender\" AS \"cd_gender_c474\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t472\"\n            WHERE\n               \"customer_demograph_t472\".\"cd_gender\" = CAST('F' AS TEXT)\n            GROUP BY\n               1,\n               2\n         ) AS \"t_475\"\n         ON\n            \"catalog_sales_t471\".\"cs_bill_cdemo_sk\" = \"t_475\".\"cd_demo_sk_c473\"\n         JOIN\n         (\n            SELECT\n               \"item_t476\".\"i_item_sk\" AS \"i_item_sk_c479\",\n               \"item_t476\".\"i_product_name\" AS \"i_product_name_c478\",\n               \"item_t476\".\"i_size\" AS \"i_size_c477\"\n            FROM\n               \"tpcds\".\"item\" AS \"item_t476\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3\n         ) AS \"t_480\"\n         ON\n            \"catalog_sales_t471\".\"cs_item_sk\" = \"t_480\".\"i_item_sk_c479\"\n         JOIN\n         (\n            SELECT\n               \"customer_t481\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c483\",\n               \"customer_t481\".\"c_customer_sk\" AS \"c_customer_sk_c482\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t481\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_484\"\n         ON\n            \"catalog_sales_t471\".\"cs_bill_customer_sk\" = \"t_484\".\"c_customer_sk_c482\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t485\".\"ca_address_sk\" AS \"ca_address_sk_c490\",\n               \"customer_address_t485\".\"ca_city\" AS \"ca_city_c488\",\n               \"customer_address_t485\".\"ca_city\" AS \"ca_city_c489\",\n               \"customer_address_t485\".\"ca_country\" AS \"ca_country_c486\",\n               \"customer_address_t485\".\"ca_state\" AS \"ca_state_c487\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t485\"\n            WHERE\n               \"customer_address_t485\".\"ca_city\" = CAST('Wright' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_491\"\n         ON\n            \"t_484\".\"c_current_addr_sk_c483\" = \"t_491\".\"ca_address_sk_c490\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n   ) AS \"t_493\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8,\n      9,\n      10\n) AS \"t_505\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST,\n   4 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q29": {
        "question": "What cities have customers with more than 5 dependents and are in income band 7?",
        "expected_query": "SELECT\n   \"t_439\".\"d_customer_city_gbakc6\" AS \"d_customer_city\",\n   \"t_439\".\"d_cd_dep_count_gbakc7\" AS \"d_cd_dep_count\",\n   \"t_439\".\"income_band_gbakc8\" AS \"Income Band\"\nFROM\n(\n   SELECT\n      \"t_429\".\"d_customer_city_gbakc6\" AS \"d_customer_city_gbakc6\",\n      \"t_429\".\"d_cd_dep_count_gbakc7\" AS \"d_cd_dep_count_gbakc7\",\n      \"t_429\".\"income_band_gbakc8\" AS \"income_band_gbakc8\",\n      \"t_429\".\"d_customer_city_gbakc1\" AS \"d_customer_city_gbakc1\",\n      \"t_429\".\"d_customer_city_gbakc2\" AS \"d_customer_city_gbakc2\",\n      \"t_429\".\"d_customer_city_gbakc3\" AS \"d_customer_city_gbakc3\",\n      \"t_429\".\"d_cd_dep_count_gbakc4\" AS \"d_cd_dep_count_gbakc4\",\n      \"t_429\".\"income_band_gbakc5\" AS \"income_band_gbakc5\"\n   FROM\n   (\n         SELECT\n            \"t_303\".\"ca_city_c300\" AS \"d_customer_city_gbakc6\",\n            \"t_289\".\"cd_dep_count_c287\" AS \"d_cd_dep_count_gbakc7\",\n            \"t_292\".\"ib_income_band_sk_c291\" AS \"income_band_gbakc8\",\n            \"t_303\".\"ca_country_c298\" AS \"d_customer_city_gbakc1\",\n            \"t_303\".\"ca_state_c299\" AS \"d_customer_city_gbakc2\",\n            \"t_303\".\"ca_city_c300\" AS \"d_customer_city_gbakc3\",\n            \"t_289\".\"cd_dep_count_c287\" AS \"d_cd_dep_count_gbakc4\",\n            \"t_292\".\"ib_income_band_sk_c291\" AS \"income_band_gbakc5\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t281\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t282\".\"hd_demo_sk\" AS \"hd_demo_sk_c283\",\n               \"household_demograp_t282\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c284\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t282\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_285\"\n         ON\n            \"store_sales_t281\".\"ss_hdemo_sk\" = \"t_285\".\"hd_demo_sk_c283\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t286\".\"cd_demo_sk\" AS \"cd_demo_sk_c288\",\n               \"customer_demograph_t286\".\"cd_dep_count\" AS \"cd_dep_count_c287\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t286\"\n            WHERE\n               \"customer_demograph_t286\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_289\"\n         ON\n            \"store_sales_t281\".\"ss_cdemo_sk\" = \"t_289\".\"cd_demo_sk_c288\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t290\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c291\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t290\"\n            WHERE\n               \"income_band_t290\".\"ib_income_band_sk\" = 7\n            GROUP BY\n               1\n         ) AS \"t_292\"\n         ON\n            \"t_285\".\"hd_income_band_sk_c284\" = \"t_292\".\"ib_income_band_sk_c291\"\n         JOIN\n         (\n            SELECT\n               \"customer_t293\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c295\",\n               \"customer_t293\".\"c_customer_sk\" AS \"c_customer_sk_c294\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t293\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_296\"\n         ON\n            \"store_sales_t281\".\"ss_customer_sk\" = \"t_296\".\"c_customer_sk_c294\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t297\".\"ca_address_sk\" AS \"ca_address_sk_c302\",\n               \"customer_address_t297\".\"ca_city\" AS \"ca_city_c300\",\n               \"customer_address_t297\".\"ca_city\" AS \"ca_city_c301\",\n               \"customer_address_t297\".\"ca_country\" AS \"ca_country_c298\",\n               \"customer_address_t297\".\"ca_state\" AS \"ca_state_c299\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t297\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_303\"\n         ON\n            \"t_296\".\"c_current_addr_sk_c295\" = \"t_303\".\"ca_address_sk_c302\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8\n      UNION ALL\n         SELECT\n            \"t_335\".\"ca_city_c332\" AS \"d_customer_city_gbakc6\",\n            \"t_321\".\"cd_dep_count_c319\" AS \"d_cd_dep_count_gbakc7\",\n            \"t_324\".\"ib_income_band_sk_c323\" AS \"income_band_gbakc8\",\n            \"t_335\".\"ca_country_c330\" AS \"d_customer_city_gbakc1\",\n            \"t_335\".\"ca_state_c331\" AS \"d_customer_city_gbakc2\",\n            \"t_335\".\"ca_city_c332\" AS \"d_customer_city_gbakc3\",\n            \"t_321\".\"cd_dep_count_c319\" AS \"d_cd_dep_count_gbakc4\",\n            \"t_324\".\"ib_income_band_sk_c323\" AS \"income_band_gbakc5\"\n         FROM\n         (\nSELECT ss.*, sr.*, case when (sr_returned_date_sk - ss_sold_date_sk <= 30) then '<= 30 days' when (sr_returned_date_sk - ss_sold_date_sk > 30) and   (sr_returned_date_sk - ss_sold_date_sk <= 60) then '31-60 days' when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then '61-90 days' when (sr_returned_date_sk - ss_sold_date_sk > 90) and  (sr_returned_date_sk - ss_sold_date_sk <= 120) then '91-120 days' else '> 120 days' end as returns_time_tier, 1 as returns_count  FROM atscale_tutorial_data.tpcds.store_returns sr INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk\n         ) AS \"t_313\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t314\".\"hd_demo_sk\" AS \"hd_demo_sk_c315\",\n               \"household_demograp_t314\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c316\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t314\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_317\"\n         ON\n            \"t_313\".\"sr_hdemo_sk\" = \"t_317\".\"hd_demo_sk_c315\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t318\".\"cd_demo_sk\" AS \"cd_demo_sk_c320\",\n               \"customer_demograph_t318\".\"cd_dep_count\" AS \"cd_dep_count_c319\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t318\"\n            WHERE\n               \"customer_demograph_t318\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_321\"\n         ON\n            \"t_313\".\"sr_cdemo_sk\" = \"t_321\".\"cd_demo_sk_c320\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t322\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c323\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t322\"\n            WHERE\n               \"income_band_t322\".\"ib_income_band_sk\" = 7\n            GROUP BY\n               1\n         ) AS \"t_324\"\n         ON\n            \"t_317\".\"hd_income_band_sk_c316\" = \"t_324\".\"ib_income_band_sk_c323\"\n         JOIN\n         (\n            SELECT\n               \"customer_t325\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c327\",\n               \"customer_t325\".\"c_customer_sk\" AS \"c_customer_sk_c326\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t325\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_328\"\n         ON\n            \"t_313\".\"sr_customer_sk\" = \"t_328\".\"c_customer_sk_c326\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t329\".\"ca_address_sk\" AS \"ca_address_sk_c334\",\n               \"customer_address_t329\".\"ca_city\" AS \"ca_city_c332\",\n               \"customer_address_t329\".\"ca_city\" AS \"ca_city_c333\",\n               \"customer_address_t329\".\"ca_country\" AS \"ca_country_c330\",\n               \"customer_address_t329\".\"ca_state\" AS \"ca_state_c331\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t329\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_335\"\n         ON\n            \"t_328\".\"c_current_addr_sk_c327\" = \"t_335\".\"ca_address_sk_c334\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8\n      UNION ALL\n         SELECT\n            \"t_367\".\"ca_city_c364\" AS \"d_customer_city_gbakc6\",\n            \"t_353\".\"cd_dep_count_c351\" AS \"d_cd_dep_count_gbakc7\",\n            \"t_356\".\"ib_income_band_sk_c355\" AS \"income_band_gbakc8\",\n            \"t_367\".\"ca_country_c362\" AS \"d_customer_city_gbakc1\",\n            \"t_367\".\"ca_state_c363\" AS \"d_customer_city_gbakc2\",\n            \"t_367\".\"ca_city_c364\" AS \"d_customer_city_gbakc3\",\n            \"t_353\".\"cd_dep_count_c351\" AS \"d_cd_dep_count_gbakc4\",\n            \"t_356\".\"ib_income_band_sk_c355\" AS \"income_band_gbakc5\"\n         FROM\n            \"tpcds\".\"web_sales\" AS \"web_sales_t345\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t346\".\"hd_demo_sk\" AS \"hd_demo_sk_c347\",\n               \"household_demograp_t346\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c348\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t346\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_349\"\n         ON\n            \"web_sales_t345\".\"ws_bill_hdemo_sk\" = \"t_349\".\"hd_demo_sk_c347\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t350\".\"cd_demo_sk\" AS \"cd_demo_sk_c352\",\n               \"customer_demograph_t350\".\"cd_dep_count\" AS \"cd_dep_count_c351\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t350\"\n            WHERE\n               \"customer_demograph_t350\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_353\"\n         ON\n            \"web_sales_t345\".\"ws_bill_cdemo_sk\" = \"t_353\".\"cd_demo_sk_c352\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t354\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c355\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t354\"\n            WHERE\n               \"income_band_t354\".\"ib_income_band_sk\" = 7\n            GROUP BY\n               1\n         ) AS \"t_356\"\n         ON\n            \"t_349\".\"hd_income_band_sk_c348\" = \"t_356\".\"ib_income_band_sk_c355\"\n         JOIN\n         (\n            SELECT\n               \"customer_t357\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c359\",\n               \"customer_t357\".\"c_customer_sk\" AS \"c_customer_sk_c358\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t357\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_360\"\n         ON\n            \"web_sales_t345\".\"ws_bill_customer_sk\" = \"t_360\".\"c_customer_sk_c358\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t361\".\"ca_address_sk\" AS \"ca_address_sk_c366\",\n               \"customer_address_t361\".\"ca_city\" AS \"ca_city_c364\",\n               \"customer_address_t361\".\"ca_city\" AS \"ca_city_c365\",\n               \"customer_address_t361\".\"ca_country\" AS \"ca_country_c362\",\n               \"customer_address_t361\".\"ca_state\" AS \"ca_state_c363\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t361\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_367\"\n         ON\n            \"t_360\".\"c_current_addr_sk_c359\" = \"t_367\".\"ca_address_sk_c366\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8\n      UNION ALL\n         SELECT\n            \"t_395\".\"ca_city_c392\" AS \"d_customer_city_gbakc6\",\n            \"t_385\".\"cd_dep_count_c383\" AS \"d_cd_dep_count_gbakc7\",\n            \"t_388\".\"ib_income_band_sk_c387\" AS \"income_band_gbakc8\",\n            \"t_395\".\"ca_country_c390\" AS \"d_customer_city_gbakc1\",\n            \"t_395\".\"ca_state_c391\" AS \"d_customer_city_gbakc2\",\n            \"t_395\".\"ca_city_c392\" AS \"d_customer_city_gbakc3\",\n            \"t_385\".\"cd_dep_count_c383\" AS \"d_cd_dep_count_gbakc4\",\n            \"t_388\".\"ib_income_band_sk_c387\" AS \"income_band_gbakc5\"\n         FROM\n         (\nSELECT p.*, ss.*  FROM atscale_tutorial_data.tpcds.promotion p INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_promo_sk = p.p_promo_sk\n         ) AS \"t_377\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t378\".\"hd_demo_sk\" AS \"hd_demo_sk_c379\",\n               \"household_demograp_t378\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c380\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t378\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_381\"\n         ON\n            \"t_377\".\"ss_hdemo_sk\" = \"t_381\".\"hd_demo_sk_c379\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t382\".\"cd_demo_sk\" AS \"cd_demo_sk_c384\",\n               \"customer_demograph_t382\".\"cd_dep_count\" AS \"cd_dep_count_c383\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t382\"\n            WHERE\n               \"customer_demograph_t382\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_385\"\n         ON\n            \"t_377\".\"ss_cdemo_sk\" = \"t_385\".\"cd_demo_sk_c384\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t386\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c387\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t386\"\n            WHERE\n               \"income_band_t386\".\"ib_income_band_sk\" = 7\n            GROUP BY\n               1\n         ) AS \"t_388\"\n         ON\n            \"t_381\".\"hd_income_band_sk_c380\" = \"t_388\".\"ib_income_band_sk_c387\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t389\".\"ca_address_sk\" AS \"ca_address_sk_c394\",\n               \"customer_address_t389\".\"ca_city\" AS \"ca_city_c392\",\n               \"customer_address_t389\".\"ca_city\" AS \"ca_city_c393\",\n               \"customer_address_t389\".\"ca_country\" AS \"ca_country_c390\",\n               \"customer_address_t389\".\"ca_state\" AS \"ca_state_c391\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t389\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_395\"\n         ON\n            \"t_377\".\"ss_addr_sk\" = \"t_395\".\"ca_address_sk_c394\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8\n      UNION ALL\n         SELECT\n            \"t_427\".\"ca_city_c424\" AS \"d_customer_city_gbakc6\",\n            \"t_413\".\"cd_dep_count_c411\" AS \"d_cd_dep_count_gbakc7\",\n            \"t_416\".\"ib_income_band_sk_c415\" AS \"income_band_gbakc8\",\n            \"t_427\".\"ca_country_c422\" AS \"d_customer_city_gbakc1\",\n            \"t_427\".\"ca_state_c423\" AS \"d_customer_city_gbakc2\",\n            \"t_427\".\"ca_city_c424\" AS \"d_customer_city_gbakc3\",\n            \"t_413\".\"cd_dep_count_c411\" AS \"d_cd_dep_count_gbakc4\",\n            \"t_416\".\"ib_income_band_sk_c415\" AS \"income_band_gbakc5\"\n         FROM\n            \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t405\"\n         JOIN\n         (\n            SELECT\n               \"household_demograp_t406\".\"hd_demo_sk\" AS \"hd_demo_sk_c407\",\n               \"household_demograp_t406\".\"hd_income_band_sk\" AS \"hd_income_band_sk_c408\"\n            FROM\n               \"tpcds\".\"household_demographics\" AS \"household_demograp_t406\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_409\"\n         ON\n            \"catalog_sales_t405\".\"cs_ship_customer_sk\" = \"t_409\".\"hd_demo_sk_c407\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t410\".\"cd_demo_sk\" AS \"cd_demo_sk_c412\",\n               \"customer_demograph_t410\".\"cd_dep_count\" AS \"cd_dep_count_c411\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t410\"\n            WHERE\n               \"customer_demograph_t410\".\"cd_dep_count\" > 5\n            GROUP BY\n               1,\n               2\n         ) AS \"t_413\"\n         ON\n            \"catalog_sales_t405\".\"cs_bill_cdemo_sk\" = \"t_413\".\"cd_demo_sk_c412\"\n         JOIN\n         (\n            SELECT\n               \"income_band_t414\".\"ib_income_band_sk\" AS \"ib_income_band_sk_c415\"\n            FROM\n               \"tpcds\".\"income_band\" AS \"income_band_t414\"\n            WHERE\n               \"income_band_t414\".\"ib_income_band_sk\" = 7\n            GROUP BY\n               1\n         ) AS \"t_416\"\n         ON\n            \"t_409\".\"hd_income_band_sk_c408\" = \"t_416\".\"ib_income_band_sk_c415\"\n         JOIN\n         (\n            SELECT\n               \"customer_t417\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c419\",\n               \"customer_t417\".\"c_customer_sk\" AS \"c_customer_sk_c418\"\n            FROM\n               \"tpcds\".\"customer\" AS \"customer_t417\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_420\"\n         ON\n            \"catalog_sales_t405\".\"cs_bill_customer_sk\" = \"t_420\".\"c_customer_sk_c418\"\n         JOIN\n         (\n            SELECT\n               \"customer_address_t421\".\"ca_address_sk\" AS \"ca_address_sk_c426\",\n               \"customer_address_t421\".\"ca_city\" AS \"ca_city_c424\",\n               \"customer_address_t421\".\"ca_city\" AS \"ca_city_c425\",\n               \"customer_address_t421\".\"ca_country\" AS \"ca_country_c422\",\n               \"customer_address_t421\".\"ca_state\" AS \"ca_state_c423\"\n            FROM\n               \"tpcds\".\"customer_address\" AS \"customer_address_t421\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_427\"\n         ON\n            \"t_420\".\"c_current_addr_sk_c419\" = \"t_427\".\"ca_address_sk_c426\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6,\n            7,\n            8\n   ) AS \"t_429\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6,\n      7,\n      8\n) AS \"t_439\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q30": {
        "question": "What product names were bought by customers with 4 dependents for the sales year of 2002?",
        "expected_query": "SELECT\n   \"t_267\".\"i_product_name_gbakc4\" AS \"i_product_name\",\n   \"t_267\".\"d_cd_dep_count_gbakc5\" AS \"d_cd_dep_count\",\n   \"t_267\".\"sold_calendar_year_gbakc6\" AS \"Sold Calendar Year\"\nFROM\n(\n   SELECT\n      \"t_259\".\"i_product_name_gbakc4\" AS \"i_product_name_gbakc4\",\n      \"t_259\".\"d_cd_dep_count_gbakc5\" AS \"d_cd_dep_count_gbakc5\",\n      \"t_259\".\"sold_calendar_year_gbakc6\" AS \"sold_calendar_year_gbakc6\",\n      \"t_259\".\"i_product_name_gbakc1\" AS \"i_product_name_gbakc1\",\n      \"t_259\".\"d_cd_dep_count_gbakc2\" AS \"d_cd_dep_count_gbakc2\",\n      \"t_259\".\"sold_calendar_year_gbakc3\" AS \"sold_calendar_year_gbakc3\"\n   FROM\n   (\n         SELECT\n            \"t_197\".\"i_product_name_c195\" AS \"i_product_name_gbakc4\",\n            \"t_193\".\"cd_dep_count_c191\" AS \"d_cd_dep_count_gbakc5\",\n            \"t_189\".\"d_year_c187\" AS \"sold_calendar_year_gbakc6\",\n            \"t_197\".\"i_product_name_c195\" AS \"i_product_name_gbakc1\",\n            \"t_193\".\"cd_dep_count_c191\" AS \"d_cd_dep_count_gbakc2\",\n            \"t_189\".\"d_year_c187\" AS \"sold_calendar_year_gbakc3\"\n         FROM\n            \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t185\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t186\".\"d_date_sk\" AS \"d_date_sk_c188\",\n               \"date_dim_t186\".\"d_year\" AS \"d_year_c187\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t186\"\n            WHERE\n               \"date_dim_t186\".\"d_year\" = 2002\n            GROUP BY\n               1,\n               2\n         ) AS \"t_189\"\n         ON\n            \"catalog_sales_t185\".\"cs_sold_date_sk\" = \"t_189\".\"d_date_sk_c188\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t190\".\"cd_demo_sk\" AS \"cd_demo_sk_c192\",\n               \"customer_demograph_t190\".\"cd_dep_count\" AS \"cd_dep_count_c191\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t190\"\n            WHERE\n               \"customer_demograph_t190\".\"cd_dep_count\" = 4\n            GROUP BY\n               1,\n               2\n         ) AS \"t_193\"\n         ON\n            \"catalog_sales_t185\".\"cs_bill_cdemo_sk\" = \"t_193\".\"cd_demo_sk_c192\"\n         JOIN\n         (\n            SELECT\n               \"item_t194\".\"i_item_sk\" AS \"i_item_sk_c196\",\n               \"item_t194\".\"i_product_name\" AS \"i_product_name_c195\"\n            FROM\n               \"tpcds\".\"item\" AS \"item_t194\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_197\"\n         ON\n            \"catalog_sales_t185\".\"cs_item_sk\" = \"t_197\".\"i_item_sk_c196\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_217\".\"i_product_name_c215\" AS \"i_product_name_gbakc4\",\n            \"t_213\".\"cd_dep_count_c211\" AS \"d_cd_dep_count_gbakc5\",\n            \"t_209\".\"d_year_c207\" AS \"sold_calendar_year_gbakc6\",\n            \"t_217\".\"i_product_name_c215\" AS \"i_product_name_gbakc1\",\n            \"t_213\".\"cd_dep_count_c211\" AS \"d_cd_dep_count_gbakc2\",\n            \"t_209\".\"d_year_c207\" AS \"sold_calendar_year_gbakc3\"\n         FROM\n         (\nSELECT p.*, ss.*  FROM atscale_tutorial_data.tpcds.promotion p INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_promo_sk = p.p_promo_sk\n         ) AS \"t_205\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t206\".\"d_date_sk\" AS \"d_date_sk_c208\",\n               \"date_dim_t206\".\"d_year\" AS \"d_year_c207\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t206\"\n            WHERE\n               \"date_dim_t206\".\"d_year\" = 2002\n            GROUP BY\n               1,\n               2\n         ) AS \"t_209\"\n         ON\n            \"t_205\".\"ss_sold_date_sk\" = \"t_209\".\"d_date_sk_c208\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t210\".\"cd_demo_sk\" AS \"cd_demo_sk_c212\",\n               \"customer_demograph_t210\".\"cd_dep_count\" AS \"cd_dep_count_c211\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t210\"\n            WHERE\n               \"customer_demograph_t210\".\"cd_dep_count\" = 4\n            GROUP BY\n               1,\n               2\n         ) AS \"t_213\"\n         ON\n            \"t_205\".\"ss_cdemo_sk\" = \"t_213\".\"cd_demo_sk_c212\"\n         JOIN\n         (\n            SELECT\n               \"item_t214\".\"i_item_sk\" AS \"i_item_sk_c216\",\n               \"item_t214\".\"i_product_name\" AS \"i_product_name_c215\"\n            FROM\n               \"tpcds\".\"item\" AS \"item_t214\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_217\"\n         ON\n            \"t_205\".\"ss_item_sk\" = \"t_217\".\"i_item_sk_c216\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_237\".\"i_product_name_c235\" AS \"i_product_name_gbakc4\",\n            \"t_233\".\"cd_dep_count_c231\" AS \"d_cd_dep_count_gbakc5\",\n            \"t_229\".\"d_year_c227\" AS \"sold_calendar_year_gbakc6\",\n            \"t_237\".\"i_product_name_c235\" AS \"i_product_name_gbakc1\",\n            \"t_233\".\"cd_dep_count_c231\" AS \"d_cd_dep_count_gbakc2\",\n            \"t_229\".\"d_year_c227\" AS \"sold_calendar_year_gbakc3\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t225\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t226\".\"d_date_sk\" AS \"d_date_sk_c228\",\n               \"date_dim_t226\".\"d_year\" AS \"d_year_c227\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t226\"\n            WHERE\n               \"date_dim_t226\".\"d_year\" = 2002\n            GROUP BY\n               1,\n               2\n         ) AS \"t_229\"\n         ON\n            \"store_sales_t225\".\"ss_sold_date_sk\" = \"t_229\".\"d_date_sk_c228\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t230\".\"cd_demo_sk\" AS \"cd_demo_sk_c232\",\n               \"customer_demograph_t230\".\"cd_dep_count\" AS \"cd_dep_count_c231\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t230\"\n            WHERE\n               \"customer_demograph_t230\".\"cd_dep_count\" = 4\n            GROUP BY\n               1,\n               2\n         ) AS \"t_233\"\n         ON\n            \"store_sales_t225\".\"ss_cdemo_sk\" = \"t_233\".\"cd_demo_sk_c232\"\n         JOIN\n         (\n            SELECT\n               \"item_t234\".\"i_item_sk\" AS \"i_item_sk_c236\",\n               \"item_t234\".\"i_product_name\" AS \"i_product_name_c235\"\n            FROM\n               \"tpcds\".\"item\" AS \"item_t234\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_237\"\n         ON\n            \"store_sales_t225\".\"ss_item_sk\" = \"t_237\".\"i_item_sk_c236\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n      UNION ALL\n         SELECT\n            \"t_257\".\"i_product_name_c255\" AS \"i_product_name_gbakc4\",\n            \"t_253\".\"cd_dep_count_c251\" AS \"d_cd_dep_count_gbakc5\",\n            \"t_249\".\"d_year_c247\" AS \"sold_calendar_year_gbakc6\",\n            \"t_257\".\"i_product_name_c255\" AS \"i_product_name_gbakc1\",\n            \"t_253\".\"cd_dep_count_c251\" AS \"d_cd_dep_count_gbakc2\",\n            \"t_249\".\"d_year_c247\" AS \"sold_calendar_year_gbakc3\"\n         FROM\n            \"tpcds\".\"web_sales\" AS \"web_sales_t245\"\n         JOIN\n         (\n            SELECT\n               \"date_dim_t246\".\"d_date_sk\" AS \"d_date_sk_c248\",\n               \"date_dim_t246\".\"d_year\" AS \"d_year_c247\"\n            FROM\n               \"tpcds\".\"date_dim\" AS \"date_dim_t246\"\n            WHERE\n               \"date_dim_t246\".\"d_year\" = 2002\n            GROUP BY\n               1,\n               2\n         ) AS \"t_249\"\n         ON\n            \"web_sales_t245\".\"ws_sold_date_sk\" = \"t_249\".\"d_date_sk_c248\"\n         JOIN\n         (\n            SELECT\n               \"customer_demograph_t250\".\"cd_demo_sk\" AS \"cd_demo_sk_c252\",\n               \"customer_demograph_t250\".\"cd_dep_count\" AS \"cd_dep_count_c251\"\n            FROM\n               \"tpcds\".\"customer_demographics\" AS \"customer_demograph_t250\"\n            WHERE\n               \"customer_demograph_t250\".\"cd_dep_count\" = 4\n            GROUP BY\n               1,\n               2\n         ) AS \"t_253\"\n         ON\n            \"web_sales_t245\".\"ws_bill_cdemo_sk\" = \"t_253\".\"cd_demo_sk_c252\"\n         JOIN\n         (\n            SELECT\n               \"item_t254\".\"i_item_sk\" AS \"i_item_sk_c256\",\n               \"item_t254\".\"i_product_name\" AS \"i_product_name_c255\"\n            FROM\n               \"tpcds\".\"item\" AS \"item_t254\"\n            WHERE\n               true\n            GROUP BY\n               1,\n               2\n         ) AS \"t_257\"\n         ON\n            \"web_sales_t245\".\"ws_item_sk\" = \"t_257\".\"i_item_sk_c256\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            3,\n            4,\n            5,\n            6\n   ) AS \"t_259\"\n   GROUP BY\n      1,\n      2,\n      3,\n      4,\n      5,\n      6\n) AS \"t_267\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "L",
        "s_complexity": "H"
    },
    "Q31": {
        "question": "What is the count of customers for each state that had more than 500000000 in total catalog and web sales in 2002?",
        "expected_query": "SELECT\n   \"t_283\".\"d_customer_state_n_gbakc3\" AS \"d_Customer State Name\",\n   \"t_283\".\"customer_count_gbakc4\" AS \"Customer Count\",\n   \"t_283\".\"sold_calendar_year_gbakc5\" AS \"Sold Calendar Year\",\n   \"t_283\".\"catalog_and_web_sa_gbakc6\" AS \"Catalog and Web Sales\"\nFROM\n(\n   SELECT\n      \"t_263\".\"d_customer_state_n_gbakc3\" AS \"d_customer_state_n_gbakc3\",\n      MIN(\"t_263\".\"customer_count_gbakc4\") AS \"customer_count_gbakc4\",\n      \"t_263\".\"sold_calendar_year_gbakc5\" AS \"sold_calendar_year_gbakc5\",\n      MIN(\"t_263\".\"catalog_and_web_sa_gbakc6\") AS \"catalog_and_web_sa_gbakc6\",\n      \"t_263\".\"d_customer_state_n_gbakc1\" AS \"d_customer_state_n_gbakc1\",\n      \"t_263\".\"sold_calendar_year_gbakc2\" AS \"sold_calendar_year_gbakc2\"\n   FROM\n   (\n      SELECT\n         \"t_244\".\"d_customer_state_n_gbakc3\" AS \"d_customer_state_n_gbakc3\",\n         CASE WHEN (COALESCE(MIN(\"t_244\".\"c_93\"), MIN(\"t_244\".\"c_94\"), MIN(\"t_244\".\"c_95\")) IS NULL) THEN NULL ELSE ((COALESCE(MIN(\"t_244\".\"c_93\"), CAST(0 AS BIGINT)) + COALESCE(MIN(\"t_244\".\"c_94\"), CAST(0 AS BIGINT))) + COALESCE(MIN(\"t_244\".\"c_95\"), CAST(0 AS BIGINT))) END AS \"customer_count_gbakc4\",\n         \"t_244\".\"sold_calendar_year_gbakc5\" AS \"sold_calendar_year_gbakc5\",\n         CASE WHEN (CAST(COALESCE(MIN(\"t_244\".\"c_87\"), MIN(\"t_244\".\"c_88\")) AS DECIMAL(38,2)) IS NULL) THEN CAST(NULL AS DECIMAL(38,2)) ELSE CAST((CAST(COALESCE(MIN(\"t_244\".\"c_87\"), 0) AS DECIMAL(38,2)) + CAST(COALESCE(MIN(\"t_244\".\"c_88\"), 0) AS DECIMAL(38,2))) AS DECIMAL(38,2)) END AS \"catalog_and_web_sa_gbakc6\",\n         \"t_244\".\"d_customer_state_n_gbakc1\" AS \"d_customer_state_n_gbakc1\",\n         \"t_244\".\"sold_calendar_year_gbakc2\" AS \"sold_calendar_year_gbakc2\",\n         MIN(\"t_244\".\"c_87\") AS \"c_87\",\n         MIN(\"t_244\".\"c_88\") AS \"c_88\"\n      FROM\n      (\n         SELECT\n            \"t_243\".\"d_customer_state_n_gbakc3\" AS \"d_customer_state_n_gbakc3\",\n            MIN(\"t_243\".\"c_93\") AS \"c_93\",\n            MIN(\"t_243\".\"c_94\") AS \"c_94\",\n            MIN(\"t_243\".\"c_95\") AS \"c_95\",\n            \"t_243\".\"sold_calendar_year_gbakc5\" AS \"sold_calendar_year_gbakc5\",\n            MIN(\"t_243\".\"c_100\") AS \"c_100\",\n            MIN(\"t_243\".\"c_101\") AS \"c_101\",\n            \"t_243\".\"d_customer_state_n_gbakc1\" AS \"d_customer_state_n_gbakc1\",\n            \"t_243\".\"sold_calendar_year_gbakc2\" AS \"sold_calendar_year_gbakc2\",\n            MIN(\"t_243\".\"c_87\") AS \"c_87\",\n            MIN(\"t_243\".\"c_88\") AS \"c_88\"\n         FROM\n         (\n               SELECT\n                  \"t_202\".\"c_199\" AS \"d_customer_state_n_gbakc3\",\n                  CAST(NULL AS BIGINT) AS \"c_93\",\n                  COUNT(\"web_sales_t188\".\"ws_bill_customer_sk\") AS \"c_94\",\n                  CAST(NULL AS BIGINT) AS \"c_95\",\n                  \"t_193\".\"d_year_c191\" AS \"sold_calendar_year_gbakc5\",\n                  CAST(NULL AS DECIMAL(38,2)) AS \"c_100\",\n                  CAST(SUM(CAST(\"web_sales_t188\".ws_ext_sales_price*\"web_sales_t188\".ws_quantity AS decimal(38,2))) AS DECIMAL(38,2)) AS \"c_101\",\n                  \"t_202\".\"c_199\" AS \"d_customer_state_n_gbakc1\",\n                  \"t_193\".\"d_year_c191\" AS \"sold_calendar_year_gbakc2\",\n                  CAST(NULL AS DECIMAL(38,2)) AS \"c_87\",\n                  CAST(SUM(CAST(\"web_sales_t188\".ws_ext_sales_price*\"web_sales_t188\".ws_quantity AS decimal(38,2))) AS DECIMAL(38,2)) AS \"c_88\"\n               FROM\n                  \"tpcds\".\"web_sales\" AS \"web_sales_t188\"\n               JOIN\n               (\n                  SELECT\n                     \"date_dim_t190\".\"d_date_sk\" AS \"d_date_sk_c192\",\n                     \"date_dim_t190\".\"d_year\" AS \"d_year_c191\"\n                  FROM\n                     \"tpcds\".\"date_dim\" AS \"date_dim_t190\"\n                  WHERE\n                     \"date_dim_t190\".\"d_year\" = 2002\n                  GROUP BY\n                     1,\n                     2\n               ) AS \"t_193\"\n               ON\n                  \"web_sales_t188\".\"ws_sold_date_sk\" = \"t_193\".\"d_date_sk_c192\"\n               JOIN\n               (\n                  SELECT\n                     \"customer_t194\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c196\",\n                     \"customer_t194\".\"c_customer_sk\" AS \"c_customer_sk_c195\"\n                  FROM\n                     \"tpcds\".\"customer\" AS \"customer_t194\"\n                  WHERE\n                     true\n                  GROUP BY\n                     1,\n                     2\n               ) AS \"t_197\"\n               ON\n                  \"web_sales_t188\".\"ws_bill_customer_sk\" = \"t_197\".\"c_customer_sk_c195\"\n               JOIN\n               (\n                  SELECT\n                     CASE\n    WHEN \"customer_address_t198\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t198\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t198\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t198\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t198\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t198\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t198\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t198\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t198\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t198\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t198\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t198\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t198\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t198\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t198\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t198\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t198\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t198\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t198\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t198\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t198\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t198\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t198\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t198\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t198\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t198\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t198\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t198\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t198\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t198\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t198\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t198\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t198\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t198\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t198\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t198\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t198\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t198\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t198\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t198\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t198\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t198\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t198\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t198\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t198\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t198\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t198\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t198\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t198\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t198\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t198\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_199\",\n                     \"customer_address_t198\".\"ca_address_sk\" AS \"ca_address_sk_c200\"\n                  FROM\n                     \"tpcds\".\"customer_address\" AS \"customer_address_t198\"\n                  WHERE\n                     true\n                  GROUP BY\n                     1,\n                     2\n               ) AS \"t_202\"\n               ON\n                  \"t_197\".\"c_current_addr_sk_c196\" = \"t_202\".\"ca_address_sk_c200\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  5,\n                  8,\n                  9\n            UNION ALL\n               SELECT\n                  \"t_222\".\"c_219\" AS \"d_customer_state_n_gbakc3\",\n                  CAST(NULL AS BIGINT) AS \"c_93\",\n                  CAST(NULL AS BIGINT) AS \"c_94\",\n                  COUNT(\"catalog_sales_t208\".\"cs_bill_customer_sk\") AS \"c_95\",\n                  \"t_213\".\"d_year_c211\" AS \"sold_calendar_year_gbakc5\",\n                  CAST(SUM(CAST(\"catalog_sales_t208\".cs_sales_price-\"catalog_sales_t208\".cs_quantity AS decimal(38,2))) AS DECIMAL(38,2)) AS \"c_100\",\n                  CAST(NULL AS DECIMAL(38,2)) AS \"c_101\",\n                  \"t_222\".\"c_219\" AS \"d_customer_state_n_gbakc1\",\n                  \"t_213\".\"d_year_c211\" AS \"sold_calendar_year_gbakc2\",\n                  CAST(SUM(CAST(\"catalog_sales_t208\".cs_sales_price-\"catalog_sales_t208\".cs_quantity AS decimal(38,2))) AS DECIMAL(38,2)) AS \"c_87\",\n                  CAST(NULL AS DECIMAL(38,2)) AS \"c_88\"\n               FROM\n                  \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t208\"\n               JOIN\n               (\n                  SELECT\n                     \"date_dim_t210\".\"d_date_sk\" AS \"d_date_sk_c212\",\n                     \"date_dim_t210\".\"d_year\" AS \"d_year_c211\"\n                  FROM\n                     \"tpcds\".\"date_dim\" AS \"date_dim_t210\"\n                  WHERE\n                     \"date_dim_t210\".\"d_year\" = 2002\n                  GROUP BY\n                     1,\n                     2\n               ) AS \"t_213\"\n               ON\n                  \"catalog_sales_t208\".\"cs_sold_date_sk\" = \"t_213\".\"d_date_sk_c212\"\n               JOIN\n               (\n                  SELECT\n                     \"customer_t214\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c216\",\n                     \"customer_t214\".\"c_customer_sk\" AS \"c_customer_sk_c215\"\n                  FROM\n                     \"tpcds\".\"customer\" AS \"customer_t214\"\n                  WHERE\n                     true\n                  GROUP BY\n                     1,\n                     2\n               ) AS \"t_217\"\n               ON\n                  \"catalog_sales_t208\".\"cs_bill_customer_sk\" = \"t_217\".\"c_customer_sk_c215\"\n               JOIN\n               (\n                  SELECT\n                     CASE\n    WHEN \"customer_address_t218\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t218\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t218\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t218\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t218\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t218\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t218\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t218\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t218\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t218\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t218\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t218\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t218\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t218\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t218\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t218\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t218\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t218\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t218\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t218\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t218\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t218\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t218\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t218\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t218\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t218\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t218\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t218\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t218\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t218\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t218\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t218\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t218\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t218\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t218\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t218\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t218\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t218\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t218\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t218\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t218\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t218\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t218\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t218\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t218\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t218\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t218\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t218\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t218\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t218\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t218\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_219\",\n                     \"customer_address_t218\".\"ca_address_sk\" AS \"ca_address_sk_c220\"\n                  FROM\n                     \"tpcds\".\"customer_address\" AS \"customer_address_t218\"\n                  WHERE\n                     true\n                  GROUP BY\n                     1,\n                     2\n               ) AS \"t_222\"\n               ON\n                  \"t_217\".\"c_current_addr_sk_c216\" = \"t_222\".\"ca_address_sk_c220\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  5,\n                  8,\n                  9\n            UNION ALL\n               SELECT\n                  \"t_241\".\"c_238\" AS \"d_customer_state_n_gbakc3\",\n                  COUNT(\"store_sales_t228\".\"ss_customer_sk\") AS \"c_93\",\n                  CAST(NULL AS BIGINT) AS \"c_94\",\n                  CAST(NULL AS BIGINT) AS \"c_95\",\n                  \"t_232\".\"d_year_c230\" AS \"sold_calendar_year_gbakc5\",\n                  CAST(NULL AS DECIMAL(38,2)) AS \"c_100\",\n                  CAST(NULL AS DECIMAL(38,2)) AS \"c_101\",\n                  \"t_241\".\"c_238\" AS \"d_customer_state_n_gbakc1\",\n                  \"t_232\".\"d_year_c230\" AS \"sold_calendar_year_gbakc2\",\n                  CAST(NULL AS DECIMAL(38,2)) AS \"c_87\",\n                  CAST(NULL AS DECIMAL(38,2)) AS \"c_88\"\n               FROM\n                  \"tpcds\".\"store_sales\" AS \"store_sales_t228\"\n               JOIN\n               (\n                  SELECT\n                     \"date_dim_t229\".\"d_date_sk\" AS \"d_date_sk_c231\",\n                     \"date_dim_t229\".\"d_year\" AS \"d_year_c230\"\n                  FROM\n                     \"tpcds\".\"date_dim\" AS \"date_dim_t229\"\n                  WHERE\n                     \"date_dim_t229\".\"d_year\" = 2002\n                  GROUP BY\n                     1,\n                     2\n               ) AS \"t_232\"\n               ON\n                  \"store_sales_t228\".\"ss_sold_date_sk\" = \"t_232\".\"d_date_sk_c231\"\n               JOIN\n               (\n                  SELECT\n                     \"customer_t233\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c235\",\n                     \"customer_t233\".\"c_customer_sk\" AS \"c_customer_sk_c234\"\n                  FROM\n                     \"tpcds\".\"customer\" AS \"customer_t233\"\n                  WHERE\n                     true\n                  GROUP BY\n                     1,\n                     2\n               ) AS \"t_236\"\n               ON\n                  \"store_sales_t228\".\"ss_customer_sk\" = \"t_236\".\"c_customer_sk_c234\"\n               JOIN\n               (\n                  SELECT\n                     CASE\n    WHEN \"customer_address_t237\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t237\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t237\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t237\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t237\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t237\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t237\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t237\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t237\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t237\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t237\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t237\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t237\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t237\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t237\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t237\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t237\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t237\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t237\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t237\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t237\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t237\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t237\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t237\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t237\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t237\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t237\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t237\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t237\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t237\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t237\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t237\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t237\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t237\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t237\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t237\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t237\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t237\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t237\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t237\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t237\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t237\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t237\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t237\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t237\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t237\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t237\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t237\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t237\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t237\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t237\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_238\",\n                     \"customer_address_t237\".\"ca_address_sk\" AS \"ca_address_sk_c239\"\n                  FROM\n                     \"tpcds\".\"customer_address\" AS \"customer_address_t237\"\n                  WHERE\n                     true\n                  GROUP BY\n                     1,\n                     2\n               ) AS \"t_241\"\n               ON\n                  \"t_236\".\"c_current_addr_sk_c235\" = \"t_241\".\"ca_address_sk_c239\"\n               WHERE\n                  true\n               GROUP BY\n                  1,\n                  5,\n                  8,\n                  9\n         ) AS \"t_243\"\n         GROUP BY\n            1,\n            5,\n            8,\n            9\n      ) AS \"t_244\"\n      GROUP BY\n         1,\n         3,\n         5,\n         6\n      HAVING\n         CASE WHEN (CAST(COALESCE(MIN(\"t_244\".\"c_87\"), MIN(\"t_244\".\"c_88\")) AS DECIMAL(38,2)) IS NULL) THEN CAST(NULL AS DECIMAL(38,2)) ELSE CAST((CAST(COALESCE(MIN(\"t_244\".\"c_87\"), 0) AS DECIMAL(38,2)) + CAST(COALESCE(MIN(\"t_244\".\"c_88\"), 0) AS DECIMAL(38,2))) AS DECIMAL(38,2)) END > 500000000\n   ) AS \"t_263\"\n   GROUP BY\n      1,\n      3,\n      5,\n      6\n) AS \"t_283\"\nORDER BY\n   1 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    },
    "Q32": {
        "question": "For each store state in the year 2002, what was the count of store customers and the average sales quantity?",
        "expected_query": "SELECT\n   \"t_113\".\"d_store_state_name_gbakc3\" AS \"d_Store State Name\",\n   \"t_113\".\"m_ss_customer_sk_c_gbakc4\" AS \"m_ss_customer_sk_count\",\n   \"t_113\".\"m_ss_quantity_avg_gbakc5\" AS \"m_ss_quantity_avg\",\n   \"t_113\".\"sold_calendar_year_gbakc6\" AS \"Sold Calendar Year\"\nFROM\n(\n   SELECT\n      \"t_102\".\"c_99\" AS \"d_store_state_name_gbakc3\",\n      COUNT(\"store_sales_t93\".\"ss_customer_sk\") AS \"m_ss_customer_sk_c_gbakc4\",\n      CASE WHEN (COUNT(\"store_sales_t93\".\"ss_quantity\") = 0) THEN NULL ELSE (CAST(CAST(SUM(\"store_sales_t93\".\"ss_quantity\") AS BIGINT) AS FLOAT8) / COUNT(\"store_sales_t93\".\"ss_quantity\")) END AS \"m_ss_quantity_avg_gbakc5\",\n      \"t_97\".\"d_year_c95\" AS \"sold_calendar_year_gbakc6\",\n      \"t_102\".\"c_99\" AS \"d_store_state_name_gbakc1\",\n      \"t_97\".\"d_year_c95\" AS \"sold_calendar_year_gbakc2\"\n   FROM\n      \"tpcds\".\"store_sales\" AS \"store_sales_t93\"\n   JOIN\n   (\n      SELECT\n         \"date_dim_t94\".\"d_date_sk\" AS \"d_date_sk_c96\",\n         \"date_dim_t94\".\"d_year\" AS \"d_year_c95\"\n      FROM\n         \"tpcds\".\"date_dim\" AS \"date_dim_t94\"\n      WHERE\n         \"date_dim_t94\".\"d_year\" = 2002\n      GROUP BY\n         1,\n         2\n   ) AS \"t_97\"\n   ON\n      \"store_sales_t93\".\"ss_sold_date_sk\" = \"t_97\".\"d_date_sk_c96\"\n   JOIN\n   (\n      SELECT\n         CASE\n    WHEN \"store_t98\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t98\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t98\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t98\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t98\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t98\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t98\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t98\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t98\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t98\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t98\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t98\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t98\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t98\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t98\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t98\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t98\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t98\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t98\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t98\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t98\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t98\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t98\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t98\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t98\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t98\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t98\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t98\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t98\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t98\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t98\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t98\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t98\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t98\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t98\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t98\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t98\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t98\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t98\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t98\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t98\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t98\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t98\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t98\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t98\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t98\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t98\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t98\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t98\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t98\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t98\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_99\",\n         \"store_t98\".\"s_store_sk\" AS \"s_store_sk_c100\"\n      FROM\n         \"tpcds\".\"store\" AS \"store_t98\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_102\"\n   ON\n      \"store_sales_t93\".\"ss_store_sk\" = \"t_102\".\"s_store_sk_c100\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      4,\n      5,\n      6\n) AS \"t_113\"\nORDER BY\n   1 ASC NULLS FIRST,\n   4 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    },
    "Q33": {
        "question": "What were the store sales in 2002 for each store manager in the state of Tennessee?",
        "expected_query": "SELECT\n   \"t_113\".\"d_store_state_name_gbakc4\" AS \"d_Store State Name\",\n   \"t_113\".\"d_s_manager_gbakc5\" AS \"d_s_manager\",\n   \"t_113\".\"m_store_sales_pric_gbakc6\" AS \"m_store_sales_price\",\n   \"t_113\".\"sold_calendar_year_gbakc7\" AS \"Sold Calendar Year\"\nFROM\n(\n   SELECT\n      \"t_111\".\"c_107\" AS \"d_store_state_name_gbakc4\",\n      \"t_111\".\"s_manager_c109\" AS \"d_s_manager_gbakc5\",\n      CAST(CAST(SUM(\"store_sales_t101\".\"ss_sales_price\") AS DECIMAL(17,2)) AS DECIMAL(17,2)) AS \"m_store_sales_pric_gbakc6\",\n      \"t_105\".\"d_year_c103\" AS \"sold_calendar_year_gbakc7\",\n      \"t_111\".\"c_107\" AS \"d_store_state_name_gbakc1\",\n      \"t_111\".\"s_manager_c109\" AS \"d_s_manager_gbakc2\",\n      \"t_105\".\"d_year_c103\" AS \"sold_calendar_year_gbakc3\"\n   FROM\n      \"tpcds\".\"store_sales\" AS \"store_sales_t101\"\n   JOIN\n   (\n      SELECT\n         \"date_dim_t102\".\"d_date_sk\" AS \"d_date_sk_c104\",\n         \"date_dim_t102\".\"d_year\" AS \"d_year_c103\"\n      FROM\n         \"tpcds\".\"date_dim\" AS \"date_dim_t102\"\n      WHERE\n         \"date_dim_t102\".\"d_year\" = 2002\n      GROUP BY\n         1,\n         2\n   ) AS \"t_105\"\n   ON\n      \"store_sales_t101\".\"ss_sold_date_sk\" = \"t_105\".\"d_date_sk_c104\"\n   JOIN\n   (\n      SELECT\n         CASE\n    WHEN \"store_t106\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t106\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t106\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t106\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t106\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t106\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t106\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t106\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t106\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t106\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t106\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t106\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t106\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t106\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t106\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t106\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t106\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t106\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t106\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t106\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t106\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t106\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t106\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t106\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t106\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t106\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t106\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t106\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t106\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t106\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t106\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t106\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t106\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t106\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t106\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t106\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t106\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t106\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t106\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t106\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t106\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t106\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t106\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t106\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t106\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t106\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t106\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t106\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t106\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t106\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t106\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_107\",\n         \"store_t106\".\"s_manager\" AS \"s_manager_c109\",\n         \"store_t106\".\"s_store_sk\" AS \"s_store_sk_c108\"\n      FROM\n         \"tpcds\".\"store\" AS \"store_t106\"\n      WHERE\n         CASE\n    WHEN \"store_t106\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t106\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t106\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t106\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t106\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t106\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t106\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t106\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t106\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t106\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t106\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t106\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t106\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t106\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t106\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t106\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t106\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t106\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t106\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t106\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t106\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t106\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t106\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t106\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t106\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t106\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t106\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t106\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t106\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t106\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t106\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t106\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t106\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t106\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t106\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t106\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t106\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t106\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t106\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t106\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t106\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t106\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t106\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t106\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t106\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t106\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t106\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t106\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t106\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t106\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t106\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('Tennessee' AS TEXT)\n      GROUP BY\n         1,\n         2,\n         3\n   ) AS \"t_111\"\n   ON\n      \"store_sales_t101\".\"ss_store_sk\" = \"t_111\".\"s_store_sk_c108\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      4,\n      5,\n      6,\n      7\n) AS \"t_113\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   4 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    },
    "Q34": {
        "question": "For each website, what is the quantity sold and total shipping cost for customers with a shipping address in the state of New Jersey?",
        "expected_query": "SELECT\n   \"t_88\".\"ship_d_customer_st_gbakc3\" AS \"Ship d_Customer State Name\",\n   \"t_88\".\"ws_web_site_sk_lev_gbakc4\" AS \"Ws_Web_Site_Sk Level\",\n   \"t_88\".\"m_ws_quantity_sum_gbakc5\" AS \"m_ws_quantity_sum\",\n   \"t_88\".\"m_ws_ext_ship_cost_gbakc6\" AS \"m_ws_ext_ship_cost_sum\"\nFROM\n(\n   SELECT\n      \"t_86\".\"c_84\" AS \"ship_d_customer_st_gbakc3\",\n      \"web_sales_t81\".\"ws_web_site_sk\" AS \"ws_web_site_sk_lev_gbakc4\",\n      CAST(SUM(\"web_sales_t81\".\"ws_quantity\") AS BIGINT) AS \"m_ws_quantity_sum_gbakc5\",\n      CAST(CAST(SUM(\"web_sales_t81\".\"ws_ext_ship_cost\") AS DECIMAL(17,2)) AS DECIMAL(17,2)) AS \"m_ws_ext_ship_cost_gbakc6\",\n      \"t_86\".\"c_84\" AS \"ship_d_customer_st_gbakc1\",\n      \"web_sales_t81\".\"ws_web_site_sk\" AS \"ws_web_site_sk_lev_gbakc2\"\n   FROM\n      \"tpcds\".\"web_sales\" AS \"web_sales_t81\"\n   JOIN\n   (\n      SELECT\n         CASE\n    WHEN \"customer_address_t82\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t82\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t82\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t82\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t82\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t82\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t82\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t82\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t82\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t82\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t82\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t82\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t82\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t82\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t82\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t82\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t82\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t82\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t82\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t82\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t82\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t82\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t82\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t82\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t82\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t82\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t82\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t82\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t82\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t82\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t82\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t82\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t82\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t82\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t82\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t82\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t82\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t82\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t82\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t82\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t82\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t82\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t82\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t82\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t82\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t82\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t82\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t82\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t82\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t82\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t82\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_84\",\n         \"customer_address_t82\".\"ca_address_sk\" AS \"ca_address_sk_c83\"\n      FROM\n         \"tpcds\".\"customer_address\" AS \"customer_address_t82\"\n      WHERE\n         CASE\n    WHEN \"customer_address_t82\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t82\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t82\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t82\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t82\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t82\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t82\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t82\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t82\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t82\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t82\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t82\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t82\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t82\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t82\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t82\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t82\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t82\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t82\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t82\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t82\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t82\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t82\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t82\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t82\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t82\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t82\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t82\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t82\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t82\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t82\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t82\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t82\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t82\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t82\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t82\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t82\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t82\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t82\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t82\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t82\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t82\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t82\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t82\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t82\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t82\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t82\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t82\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t82\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t82\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t82\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('New Jersey' AS TEXT)\n      GROUP BY\n         1,\n         2\n   ) AS \"t_86\"\n   ON\n      \"web_sales_t81\".\"ws_ship_addr_sk\" = \"t_86\".\"ca_address_sk_c83\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      5,\n      6\n) AS \"t_88\"\nORDER BY\n   2 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    },
    "Q35": {
        "question": "What was the average store net profit for each product brand sold in stores in the state of Tennessee in the 2002 sales year?",
        "expected_query": "SELECT\n   \"t_143\".\"d_store_state_name_gbakc4\" AS \"d_Store State Name\",\n   \"t_143\".\"sold_calendar_year_gbakc5\" AS \"Sold Calendar Year\",\n   \"t_143\".\"d_product_brand_na_gbakc6\" AS \"d_product_brand_name\",\n   \"t_143\".\"average_store_unit_gbakc7\" AS \"Average Store Unit Net Profit\"\nFROM\n(\n   SELECT\n      \"t_122\".\"c_119\" AS \"d_store_state_name_gbakc4\",\n      \"t_117\".\"d_year_c115\" AS \"sold_calendar_year_gbakc5\",\n      \"t_127\".\"i_brand_c125\" AS \"d_product_brand_na_gbakc6\",\n      CASE WHEN (COALESCE(CAST(SUM(\"store_sales_t113\".\"ss_quantity\") AS BIGINT), 0) = 0) THEN (CAST('Infinity' AS FLOAT8) * CAST(SIGN(CAST(CAST(SUM(\"store_sales_t113\".\"ss_net_profit\") AS DECIMAL(17,2)) AS DECIMAL(17,2))) AS FLOAT8)) ELSE CASE WHEN (CAST(SUM(\"store_sales_t113\".\"ss_quantity\") AS BIGINT) = 0) THEN CAST(NULL AS DECIMAL(37,22)) ELSE CAST((CAST(CAST(SUM(\"store_sales_t113\".\"ss_net_profit\") AS DECIMAL(17,2)) AS DECIMAL(17,2)) / CAST(SUM(\"store_sales_t113\".\"ss_quantity\") AS BIGINT)) AS DECIMAL(37,22)) END END AS \"average_store_unit_gbakc7\",\n      \"t_122\".\"c_119\" AS \"d_store_state_name_gbakc1\",\n      \"t_117\".\"d_year_c115\" AS \"sold_calendar_year_gbakc2\",\n      \"t_127\".\"i_brand_id_c124\" AS \"d_product_brand_na_gbakc3\"\n   FROM\n      \"tpcds\".\"store_sales\" AS \"store_sales_t113\"\n   JOIN\n   (\n      SELECT\n         \"date_dim_t114\".\"d_date_sk\" AS \"d_date_sk_c116\",\n         \"date_dim_t114\".\"d_year\" AS \"d_year_c115\"\n      FROM\n         \"tpcds\".\"date_dim\" AS \"date_dim_t114\"\n      WHERE\n         \"date_dim_t114\".\"d_year\" = 2002\n      GROUP BY\n         1,\n         2\n   ) AS \"t_117\"\n   ON\n      \"store_sales_t113\".\"ss_sold_date_sk\" = \"t_117\".\"d_date_sk_c116\"\n   JOIN\n   (\n      SELECT\n         CASE\n    WHEN \"store_t118\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t118\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t118\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t118\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t118\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t118\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t118\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t118\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t118\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t118\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t118\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t118\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t118\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t118\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t118\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t118\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t118\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t118\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t118\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t118\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t118\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t118\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t118\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t118\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t118\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t118\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t118\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t118\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t118\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t118\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t118\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t118\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t118\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t118\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t118\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t118\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t118\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t118\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t118\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t118\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t118\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t118\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t118\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t118\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t118\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t118\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t118\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t118\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t118\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t118\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t118\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_119\",\n         \"store_t118\".\"s_store_sk\" AS \"s_store_sk_c120\"\n      FROM\n         \"tpcds\".\"store\" AS \"store_t118\"\n      WHERE\n         CASE\n    WHEN \"store_t118\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t118\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t118\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t118\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t118\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t118\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t118\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t118\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t118\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t118\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t118\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t118\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t118\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t118\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t118\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t118\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t118\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t118\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t118\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t118\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t118\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t118\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t118\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t118\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t118\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t118\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t118\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t118\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t118\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t118\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t118\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t118\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t118\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t118\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t118\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t118\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t118\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t118\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t118\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t118\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t118\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t118\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t118\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t118\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t118\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t118\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t118\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t118\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t118\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t118\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t118\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('Tennessee' AS TEXT)\n      GROUP BY\n         1,\n         2\n   ) AS \"t_122\"\n   ON\n      \"store_sales_t113\".\"ss_store_sk\" = \"t_122\".\"s_store_sk_c120\"\n   JOIN\n   (\n      SELECT\n         \"item_t123\".\"i_brand\" AS \"i_brand_c125\",\n         \"item_t123\".\"i_brand_id\" AS \"i_brand_id_c124\",\n         \"item_t123\".\"i_item_sk\" AS \"i_item_sk_c126\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t123\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2,\n         3\n   ) AS \"t_127\"\n   ON\n      \"store_sales_t113\".\"ss_item_sk\" = \"t_127\".\"i_item_sk_c126\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      5,\n      6,\n      7\n) AS \"t_143\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    },
    "Q36": {
        "question": "What are the store quantity sold and returned, for each store in the state of Tennessee, also include store hours and store floor space?",
        "expected_query": "SELECT\n   \"t_219\".\"d_store_state_name_gbakc5\" AS \"d_Store State Name\",\n   \"t_219\".\"d_store_name_gbakc6\" AS \"d_store_name\",\n   \"t_219\".\"m_ss_quantity_sum_gbakc7\" AS \"m_ss_quantity_sum\",\n   \"t_219\".\"m_store_returns_co_gbakc8\" AS \"m_store_returns_count_sum\",\n   \"t_219\".\"d_s_hours_gbakc9\" AS \"d_s_hours\",\n   \"t_219\".\"d_s_floor_space_gbakc10\" AS \"d_s_floor_space\"\nFROM\n(\n   SELECT\n      \"t_207\".\"d_store_state_name_gbakc5\" AS \"d_store_state_name_gbakc5\",\n      \"t_207\".\"d_store_name_gbakc6\" AS \"d_store_name_gbakc6\",\n      MIN(\"t_207\".\"m_ss_quantity_sum_gbakc7\") AS \"m_ss_quantity_sum_gbakc7\",\n      MIN(\"t_207\".\"m_store_returns_co_gbakc8\") AS \"m_store_returns_co_gbakc8\",\n      \"t_207\".\"d_s_hours_gbakc9\" AS \"d_s_hours_gbakc9\",\n      \"t_207\".\"d_s_floor_space_gbakc10\" AS \"d_s_floor_space_gbakc10\",\n      \"t_207\".\"d_store_state_name_gbakc1\" AS \"d_store_state_name_gbakc1\",\n      \"t_207\".\"d_store_name_gbakc2\" AS \"d_store_name_gbakc2\",\n      \"t_207\".\"d_s_hours_gbakc3\" AS \"d_s_hours_gbakc3\",\n      \"t_207\".\"d_s_floor_space_gbakc4\" AS \"d_s_floor_space_gbakc4\"\n   FROM\n   (\n         SELECT\n            \"t_186\".\"c_182\" AS \"d_store_state_name_gbakc5\",\n            \"t_186\".\"s_store_name_c183\" AS \"d_store_name_gbakc6\",\n            CAST(SUM(\"store_sales_t178\".\"ss_quantity\") AS BIGINT) AS \"m_ss_quantity_sum_gbakc7\",\n            CAST(NULL AS BIGINT) AS \"m_store_returns_co_gbakc8\",\n            \"t_186\".\"s_hours_c180\" AS \"d_s_hours_gbakc9\",\n            \"t_186\".\"s_floor_space_c181\" AS \"d_s_floor_space_gbakc10\",\n            \"t_186\".\"c_182\" AS \"d_store_state_name_gbakc1\",\n            \"t_186\".\"s_store_name_c183\" AS \"d_store_name_gbakc2\",\n            \"t_186\".\"s_hours_c180\" AS \"d_s_hours_gbakc3\",\n            \"t_186\".\"s_floor_space_c181\" AS \"d_s_floor_space_gbakc4\"\n         FROM\n            \"tpcds\".\"store_sales\" AS \"store_sales_t178\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"store_t179\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t179\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t179\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t179\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t179\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t179\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t179\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t179\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t179\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t179\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t179\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t179\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t179\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t179\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t179\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t179\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t179\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t179\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t179\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t179\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t179\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t179\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t179\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t179\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t179\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t179\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t179\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t179\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t179\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t179\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t179\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t179\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t179\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t179\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t179\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t179\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t179\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t179\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t179\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t179\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t179\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t179\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t179\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t179\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t179\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t179\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t179\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t179\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t179\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t179\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t179\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_182\",\n               \"store_t179\".\"s_floor_space\" AS \"s_floor_space_c181\",\n               \"store_t179\".\"s_hours\" AS \"s_hours_c180\",\n               \"store_t179\".\"s_store_name\" AS \"s_store_name_c183\",\n               \"store_t179\".\"s_store_sk\" AS \"s_store_sk_c184\"\n            FROM\n               \"tpcds\".\"store\" AS \"store_t179\"\n            WHERE\n               CASE\n    WHEN \"store_t179\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t179\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t179\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t179\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t179\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t179\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t179\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t179\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t179\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t179\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t179\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t179\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t179\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t179\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t179\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t179\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t179\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t179\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t179\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t179\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t179\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t179\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t179\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t179\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t179\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t179\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t179\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t179\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t179\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t179\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t179\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t179\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t179\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t179\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t179\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t179\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t179\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t179\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t179\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t179\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t179\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t179\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t179\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t179\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t179\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t179\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t179\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t179\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t179\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t179\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t179\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('Tennessee' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_186\"\n         ON\n            \"store_sales_t178\".\"ss_store_sk\" = \"t_186\".\"s_store_sk_c184\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n      UNION ALL\n         SELECT\n            \"t_205\".\"c_201\" AS \"d_store_state_name_gbakc5\",\n            \"t_205\".\"s_store_name_c202\" AS \"d_store_name_gbakc6\",\n            CAST(NULL AS BIGINT) AS \"m_ss_quantity_sum_gbakc7\",\n            CAST(SUM(\"t_197\".\"returns_count\") AS BIGINT) AS \"m_store_returns_co_gbakc8\",\n            \"t_205\".\"s_hours_c199\" AS \"d_s_hours_gbakc9\",\n            \"t_205\".\"s_floor_space_c200\" AS \"d_s_floor_space_gbakc10\",\n            \"t_205\".\"c_201\" AS \"d_store_state_name_gbakc1\",\n            \"t_205\".\"s_store_name_c202\" AS \"d_store_name_gbakc2\",\n            \"t_205\".\"s_hours_c199\" AS \"d_s_hours_gbakc3\",\n            \"t_205\".\"s_floor_space_c200\" AS \"d_s_floor_space_gbakc4\"\n         FROM\n         (\nSELECT ss.*, sr.*, case when (sr_returned_date_sk - ss_sold_date_sk <= 30) then '<= 30 days' when (sr_returned_date_sk - ss_sold_date_sk > 30) and   (sr_returned_date_sk - ss_sold_date_sk <= 60) then '31-60 days' when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then '61-90 days' when (sr_returned_date_sk - ss_sold_date_sk > 90) and  (sr_returned_date_sk - ss_sold_date_sk <= 120) then '91-120 days' else '> 120 days' end as returns_time_tier, 1 as returns_count  FROM atscale_tutorial_data.tpcds.store_returns sr INNER JOIN atscale_tutorial_data.tpcds.store_sales ss ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_customer_sk = sr.sr_customer_sk\n         ) AS \"t_197\"\n         JOIN\n         (\n            SELECT\n               CASE\n    WHEN \"store_t198\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t198\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t198\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t198\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t198\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t198\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t198\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t198\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t198\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t198\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t198\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t198\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t198\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t198\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t198\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t198\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t198\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t198\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t198\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t198\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t198\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t198\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t198\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t198\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t198\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t198\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t198\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t198\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t198\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t198\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t198\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t198\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t198\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t198\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t198\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t198\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t198\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t198\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t198\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t198\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t198\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t198\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t198\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t198\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t198\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t198\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t198\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t198\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t198\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t198\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t198\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_201\",\n               \"store_t198\".\"s_floor_space\" AS \"s_floor_space_c200\",\n               \"store_t198\".\"s_hours\" AS \"s_hours_c199\",\n               \"store_t198\".\"s_store_name\" AS \"s_store_name_c202\",\n               \"store_t198\".\"s_store_sk\" AS \"s_store_sk_c203\"\n            FROM\n               \"tpcds\".\"store\" AS \"store_t198\"\n            WHERE\n               CASE\n    WHEN \"store_t198\".s_state = 'AK' THEN 'Alaska'\n    WHEN \"store_t198\".s_state = 'AL' THEN 'Alabama'\n    WHEN \"store_t198\".s_state = 'AR' THEN 'Arkansas'\n    WHEN \"store_t198\".s_state = 'AZ' THEN 'Arizona'\n    WHEN \"store_t198\".s_state = 'CA' THEN 'California'\n    WHEN \"store_t198\".s_state = 'CO' THEN 'Colorado'\n    WHEN \"store_t198\".s_state = 'CT' THEN 'Connecticut'\n    WHEN \"store_t198\".s_state = 'DC' THEN 'Washington DC'\n    WHEN \"store_t198\".s_state = 'DE' THEN 'Delaware'\n    WHEN \"store_t198\".s_state = 'FL' THEN 'Florida'\n    WHEN \"store_t198\".s_state = 'GA' THEN 'Georgia'\n    WHEN \"store_t198\".s_state = 'HI' THEN 'Hawaii'\n    WHEN \"store_t198\".s_state = 'IA' THEN 'Iowa'\n    WHEN \"store_t198\".s_state = 'ID' THEN 'Idaho'\n    WHEN \"store_t198\".s_state = 'IL' THEN 'Illinois'\n    WHEN \"store_t198\".s_state = 'IN' THEN 'Indiana'\n    WHEN \"store_t198\".s_state = 'KS' THEN 'Kansas'\n    WHEN \"store_t198\".s_state = 'KY' THEN 'Kentucky'\n    WHEN \"store_t198\".s_state = 'LA' THEN 'Louisiana'\n    WHEN \"store_t198\".s_state = 'MA' THEN 'Massachusetts'\n    WHEN \"store_t198\".s_state = 'MD' THEN 'Maryland'\n    WHEN \"store_t198\".s_state = 'ME' THEN 'Maine'\n    WHEN \"store_t198\".s_state = 'MI' THEN 'Michigan'\n    WHEN \"store_t198\".s_state = 'MN' THEN 'Minnesota'\n    WHEN \"store_t198\".s_state = 'MO' THEN 'Missouri'\n    WHEN \"store_t198\".s_state = 'MS' THEN 'Mississippi'\n    WHEN \"store_t198\".s_state = 'MT' THEN 'Montana'\n    WHEN \"store_t198\".s_state = 'NC' THEN 'North Carolina'\n    WHEN \"store_t198\".s_state = 'ND' THEN 'North Dakota'\n    WHEN \"store_t198\".s_state = 'NE' THEN 'Nebraska'\n    WHEN \"store_t198\".s_state = 'NH' THEN 'New Hampshire'\n    WHEN \"store_t198\".s_state = 'NJ' THEN 'New Jersey'\n    WHEN \"store_t198\".s_state = 'NM' THEN 'New Mexico'\n    WHEN \"store_t198\".s_state = 'NV' THEN 'Nevada'\n    WHEN \"store_t198\".s_state = 'NY' THEN 'New York'\n    WHEN \"store_t198\".s_state = 'OH' THEN 'Ohio'\n    WHEN \"store_t198\".s_state = 'OK' THEN 'Oklahoma'\n    WHEN \"store_t198\".s_state = 'OR' THEN 'Oregon'\n    WHEN \"store_t198\".s_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"store_t198\".s_state = 'RI' THEN 'Rhode Island'\n    WHEN \"store_t198\".s_state = 'SC' THEN 'South Carolina'\n    WHEN \"store_t198\".s_state = 'SD' THEN 'South Dakota'\n    WHEN \"store_t198\".s_state = 'TN' THEN 'Tennessee'\n    WHEN \"store_t198\".s_state = 'TX' THEN 'Texas'\n    WHEN \"store_t198\".s_state = 'UT' THEN 'Utah'\n    WHEN \"store_t198\".s_state = 'VA' THEN 'Virginia' \n    WHEN \"store_t198\".s_state = 'VT' THEN 'Vermont'\n    WHEN \"store_t198\".s_state = 'WA' THEN 'Washington'\n    WHEN \"store_t198\".s_state = 'WI' THEN 'Wisconsin'\n    WHEN \"store_t198\".s_state = 'WV' THEN 'West Virginia'\n    WHEN \"store_t198\".s_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('Tennessee' AS TEXT)\n            GROUP BY\n               1,\n               2,\n               3,\n               4,\n               5\n         ) AS \"t_205\"\n         ON\n            \"t_197\".\"sr_store_sk\" = \"t_205\".\"s_store_sk_c203\"\n         WHERE\n            true\n         GROUP BY\n            1,\n            2,\n            5,\n            6,\n            7,\n            8,\n            9,\n            10\n   ) AS \"t_207\"\n   GROUP BY\n      1,\n      2,\n      5,\n      6,\n      7,\n      8,\n      9,\n      10\n) AS \"t_219\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   5 ASC NULLS FIRST,\n   6 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    },
    "Q37": {
        "question": "What was the sum of web sales for each product brand in the year 2002?",
        "expected_query": "SELECT\n   \"t_81\".\"sold_calendar_year_gbakc3\" AS \"Sold Calendar Year\",\n   \"t_81\".\"d_product_brand_na_gbakc4\" AS \"d_product_brand_name\",\n   \"t_81\".\"m_web_sales_sum_gbakc5\" AS \"m_web_sales_sum\"\nFROM\n(\n   SELECT\n      \"t_74\".\"d_year_c72\" AS \"sold_calendar_year_gbakc3\",\n      \"t_79\".\"i_brand_c77\" AS \"d_product_brand_na_gbakc4\",\n      CAST(SUM(CAST(\"web_sales_t69\".ws_ext_sales_price*\"web_sales_t69\".ws_quantity AS decimal(38,2))) AS DECIMAL(38,2)) AS \"m_web_sales_sum_gbakc5\",\n      \"t_74\".\"d_year_c72\" AS \"sold_calendar_year_gbakc1\",\n      \"t_79\".\"i_brand_id_c76\" AS \"d_product_brand_na_gbakc2\"\n   FROM\n      \"tpcds\".\"web_sales\" AS \"web_sales_t69\"\n   JOIN\n   (\n      SELECT\n         \"date_dim_t71\".\"d_date_sk\" AS \"d_date_sk_c73\",\n         \"date_dim_t71\".\"d_year\" AS \"d_year_c72\"\n      FROM\n         \"tpcds\".\"date_dim\" AS \"date_dim_t71\"\n      WHERE\n         \"date_dim_t71\".\"d_year\" = 2002\n      GROUP BY\n         1,\n         2\n   ) AS \"t_74\"\n   ON\n      \"web_sales_t69\".\"ws_sold_date_sk\" = \"t_74\".\"d_date_sk_c73\"\n   JOIN\n   (\n      SELECT\n         \"item_t75\".\"i_brand\" AS \"i_brand_c77\",\n         \"item_t75\".\"i_brand_id\" AS \"i_brand_id_c76\",\n         \"item_t75\".\"i_item_sk\" AS \"i_item_sk_c78\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t75\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2,\n         3\n   ) AS \"t_79\"\n   ON\n      \"web_sales_t69\".\"ws_item_sk\" = \"t_79\".\"i_item_sk_c78\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      4,\n      5\n) AS \"t_81\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    },
    "Q38": {
        "question": "What is the total catalog sales by zip code for customers living in the state of Maryland?",
        "expected_query": "SELECT\n   \"t_82\".\"d_customer_state_n_gbakc3\" AS \"d_Customer State Name\",\n   \"t_82\".\"d_customer_zip_cod_gbakc4\" AS \"d_customer_zip_code\",\n   \"t_82\".\"m_catalog_sales_su_gbakc5\" AS \"m_catalog_sales_sum\"\nFROM\n(\n   SELECT\n      \"t_80\".\"c_77\" AS \"d_customer_state_n_gbakc3\",\n      \"t_80\".\"ca_zip_c76\" AS \"d_customer_zip_cod_gbakc4\",\n      CAST(SUM(CAST(\"catalog_sales_t69\".cs_sales_price-\"catalog_sales_t69\".cs_quantity AS decimal(38,2))) AS DECIMAL(38,2)) AS \"m_catalog_sales_su_gbakc5\",\n      \"t_80\".\"c_77\" AS \"d_customer_state_n_gbakc1\",\n      \"t_80\".\"ca_zip_c76\" AS \"d_customer_zip_cod_gbakc2\"\n   FROM\n      \"tpcds\".\"catalog_sales\" AS \"catalog_sales_t69\"\n   JOIN\n   (\n      SELECT\n         \"customer_t71\".\"c_current_addr_sk\" AS \"c_current_addr_sk_c73\",\n         \"customer_t71\".\"c_customer_sk\" AS \"c_customer_sk_c72\"\n      FROM\n         \"tpcds\".\"customer\" AS \"customer_t71\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_74\"\n   ON\n      \"catalog_sales_t69\".\"cs_bill_customer_sk\" = \"t_74\".\"c_customer_sk_c72\"\n   JOIN\n   (\n      SELECT\n         CASE\n    WHEN \"customer_address_t75\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t75\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t75\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t75\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t75\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t75\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t75\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t75\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t75\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t75\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t75\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t75\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t75\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t75\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t75\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t75\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t75\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t75\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t75\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t75\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t75\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t75\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t75\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t75\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t75\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t75\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t75\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t75\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t75\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t75\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t75\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t75\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t75\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t75\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t75\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t75\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t75\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t75\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t75\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t75\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t75\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t75\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t75\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t75\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t75\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t75\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t75\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t75\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t75\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t75\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t75\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND AS \"c_77\",\n         \"customer_address_t75\".\"ca_address_sk\" AS \"ca_address_sk_c78\",\n         \"customer_address_t75\".\"ca_zip\" AS \"ca_zip_c76\"\n      FROM\n         \"tpcds\".\"customer_address\" AS \"customer_address_t75\"\n      WHERE\n         CASE\n    WHEN \"customer_address_t75\".ca_state = 'AK' THEN 'Alaska'\n    WHEN \"customer_address_t75\".ca_state = 'AL' THEN 'Alabama'\n    WHEN \"customer_address_t75\".ca_state = 'AR' THEN 'Arkansas'\n    WHEN \"customer_address_t75\".ca_state = 'AZ' THEN 'Arizona'\n    WHEN \"customer_address_t75\".ca_state = 'CA' THEN 'California'\n    WHEN \"customer_address_t75\".ca_state = 'CO' THEN 'Colorado'\n    WHEN \"customer_address_t75\".ca_state = 'CT' THEN 'Connecticut'\n    WHEN \"customer_address_t75\".ca_state = 'DC' THEN 'Washington DC'\n    WHEN \"customer_address_t75\".ca_state = 'DE' THEN 'Delaware'\n    WHEN \"customer_address_t75\".ca_state = 'FL' THEN 'Florida'\n    WHEN \"customer_address_t75\".ca_state = 'GA' THEN 'Georgia'\n    WHEN \"customer_address_t75\".ca_state = 'HI' THEN 'Hawaii'\n    WHEN \"customer_address_t75\".ca_state = 'IA' THEN 'Iowa'\n    WHEN \"customer_address_t75\".ca_state = 'ID' THEN 'Idaho'\n    WHEN \"customer_address_t75\".ca_state = 'IL' THEN 'Illinois'\n    WHEN \"customer_address_t75\".ca_state = 'IN' THEN 'Indiana'\n    WHEN \"customer_address_t75\".ca_state = 'KS' THEN 'Kansas'\n    WHEN \"customer_address_t75\".ca_state = 'KY' THEN 'Kentucky'\n    WHEN \"customer_address_t75\".ca_state = 'LA' THEN 'Louisiana'\n    WHEN \"customer_address_t75\".ca_state = 'MA' THEN 'Massachusetts'\n    WHEN \"customer_address_t75\".ca_state = 'MD' THEN 'Maryland'\n    WHEN \"customer_address_t75\".ca_state = 'ME' THEN 'Maine'\n    WHEN \"customer_address_t75\".ca_state = 'MI' THEN 'Michigan'\n    WHEN \"customer_address_t75\".ca_state = 'MN' THEN 'Minnesota'\n    WHEN \"customer_address_t75\".ca_state = 'MO' THEN 'Missouri'\n    WHEN \"customer_address_t75\".ca_state = 'MS' THEN 'Mississippi'\n    WHEN \"customer_address_t75\".ca_state = 'MT' THEN 'Montana'\n    WHEN \"customer_address_t75\".ca_state = 'NC' THEN 'North Carolina'\n    WHEN \"customer_address_t75\".ca_state = 'ND' THEN 'North Dakota'\n    WHEN \"customer_address_t75\".ca_state = 'NE' THEN 'Nebraska'\n    WHEN \"customer_address_t75\".ca_state = 'NH' THEN 'New Hampshire'\n    WHEN \"customer_address_t75\".ca_state = 'NJ' THEN 'New Jersey'\n    WHEN \"customer_address_t75\".ca_state = 'NM' THEN 'New Mexico'\n    WHEN \"customer_address_t75\".ca_state = 'NV' THEN 'Nevada'\n    WHEN \"customer_address_t75\".ca_state = 'NY' THEN 'New York'\n    WHEN \"customer_address_t75\".ca_state = 'OH' THEN 'Ohio'\n    WHEN \"customer_address_t75\".ca_state = 'OK' THEN 'Oklahoma'\n    WHEN \"customer_address_t75\".ca_state = 'OR' THEN 'Oregon'\n    WHEN \"customer_address_t75\".ca_state = 'PA' THEN 'Pennsylvania'\n    WHEN \"customer_address_t75\".ca_state = 'RI' THEN 'Rhode Island'\n    WHEN \"customer_address_t75\".ca_state = 'SC' THEN 'South Carolina'\n    WHEN \"customer_address_t75\".ca_state = 'SD' THEN 'South Dakota'\n    WHEN \"customer_address_t75\".ca_state = 'TN' THEN 'Tennessee'\n    WHEN \"customer_address_t75\".ca_state = 'TX' THEN 'Texas'\n    WHEN \"customer_address_t75\".ca_state = 'UT' THEN 'Utah'\n    WHEN \"customer_address_t75\".ca_state = 'VA' THEN 'Virginia' \n    WHEN \"customer_address_t75\".ca_state = 'VT' THEN 'Vermont'\n    WHEN \"customer_address_t75\".ca_state = 'WA' THEN 'Washington'\n    WHEN \"customer_address_t75\".ca_state = 'WI' THEN 'Wisconsin'\n    WHEN \"customer_address_t75\".ca_state = 'WV' THEN 'West Virginia'\n    WHEN \"customer_address_t75\".ca_state = 'WY' THEN 'Wyoming'\n    ELSE NULL\nEND = CAST('Maryland' AS TEXT)\n      GROUP BY\n         1,\n         2,\n         3\n   ) AS \"t_80\"\n   ON\n      \"t_74\".\"c_current_addr_sk_c73\" = \"t_80\".\"ca_address_sk_c78\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      4,\n      5\n) AS \"t_82\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    },
    "Q39": {
        "question": "What is the product brand name and color for all products with non-zero inventory on hand in the year 2002?",
        "expected_query": "SELECT\n   \"t_113\".\"inventory_calendar_gbakc4\" AS \"Inventory Calendar Year\",\n   \"t_113\".\"d_product_brand_na_gbakc5\" AS \"d_product_brand_name\",\n   \"t_113\".\"d_i_color_gbakc6\" AS \"d_i_color\",\n   \"t_113\".\"m_inventory_quanti_gbakc7\" AS \"m_inventory_quantity_on_hand_sum\"\nFROM\n(\n   SELECT\n      \"t_105\".\"d_year_c103\" AS \"inventory_calendar_gbakc4\",\n      \"t_111\".\"i_brand_c109\" AS \"d_product_brand_na_gbakc5\",\n      \"t_111\".\"i_color_c107\" AS \"d_i_color_gbakc6\",\n      CAST(SUM(\"inventory_t101\".\"inv_quantity_on_hand\") AS BIGINT) AS \"m_inventory_quanti_gbakc7\",\n      \"t_105\".\"d_year_c103\" AS \"inventory_calendar_gbakc1\",\n      \"t_111\".\"i_brand_id_c108\" AS \"d_product_brand_na_gbakc2\",\n      \"t_111\".\"i_color_c107\" AS \"d_i_color_gbakc3\"\n   FROM\n      \"tpcds\".\"inventory\" AS \"inventory_t101\"\n   JOIN\n   (\n      SELECT\n         \"date_dim_t102\".\"d_date_sk\" AS \"d_date_sk_c104\",\n         \"date_dim_t102\".\"d_year\" AS \"d_year_c103\"\n      FROM\n         \"tpcds\".\"date_dim\" AS \"date_dim_t102\"\n      WHERE\n         \"date_dim_t102\".\"d_year\" = 2002\n      GROUP BY\n         1,\n         2\n   ) AS \"t_105\"\n   ON\n      \"inventory_t101\".\"inv_date_sk\" = \"t_105\".\"d_date_sk_c104\"\n   JOIN\n   (\n      SELECT\n         \"item_t106\".\"i_brand\" AS \"i_brand_c109\",\n         \"item_t106\".\"i_brand_id\" AS \"i_brand_id_c108\",\n         \"item_t106\".\"i_color\" AS \"i_color_c107\",\n         \"item_t106\".\"i_item_sk\" AS \"i_item_sk_c110\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t106\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2,\n         3,\n         4\n   ) AS \"t_111\"\n   ON\n      \"inventory_t101\".\"inv_item_sk\" = \"t_111\".\"i_item_sk_c110\"\n   WHERE\n      true\n   GROUP BY\n      1,\n      2,\n      3,\n      5,\n      6,\n      7\n   HAVING\n      CAST(SUM(\"inventory_t101\".\"inv_quantity_on_hand\") AS BIGINT) > 0\n) AS \"t_113\"\nORDER BY\n   1 ASC NULLS FIRST,\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    },
    "Q40": {
        "question": "For every store name and product category, what is the average store sales quantity?",
        "expected_query": "SELECT\n   \"t_91\".\"m_ss_quantity_avg_gbakc3\" AS \"m_ss_quantity_avg\",\n   \"t_91\".\"i_category_gbakc4\" AS \"I category\",\n   \"t_91\".\"d_store_name_gbakc5\" AS \"d_store_name\"\nFROM\n(\n   SELECT\n      CASE WHEN (COUNT(\"store_sales_t73\".\"ss_quantity\") = 0) THEN NULL ELSE (CAST(CAST(SUM(\"store_sales_t73\".\"ss_quantity\") AS BIGINT) AS FLOAT8) / COUNT(\"store_sales_t73\".\"ss_quantity\")) END AS \"m_ss_quantity_avg_gbakc3\",\n      \"t_81\".\"i_category_c79\" AS \"i_category_gbakc4\",\n      \"t_77\".\"s_store_name_c75\" AS \"d_store_name_gbakc5\",\n      \"t_81\".\"i_category_c79\" AS \"i_category_gbakc1\",\n      \"t_77\".\"s_store_name_c75\" AS \"d_store_name_gbakc2\"\n   FROM\n      \"tpcds\".\"store_sales\" AS \"store_sales_t73\"\n   JOIN\n   (\n      SELECT\n         \"store_t74\".\"s_store_name\" AS \"s_store_name_c75\",\n         \"store_t74\".\"s_store_sk\" AS \"s_store_sk_c76\"\n      FROM\n         \"tpcds\".\"store\" AS \"store_t74\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_77\"\n   ON\n      \"store_sales_t73\".\"ss_store_sk\" = \"t_77\".\"s_store_sk_c76\"\n   JOIN\n   (\n      SELECT\n         \"item_t78\".\"i_category\" AS \"i_category_c79\",\n         \"item_t78\".\"i_item_sk\" AS \"i_item_sk_c80\"\n      FROM\n         \"tpcds\".\"item\" AS \"item_t78\"\n      WHERE\n         true\n      GROUP BY\n         1,\n         2\n   ) AS \"t_81\"\n   ON\n      \"store_sales_t73\".\"ss_item_sk\" = \"t_81\".\"i_item_sk_c80\"\n   WHERE\n      true\n   GROUP BY\n      2,\n      3,\n      4,\n      5\n) AS \"t_91\"\nORDER BY\n   2 ASC NULLS FIRST,\n   3 ASC NULLS FIRST",
        "q_complexity": "H",
        "s_complexity": "H"
    }
}